# Activity Summary for 17/10/2025

## 11:56:36
The log details changes across two main areas: UI configuration and a specific UI component.

**File-Specific Updates:**

*   **`/Users/madav/Documents/dashboard_checkout/dashboard-ui-configuration/src/index.ejs` (Timestamp: 17/10/2025, 11:20:06)**
    This file represents a comprehensive HTML/EJS template for the "Gokwik Dashboard". It outlines the core structure, including meta tags for standard attributes and a strict Content Security Policy. A `window.fcWidgetMessengerConfig` is initialized. Critically, it defines environment-specific SystemJS import maps, dynamically loading various `@gokwik` micro-frontend modules (e.g., `configuration`, `utilities`, `dashboard`, `checkout`, `payment`, `kwikpass`, `rto`, `kwikship`, `ellora`, `checkout-platform`, `shopify-app`) from different development, QA, and sandbox URLs. Shared dependencies like `react` and `react-dom` are loaded from a CDN. The production environment configuration includes integrations for Microsoft Clarity and New Relic browser monitoring, indicating a focus on analytics and performance tracking for live deployments.

*   **`/Users/madav/Documents/dashboard_checkout/checkout-dashboard-ui/src/library/components/discounts/setup/discountCartItems.tsx`**
    This React component, `SetupDiscountCartItems`, is responsible for configuring discount properties within a form. It allows users to set discount types (percentage or fixed amount) and their respective values, with dynamic UI adjustments based on selections.
    *   **Initial State (Timestamp: 17/10/2025, 11:21:57)**: The component provides UI for selecting discount type, entering discount value (with appropriate suffixes/prefixes), setting discount capping for percentage-based discounts, and an option to apply fixed discounts "once per order". When "fixed" is selected as the discount type, `discountCartItemsOncePerOrder` is automatically set to `true`.
    *   **Debugging Addition (Timestamp: 17/10/2025, 11:22:59)**: A `console.log(discountApplicableOn)` statement was temporarily added, likely for debugging purposes.
    *   **Conditional Logic Update (Timestamp: 17/10/2025, 11:23:52)**: The visibility of the "Only apply discount once per order" checkbox for fixed discounts was changed to appear only when `discountApplicableOn` is `'allProducts'`.
    *   **Debugging Removal (Timestamp: 17/10/2025, 11:24:20)**: The `console.log` statement was removed, reverting that specific change.
    *   **Conditional Logic Reversal (Timestamp: 17/10/2025, 11:25:06)**: The visibility condition for the "Only apply discount once per order" checkbox was reversed. It is now displayed for fixed discounts when `discountApplicableOn` is *not* `'allProducts'`. This implies a significant change in how fixed discounts are applied based on product applicability.

**Timestamps of Significant Changes:**

*   **17/10/2025, 11:20:06**: The `index.ejs` file was established, defining the overarching micro-frontend architecture and environment-specific configurations for the Gokwik Dashboard.
*   **17/10/2025, 11:23:52** and **17/10/2025, 11:25:06**: These two timestamps mark the key logical modifications to the `discountCartItems.tsx` component, specifically altering when the "Only apply discount once per order" checkbox is shown for fixed-amount discounts.

**Patterns and Recurring Elements:**

*   **Gokwik Ecosystem**: The project is clearly centered around a "Gokwik" product line, with several UI components and API endpoints referencing "gokwik."
*   **Micro-frontend Architecture**: The `index.ejs` file prominently features SystemJS import maps, dynamically loading various `@gokwik` modules based on the deployment environment, indicating a micro-frontend approach for the dashboard UI.
*   **Environment-Specific Configuration**: A strong pattern of tailoring configurations (API URLs, module imports) to different environments (local, dev, qa, sandbox, production) is evident.
*   **Dashboard UI Development**: The file paths suggest active development on user interfaces related to a checkout dashboard.
*   **Form-Driven UI**: The `discountCartItems.tsx` component demonstrates a common pattern of building dynamic UI based on user input within a form, using form-watching hooks to conditionally render fields and update values.
*   **Rapid Iteration/Debugging**: The series of quick changes (adding/removing `console.log`, tweaking conditions) in `discountCartItems.tsx` within a few minutes suggests ongoing development, testing, and refinement of UI logic.

## 11:56:41
The provided log details changes across two distinct files within the codebase.

**File:** `/Users/madav/Documents/checkout UI/gokwik.pdp/public/merchant.html`
**Timestamp:** `16/10/2025, 23:04:46`
This file represents a local HTML page designed for merchant testing and integration. Key updates include:
*   **SDK Initialization:** It defines a `gokwikSdk` IIFE (Immediately Invoked Function Expression) for initializing Gokwik scripts, processing payments (`initCheckout`), emitting and subscribing to events, and a function (`hideButton`) to conceal Gokwik containers. The SDK's `init` function conditionally loads `http://localhost:8080/build/gokwik.js` if parameters are not provided.
*   **Cookie Management:** Helper functions `getCookieGk` and `setCookieGk` are present for managing cookies, used for tracking landing pages and original referrers.
*   **Merchant Configuration:** The `window.merchantInfo` object is hardcoded with specific values for testing, including a `mid`, `environment: 'local'`, `storeId`, and `fbpixel`. This configuration is used to initiate checkout via `gokwikSdk.initCheckout` on button click or a specific `window.onmessage` event.
*   **User Interface:** A simple form allows users to input a Merchant ID and JSON data, and select an environment, which can then be saved to cookies.
*   **Styling:** Basic CSS is included for the custom wrapper div, input fields, and buttons, enhancing the readability and usability of the test page.

**File:** `/Users/madav/Documents/checkout UI/gokwik.pdp/src/common/services/ShippingDiscount.service.ts`
**Timestamps:** `16/10/2025, 23:07:01` and `16/10/2025, 23:07:11`
Both entries for this file show identical content, indicating no functional changes occurred between these two timestamps. This service file is crucial for managing shipping and discount logic within the Gokwik checkout UI.
*   **Store Management:** It extensively utilizes Svelte stores (e.g., `store_cartjsObject`, `store_discountCode`, `store_selectedShippingMethod`, `store_merchantInfo`) to manage various states related to the cart, discounts, shipping, and user interactions.
*   **API Interactions:** The service defines `callShippingDiscountApi` to handle discount and shipping API calls, processing responses through `processDiscountShippingQueue` (an `ApiResponseQueue`).
*   **Discount & Shipping Logic:**
    *   It processes various discount types, including loyalty points, GWP (Gift With Purchase) codes, and UTM-based discounts.
    *   A confetti animation is triggered upon successful coupon application if specific conditions are met (e.g., `show_discount_confetti` is true).
    *   It includes logic for managing gift cards (reapplying or removing them) and re-applying Gyftr discounts based on the cart state.
    *   Shipping method selection and display are handled based on API responses.
    *   Error messages are managed, excluding specific UI errors for UTM auto-application failures.
*   **Event Logging:** The service integrates with an `EventService` to log events like `loyalty_points_applied` for analytics purposes.
*   **Conditional Flows:** Logic is present to handle scenarios like cart updates (fixing CHECKOUT-15842), and navigating between payment methods and address listing (fixing CHECKOUT-12982), often based on the `currentPage` and `bottomSheetState`.

**Patterns and Recurring Elements:**
*   **Environment-Dependent Logic:** A strong pattern across the files (and implicitly, within the system, although the `EnvironmentService.ts` file itself is excluded from summary) is the pervasive use of `env` (environment) variables to determine API endpoints, CDN paths, and token values. This modularity allows the application to easily switch between development, QA, sandbox, and production environments.
*   **State Management:** The `ShippingDiscount.service.ts` heavily relies on a centralized state management approach using Svelte stores for various application data points, facilitating reactive updates throughout the UI.
*   **API Response Queuing:** The use of `createApiResponseQueue()` in `ShippingDiscount.service.ts` suggests a pattern for handling asynchronous API responses in an ordered manner, preventing race conditions or out-of-order processing.
*   **Hardcoded Test Data:** In `merchant.html`, hardcoded `merchantInfo` and example JSON data for cart items (`setCart` function within the excluded `EnvironmentService.ts`) are recurring elements, indicating a development and testing setup.
*   **External Integrations:** References to `confetti` (for UI effects), `GTM` (Google Tag Manager for analytics), `Shopify Analytics`, `Cred` and `TwidPay` (payment/rewards platforms) highlight a system that integrates with several third-party services.

## 12:56:31
In the provided log, all changes are confined to a single file: `/Users/madav/Documents/dashboard_checkout/checkout-dashboard-ui/src/library/components/analytics/analyticsHeader.tsx`. The updates occurred within a short timeframe on **17/10/2025**, indicating rapid iterative development.

**File-Specific Updates for `/Users/madav/Documents/dashboard_checkout/checkout-dashboard-ui/src/library/components/analytics/analyticsHeader.tsx`:**

*   **Initial State (as of 17/10/2025, 12:18:29):** The `AnalyticsHeader` component contained a `Select` dropdown for "Sales Channel" that was conditionally rendered only if `merchantDetails?.platform` was 'shopify' AND `checkoutPlatform` was 'checkout_1'.

*   **Update 1 (17/10/2025, 12:19:47):** The condition for displaying the "Sales Channel" `Select` was modified from `merchantDetails?.platform === 'shopify' && checkoutPlatform === 'checkout_1'` to `merchantDetails?.platform === 'shopify' && checkoutPlatform === 'checkout_1' && isGKP`. This change introduced an additional `&& isGKP` clause, where `isGKP` is true for 'custom' or 'woocommerce' platforms. This new condition effectively made the sales channel selector *never* visible, as a platform cannot be both 'shopify' and 'custom'/'woocommerce' simultaneously.

*   **Update 2 (17/10/2025, 12:20:01):** Shortly after, the logical operator in the "Sales Channel" `Select`'s rendering condition was changed. It shifted from `merchantDetails?.platform === 'shopify' && checkoutPlatform === 'checkout_1' && isGKP` to `merchantDetails?.platform === 'shopify' && checkoutPlatform === 'checkout_1' || isGKP`. This significantly altered the behavior: the sales channel selector would now be visible if the merchant was on 'shopify' with 'checkout_1' *OR* if the merchant was on a 'custom'/'woocommerce' platform (`isGKP` is true).

*   **Update 3 (17/10/2025, 12:37:58):** In the final recorded change, parentheses were added to the condition: `(merchantDetails?.platform === 'shopify' && checkoutPlatform === 'checkout_1') || isGKP`. This modification did not change the logical evaluation of the expression due to operator precedence rules (AND evaluates before OR), but it improved the readability and explicit grouping of the conditions.

**Patterns and Recurring Elements:**

*   All modifications centered on refining the conditional rendering logic for the "Sales Channel" dropdown `Select` component within the `AnalyticsHeader.tsx` file.
*   The `isGKP` variable, indicating "custom" or "woocommerce" platforms, was a key factor in these conditional adjustments.
*   There's a clear pattern of quick iteration and correction, specifically around the logical operators (`&&` vs. `||`) and the grouping of conditions to achieve the desired visibility for the "Sales Channel" selector across different merchant platforms (Shopify, Custom, WooCommerce). The last change focused on code clarity rather than functional alteration.