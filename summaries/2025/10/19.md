# Activity Summary for 19/10/2025

## 15:05:21
**File: `/Users/madav/Documents/checkout UI/gokwik.pdp/src/common/services/ApiService.ts`**

This file, responsible for handling API calls within the application, underwent several updates throughout the logged period.

*   **19/10/2025, 14:20:24**: The initial state of the file defines `getCall` and `postCall` functions. These functions utilize `XMLHttpRequest` to make HTTP requests, incorporating logic for dynamic base URL selection based on environment, managing request headers (including Shopify session and cookie information), and integrating a common loader system. Error handling mechanisms (`sendError`) are present, and API responses are parsed. Notably, `postCall` includes logic to process `priceBreakup` data, updating `store_gyftr` and `store_priceBreakUp`. A critical merchant health check mechanism is in place, which logs 'merchant_unhealthy' events and triggers redirects to Shopify if the checkout is deemed unhealthy.
*   **19/10/2025, 14:22:12 to 14:47:50**: Changes during this timeframe primarily involved modifications to `console.log` statements within the `postCall` function, indicating active debugging and logging adjustments rather than core functional alterations. The placement and content of these logging statements were slightly shifted across different commits.
*   **19/10/2025, 14:50:58**: A significant functional update was introduced. The file began importing `httpsErrorStatusCode` from `../utils/TextConstants`. A new error handling condition was added within the `postCall`'s `xhr.onload` callback. This condition specifically checks if an endpoint identified as a `merchantHealthCheckEndpoint` returns an HTTP status code present in the `httpsErrorStatusCode` list. If this condition is met, the system triggers a `shopifyRedirect`, suggesting a mechanism to gracefully exit to the native Shopify checkout in case of critical API errors.
*   **19/10/2025, 14:59:37**: The list of `merchantHealthCheckEndpoints` in the `postCall` function was expanded to include `APIConfig.login.validateToken`. This change indicates that the application now considers issues with login token validation as part of its critical merchant health checks, which could also lead to a `shopifyRedirect` upon encountering specific HTTP errors.

**File: `/Users/madav/Documents/checkout UI/gokwik.pdp/src/common/utils/TextConstants.ts`**

*   **19/10/2025, 14:50:12**: This file was newly introduced to centralize various UI texts and error messages across the application. It defines constants for:
    *   Special characters (e.g., `rupee`).
    *   JWT token cleanup sources.
    *   Address-related fields and messages (`Address`).
    *   Header labels (`Header`).
    *   Common UI phrases (`Common`).
    *   Mobile number input and OTP flow (`MobileNumber`).
    *   Shopping bag titles (`ShopingBag`, `ShoppingBag`).
    *   Detailed order summary item properties (`OrderSummary`).
    *   Delivery address actions (`DeliverAddress`).
    *   Shipping method messages and errors (`ShippingMethod`).
    *   Discount and coupon-related texts (`Discounts`).
    *   Gift card functionality and messages (`GiftCards`).
    *   General button texts (`ButtonText`).
    *   Order pending page messages (`OrderPendingPage`).
    *   Generic and specific API error messages (`APIErrorHandling`).
    *   Custom validation errors (`CustomErrors`).
    The file also imports image-related constants, suggesting a broader centralization effort for UI assets. The purpose of this file is to enhance maintainability and consistency of textual content.

**Patterns and Recurring Elements:**

*   **API Call Standardization**: There is a clear pattern in `ApiService.ts` for handling API calls (both GET and POST) using `XMLHttpRequest` wrapped in `Promise` objects. This consistent approach includes standardized header construction, loader management, and initial response processing.
*   **Centralized UI Text**: The introduction of `TextConstants.ts` indicates a pattern of centralizing all user-facing strings and error messages. This practice improves code organization, makes it easier to modify or translate UI text, and ensures consistency across the application.
*   **Robust Merchant Health Checks**: The `ApiService.ts` frequently updates and utilizes a list of `merchantHealthCheckEndpoints`. This highlights a recurring focus on monitoring critical API interactions and redirecting users if underlying services are unhealthy. The expansion of these checks to `APIConfig.login.validateToken` signifies an increased scope of what is considered vital for a smooth checkout experience.
*   **Debugging and Logging**: The repeated appearance and adjustments of `console.log` statements within `ApiService.ts` suggest an active development environment where detailed logging is used for debugging and monitoring API call flows.

## 16:05:16
The provided code changes primarily affect two files: `/Users/madav/Documents/checkout UI/gokwik.pdp/src/common/services/ApiService.ts` and `/Users/madav/Documents/checkout UI/gokwik.pdp/src/common/utils/TextConstants.ts` (with an additional log for `/Users/madav/Documents/checkout UI/gokwik.pdp/src/common/utils/ConstantVariables.ts`). All significant updates occurred on October 19, 2025.

**File-Specific Updates:**

*   **`/Users/madav/Documents/checkout UI/gokwik.pdp/src/common/services/ApiService.ts`**
    *   **Timestamp: 19/10/2025, 15:09:43** (replicated identically at 15:11:06, 15:11:16, and 15:13:59).
    *   The file, responsible for API interactions, was updated to import `apiEndpontsToTrack` from `../utils/TextConstants`.
    *   In the `postCall` function, the logic for handling API-related errors that trigger checkout redirects was modified. It now checks if the current URL is included in the `apiEndpontsToTrack` list, rather than a `merchantHealthCheckEndpoints` array defined within the file. This suggests a move towards externalizing and centralizing the configuration of tracked API endpoints.
    *   The `postCall` function also includes detailed logic to parse price breakdown data from API responses, updating Svelte stores (`store_priceBreakUp`, `store_gyftr`) for dynamic UI display of totals, discounts, gift cards, and loyalty points.
    *   Extensive error handling and logging (`logEvent`, `stabilityEvent`, `shopifyRedirectEvent`) are present, especially around merchant health checks, shipping method issues, and payment processing.

*   **`/Users/madav/Documents/checkout UI/gokwik.pdp/src/common/utils/TextConstants.ts`**
    *   **Timestamp: 19/10/2025, 15:10:28** (replicated identically at 15:10:53, 15:12:17, 15:12:47, and 15:13:37).
    *   This file serves as a central repository for various UI-related text constants, messages, and configurations.
    *   It defines constants for special characters (e.g., `rupee`), JWT token cleanup sources, and a stale session token list.
    *   Detailed text constants are provided for `Address` (validation messages, labels), `Header`, `Common` UI elements, `MobileNumber` (OTP messages, error states), `ShoppingBag`, `OrderSummary` (including a comprehensive list of `cartProperty` for customizable items like 'Text', 'Embroidery Color', 'Name of your pet', 'Engraving options'), `DeliverAddress`, `ShippingMethod` (error messages), `Discounts` (coupon messages), `GiftCards` (apply/remove, error messages), `ButtonText`, `Color`, `OrderPendingPage` (payment pending messages), `APIErrorHandling`, and `CustomErrors`.
    *   It's notable that while `ApiService.ts` imports `apiEndpontsToTrack` from this file, the provided logs for `TextConstants.ts` do not show the definition of this constant. This implies either the log for `TextConstants.ts` is an incomplete snapshot or the constant was added and then removed around these timestamps.

*   **`/Users/madav/Documents/checkout UI/gokwik.pdp/src/common/utils/ConstantVariables.ts`**
    *   **Timestamp: 19/10/2025, 15:39:44**.
    *   This file introduces application-wide configuration and experiment variables.
    *   `InititalConstants` defines custom payment UI texts (`badge_text_message`, `btn_text`, `subtext`) and color schemes for various payment methods (UPI, COD, Cards, Wallet, BNPL, Credpay, EMI, PPCOD).
    *   `cardValidationError` provides specific error messages for card-related validations.
    *   `partailAddressInitialValue` defines default states for address fields.
    *   `couponFilterList` and `noSaveLineList` define lists for coupon filtering and saving exclusions.
    *   A large `experiments` object lists numerous A/B testing or feature flag keys, covering payment modes, UI versions, COD flows, UPI configurations, display of BNPL/Twid/Credpay/Snapmint/Bharatx, offers UX, pricing displays, and mobile/desktop UI syncing.
    *   `experimentVariants` provides the possible values for each experiment.
    *   `errorEvents` defines a comprehensive, categorized list of event names for tracking various API failures, load time issues, and specific errors across different payment methods (UPI, Cards, Wallets, Netbanking, EMI, BNPL, Snapmint, Credpay, Capture, PPCOD, OFPL, COD, Coupons, BharatxPay, Simpl).
    *   `loadTimeVariables` links specific screen names to their corresponding load time error events.
    *   Other constants include `MIN_ORDER_VALUE_FOR_EMI_ELIGIBILITY`, `upiPaymentType`, and `pageNames`.

**Patterns and Recurring Elements:**

*   **Centralization of Configuration and Constants:** There's a clear pattern of externalizing and centralizing strings, error messages, API endpoint lists (inferred for `TextConstants.ts` from `ApiService.ts` import), and application configurations into dedicated utility files (`TextConstants.ts`, `ConstantVariables.ts`). This promotes consistency, maintainability, and easier updates.
*   **Robust Error Handling and Analytics:** A strong emphasis is placed on detailed error messages, specific error event logging, and redirection strategies for various failure scenarios across API calls and payment processes. This indicates a focus on user experience, debugging, and application stability.
*   **A/B Testing and Feature Toggling:** The extensive `experiments` and `experimentVariants` in `ConstantVariables.ts` highlight a development approach that heavily relies on feature flags and A/B testing to iterate on UI/UX and payment flows.
*   **Checkout and Payment Focus:** The majority of changes revolve around the checkout process, including address management, shipping methods, discounts, gift cards, and a wide array of payment methods, confirming the project's core functionality as a checkout UI.
*   **Timestamp Concentration:** All changes occurred on the same day within a short timeframe, suggesting a concerted development effort or a single deployment bundle.