# Activity Summary for 20/11/2025

## 10:51:51
For `/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/settings/customizeUI/brandPage.tsx` (Timestamp: 16/11/2025, 13:10:34):
This file introduces a `BrandPage` component for customizing a brand's UI. Key features include logo upload functionality with validation (file type, size), interaction with AWS S3 via pre-signed URLs (`presingedLogoUrl`, `makeAWSPutCall`), and a color picker for selecting the primary theme color. It fetches existing merchant logo and custom CSS configurations on component mount and provides a "Save Changes" button to persist updates through API calls.

For `/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/library/components/discounts/productSearch.tsx` (Timestamp: 17/11/2025, 16:22:51):
An enhanced `ProductSearch` component was implemented, designed for searching and selecting products or collections in contexts like discount or free gift configurations. It features infinite scrolling, debounced search input, a modal for item selection, and robust logic for handling product variants, quantities, and filtering (e.g., `isAgentLed` to exclude 'no-agent' tagged items). It also includes specific handling for "top-up gifts" and quantity validation for collections.

For `/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/orders/order-details/index.tsx` (Timestamp: 17/11/2025, 16:23:04):
The order details page received significant updates. Changes include a custom currency formatter (`formatAmountWithCurrency`), improved handling of refund data with a `mergeRepeatedRefunds` function to consolidate multiple attempts, and dynamic calculation of refundable amounts to control the refund button's state. Logic was added to set an "Edit Order" title with conditional messages based on applied rewards or discount types (e.g., Twid rewards, GWP discounts). Price breakup calculations for various discounts, taxes, shipping, and gift cards were also refined.

For `/Users/mayuresh.madav/Documents/dashboard/dashboard-ui-configuration/src/index.ejs` (Timestamp: 18/11/2025, 00:45:31):
This `index.ejs` template, acting as the micro-frontend shell for the dashboard, was configured to load various `@gokwik` micro-frontends (e.g., `@gokwik/configuration`, `@gokwik/checkout`, `@gokwik/payment`) using `systemjs-importmap`. These import maps are dynamically set based on the `deployedEnv` (local, dev, qa, sandbox, production). It also sets up a Content Security Policy (CSP) and integrates external monitoring tools like Clarity and New Relic for the production environment.

For `/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/settings/free-gift/freeGift.tsx` (Timestamps: 18/11/2025, 00:49:40, 18/11/2025, 00:50:14, 18/11/2025, 00:58:39):
This component manages free gift rules. It provides a form for defining rule details such as name, applicable sales channels, purchase requirements (cart value/quantity), and what the gift applies to (all products, specific products, specific collections). It integrates the `ProductSearch` component for selecting free gift items and applicable products/collections. Rules can be enabled/disabled, edited, or deleted via a table interface. The multiple timestamps for this file with identical content suggest non-functional saves or formatting changes.

For `/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/library/components/orderConfirmationPage/collapseFields.tsx` (Timestamp: 18/11/2025, 23:42:52):
A new `CustomizeUiFields` component was introduced to enable granular customization of the order confirmation page. It organizes various UI elements (Brand Logo, Dynamic Banners, Trust Banner, Order Details, Customer Information, Support & Communication) into collapsible sections. Each section includes fields for content, color customization via `ColorPickerHelper`, and an enable/disable switch. A significant addition is the drag-and-drop functionality, allowing users to reorder these sections on the confirmation page.

For `/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/settings/orderConfirmation/index.tsx` (Timestamps: 19/11/2025, 21:10:01, 19/11/2025, 21:11:54, 19/11/2025, 21:12:22, 19/11/2025, 21:12:29):
This file marks the introduction of the main "Order Confirmation Page" settings. It acts as a container for configuring the post-purchase experience, including an overall switch to enable/disable the custom confirmation page and an alert message. It integrates `MainSection` (which likely uses components like `CustomizeUiFields`) for detailed customization and displays an `OrderConfirmationPreview` in a side panel. The `handleFormSubmit` function handles form validation, with specific fields excluded. Minor layout adjustments to the column widths for the form and preview sections were observed across the subsequent timestamps.

**Patterns and Recurring Elements:**

*   **UI Customization Focus:** A consistent pattern across multiple files is the extensive focus on customizing the user interface (checkout, brand page, order confirmation page) using `gokwik-ui-kit` components like `Form`, `Card`, `Switch`, `ColorPicker`, and dynamic field rendering (`RenderField`).
*   **Merchant Configuration Management:** The `useMerchantConfigApi` hook is frequently used for fetching and saving merchant-specific configurations, indicating a centralized approach to managing settings across different dashboard features.
*   **Micro-frontend Architecture:** The dashboard utilizes a `single-spa` micro-frontend architecture, as evidenced by `index.ejs` dynamically loading various `@gokwik` micro-frontends via `systemjs-importmap` based on the deployment environment.
*   **Form-driven UI:** Most configuration pages are built around `gokwik-ui-kit`'s `Form` component, leveraging `Form.useForm()`, `Form.useWatch()`, and validation rules for robust data input and management.
*   **Breadcrumb Navigation:** The `updateBreadcrumbs` utility is consistently used to manage and update navigation paths across different pages.
*   **Component Reusability:** Components like `ProductSearch` and `RenderField` are designed to be generic and reusable across various settings pages.
*   **API Interactions:** `makeAPICall` is the standard utility for backend communication, ensuring consistent data fetching and updates.

## 12:51:51
The log details recent development on a `Gokwik` dashboard UI, primarily focusing on merchant settings, order details, and general UI configuration.

**File-Specific Updates:**

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/settings/customizeUI/brandPage.tsx`** (Timestamp: 16/11/2025, 13:10:34)
    *   This file manages the "Brand Page" for customizing checkout UI. It includes functionalities for uploading and managing merchant logos (fetching existing, getting presigned URLs for new uploads, client-side validation, uploading to AWS S3, and updating Redux state), along with a color picker for theme customization. Form handling is done using Ant Design's `Form` and includes `useEffect` hooks to synchronize form data with merchant configuration. A "Save Changes" button is enabled based on form modifications.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/library/components/discounts/productSearch.tsx`** (Timestamp: 17/11/2025, 16:22:51)
    *   A versatile `ProductSearch` component for finding and selecting Shopify products or collections. It supports infinite scrolling (`useIntersectionObserver`), debounced search, filtering by agent-led tags, and displays results in a modal. It allows for managing selected items, including incrementing/removing quantities and handling specific gift pricing. The component is highly configurable with props to hide elements, specify search type, and control item selection behavior.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/orders/order-details/index.tsx`** (Timestamp: 17/11/2025, 16:23:04)
    *   This page displays comprehensive order details. It fetches order information, processes refund data (merging repeated attempts), calculates various price breakups (discounts, taxes, shipping, gift cards, rewards), and determines the refundable amount. It includes UI for displaying order status, customer contact information (masked initially), and conditionally disabling the edit order button based on applied rewards/discounts. Currency formatting is dynamically set based on order data or merchant details.

*   **`/Users/mayuresh.madav/Documents/dashboard/dashboard-ui-configuration/src/index.ejs`** (Timestamp: 18/11/2025, 00:45:31)
    *   This is the main HTML template for a Single-SPA micro-frontend application. It defines the Content Security Policy, imports shared React dependencies, and conditionally loads micro-frontend applications (`@gokwik/configuration`, `@gokwik/utilities`, `@gokwik/dashboard`, `@gokwik/checkout`, etc.) based on the deployment environment (local, dev, qa, sandbox, production). Notably, the `sandbox` environment import URLs for several `@gokwik` applications were updated, and the `production` environment includes scripts for Microsoft Clarity and New Relic for analytics and application performance monitoring.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/settings/free-gift/freeGift.tsx`** (Timestamps: 18/11/2025, 00:49:40, 18/11/2025, 00:50:14, 18/11/2025, 00:58:39)
    *   This page configures "Free Gift" rules. It uses `useMerchantConfigApi` for configuration management and `ProductSearch` for selecting free gift products. The UI allows defining rules with a name, sales channels (app, web, agent-led), purchase requirements (cart value, quantity), min/max values, applicability (all products, specific products/collections), gift quantity/price, and application method (auto or customer selection). Rules can be added, edited, deleted, and enabled/disabled via a table interface. The multiple timestamps for this file with identical content suggest repeated saves without significant code changes or quick versioning during development.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/library/components/orderConfirmationPage/collapseFields.tsx`** (Timestamp: 18/11/2025, 23:42:52)
    *   A new component, `CustomizeUiFields`, was added to structure and manage various customizable sections of the order confirmation page. It uses collapsible panels (`Collapse` from `gokwik-ui-kit`) for "Brand Logo Customization," "Dynamic Banners," "TrustBanner," "Order Details," "Customer Information," and "Support & Communication." Each section can be enabled/disabled via a `Switch` and includes form fields for text, colors (`ColorPickerHelper`), and linking custom components like `LogoPage` and `TrustBadgeForm`. It also implements drag-and-drop functionality to reorder these sections.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/settings/orderConfirmation/index.tsx`** (Timestamps: 19/11/2025, 21:10:01, 19/11/2025, 21:11:54, 19/11/2025, 21:12:22, 19/11/2025, 21:12:29)
    *   This is the main page for configuring the custom order confirmation page, using the `CustomizeUiFields` component internally. It provides an "Enable Custom Order Confirmation Page" switch and an informational `Alert`. The page is split into two columns: a left column for the configuration `Form` and a right column for an `OrderConfirmationPreview`. Over several minor updates, the `flex` properties of the layout columns were adjusted multiple times, eventually settling on `flex='1 1 300px'` for the form column and `flex='0 1 500px'` for the preview column, indicating iterative fine-tuning of the responsive layout. Form validation and a "Save Changes" button (enabled on modification) are also present.

**Timestamps of Significant Changes:**

*   **16/11/2025, 13:10:34:** Initial development or major update to the Brand Page UI customization.
*   **17/11/2025, 16:22:51 - 16:23:04:** Concurrent work on core components like `ProductSearch` and a detailed `OrderDetails` page.
*   **18/11/2025, 00:45:31:** Crucial infrastructure update in `index.ejs` for micro-frontend configuration, especially for the `sandbox` environment and production monitoring.
*   **18/11/2025, 23:42:52:** Introduction of a new, complex component (`collapseFields.tsx`) for modular UI customization of the order confirmation page.
*   **19/11/2025, 21:10:01 - 21:12:29:** Rapid iterations on the `OrderConfirmationPage` layout and structure, indicating active UI/UX refinement.

**Patterns and Recurring Elements:**

*   **Standardized UI Library:** The `gokwik-ui-kit` is consistently used across all UI-related files, ensuring a cohesive look and feel.
*   **Ant Design Forms:** Ant Design's `Form` component with `useForm` and `useWatch` hooks is a pervasive pattern for complex form state management and data binding.
*   **Merchant Configuration Management:** The `useMerchantConfigApi` hook (from `@library/utilities/hooks/useMerchantConfig`) is frequently used for fetching and saving merchant-specific settings, highlighting a centralized approach to configuration.
*   **API Interactions:** `makeAPICall` is a common utility for network requests, typically paired with `APIEndPoints` for structured API access.
*   **State Management:** Redux (`useSelector`, `useAppDispatch`) handles global state (e.g., merchant details), while `useState` manages local component states.
*   **UI Customization Focus:** A significant portion of the changes (Brand Page, Order Confirmation Page, Free Gift) revolves around providing merchants granular control over their checkout and post-purchase UI/UX.
*   **Breadcrumbs:** `updateBreadcrumbs` utility is used across different pages to maintain consistent navigation.
*   **Micro-frontend Architecture:** The `index.ejs` file clearly indicates the use of Single-SPA and SystemJS for a micro-frontend setup, allowing different parts of the dashboard to be developed and deployed independently.
*   **Observability:** Integration of New Relic and Microsoft Clarity signifies an emphasis on monitoring application performance and user behavior in production.

## 13:51:52
**File-Specific Updates:**

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/settings/customizeUI/brandPage.tsx`** (Timestamp: 16/11/2025, 13:10:34)
    *   This file, responsible for brand UI customization, received significant updates to its logo upload and color picking functionality.
    *   It now includes robust client-side image validation (file type and size up to 2MB for JPG, PNG, SVG).
    *   The logo upload process involves cleaning images with a canvas, generating unique image paths, fetching pre-signed AWS S3 URLs, and performing the actual AWS S3 PUT call.
    *   Existing logo and primary theme color are fetched from merchant configuration upon component load.
    *   A "Save Changes" button is introduced, which is disabled by default and enabled only when form values are modified, providing clear feedback to the user.
    *   The UI integrates `InfoComponent` for descriptive help, `ColorPicketComponent` for theme selection, and an `Upload` component for the logo, featuring a live preview of the uploaded logo or a placeholder.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/library/components/discounts/productSearch.tsx`** (Timestamp: 17/11/2025, 16:22:51)
    *   The `ProductSearch` component, used for selecting products or collections in discount/free gift configurations, has been enhanced with new features.
    *   It now supports filtering products based on an `isAgentLed` prop, which excludes items tagged with 'no-agent'.
    *   A `topUpGift` feature introduces an `InputNumber` to specify an "Offered Price" for freebies directly within the product display.
    *   For collections, `collectionSpecificData` is introduced to manage quantities, including validation to ensure collection quantity does not exceed a predefined minimum purchase quantity.
    *   The `parseResponse` function was updated to handle `collateProducts`, grouping product variants and tracking minimum prices and total variants.
    *   Functions `handleGiftPrice`, `handleQuantityChange`, and `handleCloseAllInput` manage these new functionalities.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/orders/order-details/index.tsx`** (Timestamp: 17/11/2025, 16:23:04)
    *   The order details page received extensive updates, focusing on improved data display, refund management, and currency formatting.
    *   New constants for RTO (Return to Origin) reasons and permissions, along with an internal team identifier, were added.
    *   A custom `formatAmountWithCurrency` helper ensures consistent currency symbol display globally.
    *   A `mergeRepeatedRefunds` utility function was added to aggregate and simplify the display of multiple refund attempts, improving clarity on refund status and attempts.
    *   New states were introduced to control the visibility of customer contact information (phone and email) and display order failure reasons.
    *   The refund button's state (disabled, refundable amount) is now dynamically calculated based on successful and pending transactions, along with store credits.
    *   Logic was added to disable order editing under specific conditions, such as when Twid rewards, GWP discounts, or loyalty points are applied.
    *   The method for fetching order details was adjusted to conditionally include a hash for non-merchant users.
    *   Detailed calculations for `total_discount`, `tax`, `shipping_and_cod_charges`, and `gift_card_and_rewards` were refined, pulling data from various price breakup values.

*   **`/Users/mayuresh.madav/Documents/dashboard/dashboard-ui-configuration/src/index.ejs`** (Timestamp: 18/11/2025, 00:45:31)
    *   This EJS template, which defines the dashboard's main structure and micro-frontend loading, underwent several infrastructural enhancements.
    *   It now includes a `favicon.svg` and updated `Content-Security-Policy` rules to support `data:` and `http:` for images.
    *   A global `window.fcWidgetMessengerConfig` was added, likely for a chat widget.
    *   New Relic browser monitoring script was embedded specifically for the `production` environment, along with Microsoft Clarity analytics when a `clarityKey` is present.
    *   The `systemjs-importmap` configurations for `dev`, `qa`, `sandbox`, and `production` environments were expanded to include new micro-frontends: `@gokwik/kwikcomm`, `@gokwik/checkout-platform`, `@gokwik/shopify-app`, and `@gokwik/ellora`, indicating an ongoing expansion and modularization of the dashboard.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/settings/free-gift/freeGift.tsx`** (Timestamps: 18/11/2025, 00:49:40; 18/11/2025, 00:50:14; 18/11/2025, 00:58:39)
    *   This component manages the creation and configuration of automatic free gift rules.
    *   The `initialValues` for new rules have been explicitly defined, including default sales channels, purchase requirements, and application methods.
    *   The form fields are dynamically rendered using `RenderField` and include options for rule name, sales channels (with `shopify_agent` channel dynamically enabled/disabled based on application method), purchase type (cart value or quantity), min/max value validation, and applicability on all, specific products, or specific collections.
    *   A `ProductSearch` component is integrated for selecting the free gift product, along with input fields for free gift quantity and price.
    *   The "Free Gift Addition Method" (Auto or Selection) and a "Selection Limit" (conditionally hidden) are now configurable.
    *   A table displays existing free gift rules, allowing users to enable/disable them via a `Switch` and offering "Edit" and "Delete" actions through a `Dropdown`.
    *   The content of this file is identical across all three timestamps, suggesting repeated saving without functional changes, or minor unlogged changes that were reverted.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/library/components/orderConfirmationPage/collapseFields.tsx`** (Timestamp: 18/11/2025, 23:42:52)
    *   This new component provides a highly configurable and reorderable interface for customizing various sections of the order confirmation page.
    *   It introduces collapsible panels for "Brand Logo Customization," "Dynamic Banners," "TrustBanner," "Order Details," "Customer Information," and "Support & Communication."
    *   Each section can be individually enabled/disabled via a `Switch` in the panel header.
    *   Customization options within each section include `Input` fields for text (e.g., confirmation message, heading text, button text) with length constraints, and `ColorPickerHelper` components for setting background and text colors.
    *   A key feature is the implementation of drag-and-drop functionality, allowing users to reorder the collapsible sections directly within the UI, which updates the underlying form structure.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/settings/orderConfirmation/index.tsx`** (Timestamps: 19/11/2025, 21:10:01; 19/11/2025, 21:11:54; 19/11/2025, 21:12:22; 19/11/2025, 21:12:29)
    *   This page serves as the main interface for customizing the order confirmation page, featuring both form controls and a live preview.
    *   It includes a global switch to "Enable Custom Order Confirmation Page" and an `Alert` providing information about redirecting customers from Shopify.
    *   The page is divided into two columns: a left column for form inputs (`InfoComponent`, "Save Changes" button, and `MainSection` which likely contains the `CollapseFields` component) and a right column displaying an `OrderConfirmationPreview`.
    *   The `handleFormSubmit` function was refined to selectively validate form fields, excluding specific fields like `trust_text` and `trust_tag` which might not require validation.
    *   The multiple rapid commits within minutes indicate active UI layout adjustments, specifically regarding the `flex` properties of the left and right columns (e.g., `flex='1 1 200px'` vs. `flex='1 1 300px'`), suggesting iterative design tweaks for the responsive layout of the settings page. The core functionality remained stable across these layout changes.

**Patterns and Recurring Elements:**

1.  **UI Kit Consistency:** All `checkout-dashboard-ui` files heavily utilize `gokwik-ui-kit` components (Button, Form, Card, Row, Col, Input, Switch, Dropdown, Table, message, Tooltip, Alert), indicating a consistent design system.
2.  **Form Management:** Extensive use of Ant Design's `Form` API, including `Form.useForm()`, `Form.useWatch()`, `Form.Item`, `Form.setFieldValue()`, and `form.validateFields()` for handling complex form states and user inputs.
3.  **Merchant Configuration through Hooks:** The `useMerchantConfigApi` hook is a recurring pattern for fetching, modifying, and saving merchant-specific configurations, centralizing settings management.
4.  **Micro-frontend Architecture:** The `index.ejs` file clearly demonstrates a micro-frontend setup, loading different `@gokwik/*` applications dynamically based on the deployment environment, supporting modular development and deployment.
5.  **Environment-Specific Configuration:** Both the `.env` (not summarized but noted for context) and `index.ejs` files highlight the use of environment variables and conditional loading for different deployment stages (dev, qa, sandbox, production).
6.  **Breadcrumbs Management:** The `updateBreadcrumbs` utility is consistently used to manage navigation paths across different pages, ensuring a coherent user experience.
7.  **Iterative UI/UX Refinement:** The frequent, minor changes within a short time frame for `freeGift.tsx` and `orderConfirmation/index.tsx` point to an active and iterative process of fine-tuning user interfaces and layouts.
8.  **Centralized Utilities:** Imports like `makeAPICall`, `updateBreadcrumbs`, `deepEqualAndDiff`, `formatAmount`, and helper components (`RenderField`, `InfoComponent`) suggest a well-structured codebase with reusable utilities and components.

## 14:51:48
The recent code changes primarily focus on enhancing the merchant dashboard's UI customization and order management features, alongside infrastructure updates for deployment and monitoring.

### File-Specific Updates:

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/settings/customizeUI/brandPage.tsx` (Timestamp: 16/11/2025, 13:10:34)**
    This file saw significant updates to the brand page UI customization. It now supports robust logo uploads, including file type/size validation, cleaning images with canvas, generating presigned AWS URLs for secure uploads, and displaying the uploaded logo. The component also integrates a color picker for theme customization, fetches merchant logo and primary color from configuration, and dispatches updates to the Redux store.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/library/components/discounts/productSearch.tsx` (Timestamp: 17/11/2025, 16:22:51)**
    A minor update was made to the `ProductSearch` component, introducing a `topUpGift` prop. When enabled, this feature allows users to specify a "Freebie Price" for selected products, enhancing the flexibility of discount configurations.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/orders/order-details/index.tsx` (Timestamp: 17/11/2025, 16:23:04)**
    The order details page received substantial enhancements. Key changes include improved currency formatting with dynamic symbols, refined refund processing that merges repeated attempts and updates statuses (e.g., "Completed," "Failed," "Initiated"), and dynamic logic to determine if an order can be edited based on applied rewards or discount types. Calculations for total discounts, taxes, shipping, COD charges, gift cards, and rewards have been made more comprehensive by incorporating a wider range of price breakup values.

*   **`/Users/mayuresh.madav/Documents/dashboard/dashboard-ui-configuration/src/index.ejs` (Timestamp: 18/11/2025, 00:45:31)**
    This file underwent significant infrastructure changes. A Content Security Policy (CSP) was added to enhance security. The Freshchat widget was integrated for customer support. SystemJS import maps were updated to include a new `@gokwik/kwikcomm` module across `dev`, `qa`, and `sandbox` environments. Crucially, New Relic browser monitoring and Microsoft Clarity tracking scripts were integrated for the `production` environment to enable performance monitoring and analytics.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/settings/free-gift/freeGift.tsx` (Timestamps: 18/11/2025, 00:49:40, 00:50:14, 00:58:39)**
    This file, appearing in the log multiple times without functional changes between entries, introduces a comprehensive interface for managing automatic free gift rules. Merchants can define rules based on criteria like cart value, quantity, specific products or collections, and sales channels. The UI provides a form for rule creation/editing and a table to view, enable/disable, and delete rules, including selecting free gift products and setting their quantity/price.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/library/components/orderConfirmationPage/collapseFields.tsx` (Timestamp: 18/11/2025, 23:42:52)**
    A new component, `CustomizeUiFields`, was introduced to provide granular UI customization for the order confirmation page. It allows merchants to enable/disable various sections (e.g., Brand Logo, Dynamic Banners, Trust Banner, Order Details, Customer Information, Support & Communication), modify their textual content, set background and text colors using a `ColorPickerHelper`, and reorder these sections via drag-and-drop functionality.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/settings/orderConfirmation/index.tsx` (Timestamps: 19/11/2025, 21:10:01, 21:11:54, 21:12:22, 21:12:29)**
    This is the main entry point for the Order Confirmation Page settings. It introduces the ability to enable a custom confirmation page. The page features an informational alert about redirecting from Shopify's page, a form to configure the custom page's content and appearance (utilizing `MainSection` which likely wraps `CustomizeUiFields`), and a preview panel (`OrderConfirmationPreview`). The layout experienced minor, rapid adjustments over a few minutes, specifically in the flex widths of the configuration and preview columns, with the final state at 21:12:29 providing a wider configuration panel.

### Patterns and Recurring Elements:

*   **Component-Based UI Development:** The codebase heavily relies on React components and `gokwik-ui-kit` (Ant Design-based) for building modular and interactive user interfaces.
*   **State and Form Management:** Extensive use of React hooks like `useState`, `useEffect`, `useMemo`, and Ant Design's `Form.useForm` and `Form.useWatch` indicates a sophisticated approach to managing local and form-specific state, enabling dynamic UI updates.
*   **Centralized Configuration:** The `useMerchantConfigApi` hook is a recurring element, suggesting a standardized way to interact with merchant-specific settings, allowing for consistent data fetching and saving across different customization features.
*   **API Integration:** API calls using `makeAPICall` and `makeAWSPutCall` are fundamental, often coupled with environment variables (`process.env.REACT_APP_BASE_URL`) and predefined endpoints, for data persistence and external service interactions.
*   **Navigation and Context:** `updateBreadcrumbs` is consistently used to maintain navigational context across different pages.
*   **Layout and Styling:** Frequent use of `Row`, `Col`, `Card` components from `gokwik-ui-kit` along with Tailwind CSS-like utility classes for responsive and consistent layout and styling.
*   **Customization Focus:** A strong pattern emerges around building detailed customization UIs for merchants, allowing them to tailor branding, promotional offers (free gifts), and the post-purchase experience (order confirmation page).

## 15:51:43
The recent code changes, all occurring in mid-November 2025, primarily focus on enhancing the "checkout-dashboard-ui" application, with a minor update to "dashboard-ui-configuration." A recurring pattern observed is the use of `gokwik-ui-kit` (likely Ant Design-based components) for UI, `Form.useForm()` for state management, and custom helper components like `RenderField` and `InfoComponent`. Several files show multiple, near-identical saves within minutes, indicating rapid development or minor UI tweaks.

Here's a breakdown of key updates by file:

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/settings/customizeUI/brandPage.tsx`** (Timestamp: 16/11/2025, 13:10:34)
    This file received significant updates to its brand customization capabilities. It now includes enhanced logo management with functions for validating image types and sizes, fetching pre-signed URLs, and uploading to AWS S3. A `ColorPicker` component was introduced for theme color selection, and the `onFinish` logic was updated to save both logo data and primary color CSS rules. The UI was structured with `Card`, `Row`, and `Col` for an organized display of customization options.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/library/components/discounts/productSearch.tsx`** (Timestamp: 17/11/2025, 16:22:51)
    The `ProductSearch` component was extended with new props and functionalities, making it more versatile for discount configurations. Key additions include options to hide the search input, filter products for "agent-led" scenarios based on tags, and handle "top-up gift" pricing. Logic for managing collection-specific quantities with validation was also implemented. The `parseResponse` and `fetchData` functions were updated to accommodate these new filtering and collation requirements.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/orders/order-details/index.tsx`** (Timestamp: 17/11/2025, 16:23:04)
    This file underwent extensive refactoring to improve order details display and refund management. New helper functions (`formatCurrency`, `formatAmountWithCurrency`) ensure consistent currency formatting. Status mappings were added for better visual representation of order and refund states. A `mergeRepeatedRefunds` function was introduced to consolidate multiple refund attempts. The component also gained logic to disable order editing under specific conditions (e.g., when Twid rewards or loyalty points are applied) and to calculate detailed price breakups including discounts, taxes, shipping, and gift cards. Masked customer contact information is now handled.

*   **`/Users/mayuresh.madav/Documents/dashboard/dashboard-ui-configuration/src/index.ejs`** (Timestamp: 18/11/2025, 00:45:31)
    This configuration file was updated to integrate third-party analytics and performance monitoring tools: Microsoft Clarity and the New Relic Browser Agent. It also included minor enhancements such as adding a favicon and setting the document title. The `Content-Security-Policy` was adjusted to allow connections to `wss://*.gokwik.io`, and `@gokwik/kwikcomm` was added to the module import maps for `dev` and `qa` environments.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/settings/free-gift/freeGift.tsx`** (Timestamps: 18/11/2025, 00:49:40, 18/11/2025, 00:50:14, 18/11/2025, 00:58:39)
    This file, which saw three almost identical updates, implements a "Free Gift" settings page. It provides a comprehensive form for defining free gift rules, covering aspects like rule name, sales channels (with conditional disabling for "Agent led"), purchase requirements (cart value or quantity), minimum/maximum values, and applicability to all products, specific products, or collections. Merchants can select free gift products, specify quantities and prices, and choose between automatic addition or customer selection with a limit. A table displays active rules with toggles for enabling/disabling and actions for editing or deleting them.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/library/components/orderConfirmationPage/collapseFields.tsx`** (Timestamp: 18/11/2025, 23:42:52)
    A new `CustomizeUiFields` component was introduced to manage various UI customization options for the order confirmation page. It organizes settings into collapsible panels for Brand Logo, Dynamic Banners, TrustBanner, Order Details, Customer Information, and Support & Communication. Each section features enable/disable switches, specific input fields (e.g., confirmation messages, heading texts, button links), and color pickers for background and text colors. The component also supports drag-and-drop functionality for reordering these customization sections.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/settings/orderConfirmation/index.tsx`** (Timestamps: 19/11/2025, 21:10:01, 19/11/2025, 21:11:54, 19/11/2025, 21:12:22, 19/11/2025, 21:12:29)
    This file defines the main Order Confirmation Page settings. It allows merchants to enable a custom confirmation page and configure its appearance. The page features a two-column layout: one for the configuration form (`MainSection`) and another for a live preview (`OrderConfirmationPreview`). The multiple updates to this file primarily involved minor adjustments to the `flex` properties of the layout columns, likely fine-tuning the responsiveness of the settings interface. Form validation logic was also present, with specific exclusions for `trust_text` and `trust_tag` fields.

## 16:51:53
**/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/settings/customizeUI/brandPage.tsx** (Timestamp: 16/11/2025, 13:10:34)
This file defines a React component (`BrandPage`) for customizing a merchant's UI branding. Key functionalities include:
*   **Logo Management:** Allows uploading a brand logo (JPEG, PNG, SVG, max 2MB), validates file type and size, processes the image using `cleanImageWithCanvas`, uploads it to AWS via a presigned URL (`fetchUploadedLogoURL`, `makeAWSPutCall`), and updates the form and Redux store. It also fetches existing logo URLs.
*   **Theme Color Customization:** Provides a `ColorPicketComponent` to set the primary theme color.
*   **Configuration Saving:** Utilizes `useMerchantConfigApi` to save the logo path and primary color as part of the merchant's custom configuration.
*   **UI Elements:** Employs `gokwik-ui-kit` components like `Form`, `Upload`, `Button`, `Card`, and `ColorPicker`, along with an `InfoComponent` for page context. The "Save Changes" button is enabled when form values change.

**/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/library/components/discounts/productSearch.tsx** (Timestamp: 17/11/2025, 16:22:51)
This component (`ProductSearch`) provides a versatile search and selection interface for Shopify products or collections, typically used in discount or free gift configurations.
*   **Search Functionality:** Fetches products or collections using `fetchShopifyCollectionsOrProducts` with support for debounced searching and infinite scrolling via an Intersection Observer.
*   **Item Management:** Allows adding/removing selected items, managing quantities for product variants, and handling collection-specific quantities with validation.
*   **Conditional Rendering:** Highly configurable via props (`searchType`, `hideButton`, `showQuantity`, `collateProducts`, `isAgentLed`, `topUpGift`, etc.) to adapt to different use cases.
*   **UI Elements:** Integrates `gokwik-ui-kit` components such as `Input`, `SearchOutlined`, `Modal`, `Button`, `InputNumber`, and various icons to display search results and selected items. Products can be filtered for "agent-led" scenarios.

**/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/orders/order-details/index.tsx** (Timestamp: 17/11/2025, 16:23:04)
This file implements the `OrderDetails` page, displaying comprehensive information for a specific order.
*   **Order Data Fetching:** Retrieves order details using `makeAPICall` based on order ID, creation timestamp, or merchant order ID, with special handling for internal team access or COD token.
*   **Refund Management:** Merges repeated refund attempts (`mergeRepeatedRefunds`) and calculates the total refundable amount, determining the state of the refund button. A `RefundDrawer` component is integrated for processing refunds.
*   **Price Breakups:** Uses helper functions (`DiscountBreakupsData`, `TaxBreakupData`, etc.) to display detailed price breakdowns including discounts, taxes, shipping, COD charges, gift cards, and rewards.
*   **UI Elements:** Leverages `gokwik-ui-kit` components like `Button`, `Table`, `Tabs`, `Tag`, `Tooltip`, and icons to structure the order details, transactions, and refunds.
*   **Currency Handling:** Dynamically sets the global currency symbol based on order data or merchant details.
*   **Conditional Features:** Shows RTO (Return To Origin) actions and scores based on merchant configuration, and disables order editing if Twid rewards or Loyalty Points are applied.
*   **User Details:** Fetches merchant and user configurations and permissions.

**/Users/mayuresh.madav/Documents/dashboard/dashboard-ui-configuration/src/index.ejs** (Timestamp: 18/11/2025, 00:45:31)
This is the main HTML template for the `Gokwik Dashboard`, part of a single-spa microfrontend architecture.
*   **HTML Structure:** Sets up the basic HTML boilerplate, including meta tags for charset, viewport, and a Content Security Policy (CSP).
*   **Microfrontend Loading:** Uses `systemjs-importmap` to define and load shared dependencies (React, React-DOM, single-spa) and various `@gokwik` microfrontends (e.g., `@gokwik/configuration`, `@gokwik/utilities`, `@gokwik/checkout`).
*   **Environment-Specific Loading:** The import map URLs for microfrontends are conditional based on the `deployedEnv` (local, dev, qa, sandbox, production), allowing different environments to load their respective builds.
*   **Analytics Integration:** Includes scripts for `New Relic` performance monitoring and `Clarity` analytics in the production environment.

**/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/settings/free-gift/freeGift.tsx** (Timestamp: 18/11/2025, 00:49:40, 18/11/2025, 00:50:14, 18/11/2025, 00:58:39)
These three log entries for `freeGift.tsx` show identical code content, indicating no functional changes were made across these timestamps, possibly only minor saves or reformatting.
The file defines the `FreeGift` component for configuring automatic free gift rules for merchants.
*   **Rule Management:** Allows creating, editing, and deleting free gift rules. Rules are managed in a `newGift` state array.
*   **Form Definition:** Uses an extensive `fields` array to dynamically render form inputs (`RenderField` helper) for defining rule name, sales channels (app, web, agent-led), purchase requirements (cart value, quantity, min/max values), applicability (all products, specific products/collections), free gift product selection, quantity, price, and gift addition method (auto or selection).
*   **Product/Collection Selection:** Integrates the `ProductSearch` component for selecting specific products or collections that trigger the gift or are given as gifts.
*   **Configuration Saving:** Employs `useMerchantConfigApi` (with `patch: true`) to persist free gift configurations.
*   **UI Elements:** Uses `gokwik-ui-kit` components like `Form`, `Card`, `Drawer` (for new rules), `Table` (to list rules), `Dropdown` (for actions), and `Switch` (to enable/disable rules).
*   **Breadcrumbs:** Updates the navigation breadcrumbs for the "Free Gift Settings" page.

**/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/library/components/orderConfirmationPage/collapseFields.tsx** (Timestamp: 18/11/2025, 23:42:52)
This component (`CustomizeUiFields`) provides collapsible sections for configuring various parts of the Order Confirmation Page UI.
*   **Modular Customization:** Consists of multiple collapsible panels, each dedicated to a specific section: Brand Logo, Dynamic Banners, Trust Banner, Order Details, Customer Information, and Support & Communication.
*   **Dynamic Fields:** Each section uses an array of field definitions (`orderDetailFields`, `customerInformationFields`, `supportDetailFields`) rendered by a `RenderField` helper. Fields include switches to enable/disable sections, input fields for text, and `ColorPickerHelper` for background and text color customization.
*   **Drag-and-Drop:** Implements drag-and-drop functionality to allow users to reorder the collapsible customization sections, dynamically updating the form's data structure.
*   **UI Elements:** Utilizes `gokwik-ui-kit` `Collapse`, `Switch`, `Card`, `Form`, and `HolderOutlined` for its structure and interactivity. It also integrates specialized components like `LogoPage` and `TrustBadgeForm`.

**/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/settings/orderConfirmation/index.tsx** (Timestamps: 19/11/2025, 21:10:01, 19/11/2025, 21:11:54, 19/11/2025, 21:12:22, 19/11/2025, 21:12:29)
This file defines the main page for configuring the Order Confirmation Page.
*   **Core Functionality:** Enables or disables a custom order confirmation page, with an `Alert` providing context.
*   **Configuration Form:** Houses the main customization forms within a `MainSection` component (likely integrating `CustomizeUiFields`). Form changes enable a "Save Changes" button, and form submission includes validation with specific exclusions.
*   **Live Preview:** Presents a two-column layout: the left column contains the customization forms, and the right column displays a live preview using the `OrderConfirmationPreview` component.
*   **UI Adjustments:** Between 21:10:01 and 21:12:29 on 19/11/2025, there were several rapid changes and reverts to the `flex` properties of the `Col` components, indicating active UI layout adjustments to balance the width of the configuration panel and the preview panel. The final change at 21:12:29 set the configuration column to be wider (`300px`) while maintaining the preview column at its wider size (`500px`).
*   **UI Elements:** Uses `gokwik-ui-kit` `Row`, `Col`, `Card`, `Form`, `Button`, and `Alert`, along with an `InfoComponent` for page details.

**Overall Patterns and Key Themes:**
*   **React-based Development with `gokwik-ui-kit`:** All front-end code is written in React and heavily relies on a custom `gokwik-ui-kit` for consistent UI elements.
*   **Form-Driven Configurations:** Many pages are built around `Form` components, allowing merchants to customize various aspects of their checkout and post-purchase experience through structured inputs, switches, and color pickers.
*   **Modular Architecture:** The application is modularized into pages and reusable components, demonstrated by the use of `ProductSearch`, `ColorPickerHelper`, `CollapseFields`, etc.
*   **API Integration and State Management:** `makeAPICall`, `useMerchantConfigApi`, and Redux (via `useSelector`, `useAppDispatch`) are standard for interacting with backend services and managing application state.
*   **User Experience Focus:** Features like breadcrumbs, info components, tooltips, and live previews (in Order Confirmation) are used to enhance the user experience for merchants configuring their settings.
*   **Active Development:** The timestamps, particularly the close succession of identical code in `freeGift.tsx` and the rapid UI layout tweaks in `orderConfirmation/index.tsx`, suggest a period of active development and iterative design adjustments.

## 17:51:49
The code changes primarily focus on developing and refining UI customization and order management features within a dashboard application, likely for a merchant-facing portal.

### File-Specific Updates:

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/settings/customizeUI/brandPage.tsx` (Timestamp: 16/11/2025, 13:10:34)**
    *   This component manages brand customization settings, specifically for logo upload and primary color selection for the checkout UI.
    *   It includes functionality to fetch and display the existing merchant logo, validate and upload new logos (handling image cleaning, presigned S3 URLs, and direct S3 put calls), and update both the logo path in Redux and custom CSS rules in the merchant configuration.
    *   Form fields for logo upload and a color picker component are utilized, with a "Save Changes" button enabled when modifications are detected.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/library/components/discounts/productSearch.tsx` (Timestamp: 17/11/2025, 16:22:51)**
    *   This component provides a robust search interface for products or collections, typically used in the context of discount or free gift rules.
    *   Key features include searching with debouncing, infinite scrolling for results, a modal for selection, and options to manage quantities of selected items.
    *   It supports different search types (`products` or `collections`) and specific filtering for "agent-led" items based on product tags. Logic for collating product variants and handling gift prices is also present.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/orders/order-details/index.tsx` (Timestamp: 17/11/2025, 16:23:04)**
    *   This page displays comprehensive details for a specific order.
    *   It fetches and renders order information, including price breakdowns (discounts, taxes, shipping, gift cards, rewards), transaction history, and refund data.
    *   A significant update is the `mergeRepeatedRefunds` function to consolidate multiple refund attempts.
    *   The component dynamically sets the currency symbol, manages the state of a refund button based on transaction statuses, and displays masked customer contact details. It also sets an edit title based on applied rewards or discount types.

*   **`/Users/mayuresh.madav/Documents/dashboard/dashboard-ui-configuration/src/index.ejs` (Timestamp: 18/11/2025, 00:45:31)**
    *   This is the main EJS template for the dashboard's `index.html`.
    *   It sets up the core HTML structure, meta tags (including a detailed Content Security Policy), and favicon.
    *   Crucially, it configures Single-SPA import maps, dynamically loading various `@gokwik` microfrontend applications from different URLs based on the deployment environment (local, dev, qa, sandbox, production).
    *   Third-party integrations like Freshchat Messenger and New Relic RUM monitoring are also initialized, with New Relic specifically for the production environment.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/settings/free-gift/freeGift.tsx` (Timestamps: 18/11/2025, 00:49:40; 18/11/2025, 00:50:14; 18/11/2025, 00:58:39)**
    *   All three entries for this file show identical code content, indicating no functional changes across these specific saves, likely due to automated saves or minor non-code modifications.
    *   This component allows merchants to configure and manage "free gift" rules.
    *   Users can define rule names, sales channels, purchase requirements (cart value/quantity), minimum/maximum values, and specify whether the gift applies to all products, specific products, or collections.
    *   It integrates the `ProductSearch` component for selecting the free gift product(s) and allows choosing between 'Auto' or 'Selection' methods for gift addition, with a configurable selection limit.
    *   A table displays existing rules, offering options to enable/disable them and perform edit/delete actions.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/library/components/orderConfirmationPage/collapseFields.tsx` (Timestamp: 18/11/2025, 23:42:52)**
    *   This `CustomizeUiFields` component organizes various customization options for an order confirmation page into collapsible sections.
    *   It allows merchants to customize elements like brand logo, dynamic banners, trust badges, order details (status, EDD, confirmation message), customer information (delivery/billing address, contact info), and support/communication details.
    *   Each section includes form fields for text, links, and `ColorPickerHelper` for background and text colors, along with a switch to enable/disable the entire section.
    *   A notable feature is the implementation of drag-and-drop functionality to reorder these collapsible customization sections.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/settings/orderConfirmation/index.tsx` (Timestamps: 19/11/2025, 21:10:01; 19/11/2025, 21:11:54; 19/11/2025, 21:12:22; 19/11/2025, 21:12:29)**
    *   These multiple timestamps for the same file indicate minor layout adjustments, specifically changes to the `flex` properties of `Col` components, likely for optimizing the responsive layout of the customization page and its preview. The underlying logic remains consistent across these saves.
    *   The `OrderConfirmationPage` provides a central interface to enable a custom order confirmation page and manage its content.
    *   It features an alert about redirecting customers from Shopify's page, a form with an "Enable Custom Order Confirmation Page" switch, and a "Save Changes" button that is activated upon form modifications.
    *   The page integrates `MainSection` (where detailed customization fields like `CustomizeUiFields` would reside) and an `OrderConfirmationPreview` component for real-time visualization of changes.

### Patterns and Recurring Elements:

*   **UI Customization Focus:** A dominant theme across `brandPage.tsx`, `collapseFields.tsx`, and `orderConfirmation/index.tsx` is the extensive UI customization capabilities offered to merchants for the checkout and post-purchase experience (logos, colors, banners, page sections).
*   **Form-Driven UI:** The `gokwik-ui-kit`'s `Form` component (likely Ant Design based) is central to most UI settings pages, leveraging `useForm`, `useWatch`, and methods like `setFieldsValue` and `validateFields` for comprehensive form management and validation.
*   **API Interactions and Merchant Configuration:** `makeAPICall` and the custom `useMerchantConfigApi` hook are consistently used for fetching and persisting merchant-specific configurations and data, highlighting a pattern of interacting with a backend API for dynamic settings.
*   **State Management:** React hooks (`useState`, `useEffect`, `useMemo`, `useCallback`) are frequently employed for component-level state, complemented by Redux (`useSelector`, `useAppDispatch`) for global state, such as merchant details and configuration.
*   **Microfrontend Architecture:** The presence of `index.ejs` with `systemjs-importmap` and references to `@gokwik/*` modules confirms the application uses a Single-SPA microfrontend architecture, enabling modular development and deployment.
*   **Recent Development:** All timestamps fall within a short period (November 16-19, 2025), with several files showing multiple saves within minutes, indicating active development, minor adjustments, and frequent iterative changes to the dashboard's features.