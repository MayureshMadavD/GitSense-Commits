# Activity Summary for 20/11/2025

## 10:51:51
For `/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/settings/customizeUI/brandPage.tsx` (Timestamp: 16/11/2025, 13:10:34):
This file introduces a `BrandPage` component for customizing a brand's UI. Key features include logo upload functionality with validation (file type, size), interaction with AWS S3 via pre-signed URLs (`presingedLogoUrl`, `makeAWSPutCall`), and a color picker for selecting the primary theme color. It fetches existing merchant logo and custom CSS configurations on component mount and provides a "Save Changes" button to persist updates through API calls.

For `/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/library/components/discounts/productSearch.tsx` (Timestamp: 17/11/2025, 16:22:51):
An enhanced `ProductSearch` component was implemented, designed for searching and selecting products or collections in contexts like discount or free gift configurations. It features infinite scrolling, debounced search input, a modal for item selection, and robust logic for handling product variants, quantities, and filtering (e.g., `isAgentLed` to exclude 'no-agent' tagged items). It also includes specific handling for "top-up gifts" and quantity validation for collections.

For `/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/orders/order-details/index.tsx` (Timestamp: 17/11/2025, 16:23:04):
The order details page received significant updates. Changes include a custom currency formatter (`formatAmountWithCurrency`), improved handling of refund data with a `mergeRepeatedRefunds` function to consolidate multiple attempts, and dynamic calculation of refundable amounts to control the refund button's state. Logic was added to set an "Edit Order" title with conditional messages based on applied rewards or discount types (e.g., Twid rewards, GWP discounts). Price breakup calculations for various discounts, taxes, shipping, and gift cards were also refined.

For `/Users/mayuresh.madav/Documents/dashboard/dashboard-ui-configuration/src/index.ejs` (Timestamp: 18/11/2025, 00:45:31):
This `index.ejs` template, acting as the micro-frontend shell for the dashboard, was configured to load various `@gokwik` micro-frontends (e.g., `@gokwik/configuration`, `@gokwik/checkout`, `@gokwik/payment`) using `systemjs-importmap`. These import maps are dynamically set based on the `deployedEnv` (local, dev, qa, sandbox, production). It also sets up a Content Security Policy (CSP) and integrates external monitoring tools like Clarity and New Relic for the production environment.

For `/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/settings/free-gift/freeGift.tsx` (Timestamps: 18/11/2025, 00:49:40, 18/11/2025, 00:50:14, 18/11/2025, 00:58:39):
This component manages free gift rules. It provides a form for defining rule details such as name, applicable sales channels, purchase requirements (cart value/quantity), and what the gift applies to (all products, specific products, specific collections). It integrates the `ProductSearch` component for selecting free gift items and applicable products/collections. Rules can be enabled/disabled, edited, or deleted via a table interface. The multiple timestamps for this file with identical content suggest non-functional saves or formatting changes.

For `/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/library/components/orderConfirmationPage/collapseFields.tsx` (Timestamp: 18/11/2025, 23:42:52):
A new `CustomizeUiFields` component was introduced to enable granular customization of the order confirmation page. It organizes various UI elements (Brand Logo, Dynamic Banners, Trust Banner, Order Details, Customer Information, Support & Communication) into collapsible sections. Each section includes fields for content, color customization via `ColorPickerHelper`, and an enable/disable switch. A significant addition is the drag-and-drop functionality, allowing users to reorder these sections on the confirmation page.

For `/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/settings/orderConfirmation/index.tsx` (Timestamps: 19/11/2025, 21:10:01, 19/11/2025, 21:11:54, 19/11/2025, 21:12:22, 19/11/2025, 21:12:29):
This file marks the introduction of the main "Order Confirmation Page" settings. It acts as a container for configuring the post-purchase experience, including an overall switch to enable/disable the custom confirmation page and an alert message. It integrates `MainSection` (which likely uses components like `CustomizeUiFields`) for detailed customization and displays an `OrderConfirmationPreview` in a side panel. The `handleFormSubmit` function handles form validation, with specific fields excluded. Minor layout adjustments to the column widths for the form and preview sections were observed across the subsequent timestamps.

**Patterns and Recurring Elements:**

*   **UI Customization Focus:** A consistent pattern across multiple files is the extensive focus on customizing the user interface (checkout, brand page, order confirmation page) using `gokwik-ui-kit` components like `Form`, `Card`, `Switch`, `ColorPicker`, and dynamic field rendering (`RenderField`).
*   **Merchant Configuration Management:** The `useMerchantConfigApi` hook is frequently used for fetching and saving merchant-specific configurations, indicating a centralized approach to managing settings across different dashboard features.
*   **Micro-frontend Architecture:** The dashboard utilizes a `single-spa` micro-frontend architecture, as evidenced by `index.ejs` dynamically loading various `@gokwik` micro-frontends via `systemjs-importmap` based on the deployment environment.
*   **Form-driven UI:** Most configuration pages are built around `gokwik-ui-kit`'s `Form` component, leveraging `Form.useForm()`, `Form.useWatch()`, and validation rules for robust data input and management.
*   **Breadcrumb Navigation:** The `updateBreadcrumbs` utility is consistently used to manage and update navigation paths across different pages.
*   **Component Reusability:** Components like `ProductSearch` and `RenderField` are designed to be generic and reusable across various settings pages.
*   **API Interactions:** `makeAPICall` is the standard utility for backend communication, ensuring consistent data fetching and updates.

## 12:51:51
The log details recent development on a `Gokwik` dashboard UI, primarily focusing on merchant settings, order details, and general UI configuration.

**File-Specific Updates:**

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/settings/customizeUI/brandPage.tsx`** (Timestamp: 16/11/2025, 13:10:34)
    *   This file manages the "Brand Page" for customizing checkout UI. It includes functionalities for uploading and managing merchant logos (fetching existing, getting presigned URLs for new uploads, client-side validation, uploading to AWS S3, and updating Redux state), along with a color picker for theme customization. Form handling is done using Ant Design's `Form` and includes `useEffect` hooks to synchronize form data with merchant configuration. A "Save Changes" button is enabled based on form modifications.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/library/components/discounts/productSearch.tsx`** (Timestamp: 17/11/2025, 16:22:51)
    *   A versatile `ProductSearch` component for finding and selecting Shopify products or collections. It supports infinite scrolling (`useIntersectionObserver`), debounced search, filtering by agent-led tags, and displays results in a modal. It allows for managing selected items, including incrementing/removing quantities and handling specific gift pricing. The component is highly configurable with props to hide elements, specify search type, and control item selection behavior.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/orders/order-details/index.tsx`** (Timestamp: 17/11/2025, 16:23:04)
    *   This page displays comprehensive order details. It fetches order information, processes refund data (merging repeated attempts), calculates various price breakups (discounts, taxes, shipping, gift cards, rewards), and determines the refundable amount. It includes UI for displaying order status, customer contact information (masked initially), and conditionally disabling the edit order button based on applied rewards/discounts. Currency formatting is dynamically set based on order data or merchant details.

*   **`/Users/mayuresh.madav/Documents/dashboard/dashboard-ui-configuration/src/index.ejs`** (Timestamp: 18/11/2025, 00:45:31)
    *   This is the main HTML template for a Single-SPA micro-frontend application. It defines the Content Security Policy, imports shared React dependencies, and conditionally loads micro-frontend applications (`@gokwik/configuration`, `@gokwik/utilities`, `@gokwik/dashboard`, `@gokwik/checkout`, etc.) based on the deployment environment (local, dev, qa, sandbox, production). Notably, the `sandbox` environment import URLs for several `@gokwik` applications were updated, and the `production` environment includes scripts for Microsoft Clarity and New Relic for analytics and application performance monitoring.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/settings/free-gift/freeGift.tsx`** (Timestamps: 18/11/2025, 00:49:40, 18/11/2025, 00:50:14, 18/11/2025, 00:58:39)
    *   This page configures "Free Gift" rules. It uses `useMerchantConfigApi` for configuration management and `ProductSearch` for selecting free gift products. The UI allows defining rules with a name, sales channels (app, web, agent-led), purchase requirements (cart value, quantity), min/max values, applicability (all products, specific products/collections), gift quantity/price, and application method (auto or customer selection). Rules can be added, edited, deleted, and enabled/disabled via a table interface. The multiple timestamps for this file with identical content suggest repeated saves without significant code changes or quick versioning during development.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/library/components/orderConfirmationPage/collapseFields.tsx`** (Timestamp: 18/11/2025, 23:42:52)
    *   A new component, `CustomizeUiFields`, was added to structure and manage various customizable sections of the order confirmation page. It uses collapsible panels (`Collapse` from `gokwik-ui-kit`) for "Brand Logo Customization," "Dynamic Banners," "TrustBanner," "Order Details," "Customer Information," and "Support & Communication." Each section can be enabled/disabled via a `Switch` and includes form fields for text, colors (`ColorPickerHelper`), and linking custom components like `LogoPage` and `TrustBadgeForm`. It also implements drag-and-drop functionality to reorder these sections.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/settings/orderConfirmation/index.tsx`** (Timestamps: 19/11/2025, 21:10:01, 19/11/2025, 21:11:54, 19/11/2025, 21:12:22, 19/11/2025, 21:12:29)
    *   This is the main page for configuring the custom order confirmation page, using the `CustomizeUiFields` component internally. It provides an "Enable Custom Order Confirmation Page" switch and an informational `Alert`. The page is split into two columns: a left column for the configuration `Form` and a right column for an `OrderConfirmationPreview`. Over several minor updates, the `flex` properties of the layout columns were adjusted multiple times, eventually settling on `flex='1 1 300px'` for the form column and `flex='0 1 500px'` for the preview column, indicating iterative fine-tuning of the responsive layout. Form validation and a "Save Changes" button (enabled on modification) are also present.

**Timestamps of Significant Changes:**

*   **16/11/2025, 13:10:34:** Initial development or major update to the Brand Page UI customization.
*   **17/11/2025, 16:22:51 - 16:23:04:** Concurrent work on core components like `ProductSearch` and a detailed `OrderDetails` page.
*   **18/11/2025, 00:45:31:** Crucial infrastructure update in `index.ejs` for micro-frontend configuration, especially for the `sandbox` environment and production monitoring.
*   **18/11/2025, 23:42:52:** Introduction of a new, complex component (`collapseFields.tsx`) for modular UI customization of the order confirmation page.
*   **19/11/2025, 21:10:01 - 21:12:29:** Rapid iterations on the `OrderConfirmationPage` layout and structure, indicating active UI/UX refinement.

**Patterns and Recurring Elements:**

*   **Standardized UI Library:** The `gokwik-ui-kit` is consistently used across all UI-related files, ensuring a cohesive look and feel.
*   **Ant Design Forms:** Ant Design's `Form` component with `useForm` and `useWatch` hooks is a pervasive pattern for complex form state management and data binding.
*   **Merchant Configuration Management:** The `useMerchantConfigApi` hook (from `@library/utilities/hooks/useMerchantConfig`) is frequently used for fetching and saving merchant-specific settings, highlighting a centralized approach to configuration.
*   **API Interactions:** `makeAPICall` is a common utility for network requests, typically paired with `APIEndPoints` for structured API access.
*   **State Management:** Redux (`useSelector`, `useAppDispatch`) handles global state (e.g., merchant details), while `useState` manages local component states.
*   **UI Customization Focus:** A significant portion of the changes (Brand Page, Order Confirmation Page, Free Gift) revolves around providing merchants granular control over their checkout and post-purchase UI/UX.
*   **Breadcrumbs:** `updateBreadcrumbs` utility is used across different pages to maintain consistent navigation.
*   **Micro-frontend Architecture:** The `index.ejs` file clearly indicates the use of Single-SPA and SystemJS for a micro-frontend setup, allowing different parts of the dashboard to be developed and deployed independently.
*   **Observability:** Integration of New Relic and Microsoft Clarity signifies an emphasis on monitoring application performance and user behavior in production.

## 13:51:52
**File-Specific Updates:**

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/settings/customizeUI/brandPage.tsx`** (Timestamp: 16/11/2025, 13:10:34)
    *   This file, responsible for brand UI customization, received significant updates to its logo upload and color picking functionality.
    *   It now includes robust client-side image validation (file type and size up to 2MB for JPG, PNG, SVG).
    *   The logo upload process involves cleaning images with a canvas, generating unique image paths, fetching pre-signed AWS S3 URLs, and performing the actual AWS S3 PUT call.
    *   Existing logo and primary theme color are fetched from merchant configuration upon component load.
    *   A "Save Changes" button is introduced, which is disabled by default and enabled only when form values are modified, providing clear feedback to the user.
    *   The UI integrates `InfoComponent` for descriptive help, `ColorPicketComponent` for theme selection, and an `Upload` component for the logo, featuring a live preview of the uploaded logo or a placeholder.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/library/components/discounts/productSearch.tsx`** (Timestamp: 17/11/2025, 16:22:51)
    *   The `ProductSearch` component, used for selecting products or collections in discount/free gift configurations, has been enhanced with new features.
    *   It now supports filtering products based on an `isAgentLed` prop, which excludes items tagged with 'no-agent'.
    *   A `topUpGift` feature introduces an `InputNumber` to specify an "Offered Price" for freebies directly within the product display.
    *   For collections, `collectionSpecificData` is introduced to manage quantities, including validation to ensure collection quantity does not exceed a predefined minimum purchase quantity.
    *   The `parseResponse` function was updated to handle `collateProducts`, grouping product variants and tracking minimum prices and total variants.
    *   Functions `handleGiftPrice`, `handleQuantityChange`, and `handleCloseAllInput` manage these new functionalities.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/orders/order-details/index.tsx`** (Timestamp: 17/11/2025, 16:23:04)
    *   The order details page received extensive updates, focusing on improved data display, refund management, and currency formatting.
    *   New constants for RTO (Return to Origin) reasons and permissions, along with an internal team identifier, were added.
    *   A custom `formatAmountWithCurrency` helper ensures consistent currency symbol display globally.
    *   A `mergeRepeatedRefunds` utility function was added to aggregate and simplify the display of multiple refund attempts, improving clarity on refund status and attempts.
    *   New states were introduced to control the visibility of customer contact information (phone and email) and display order failure reasons.
    *   The refund button's state (disabled, refundable amount) is now dynamically calculated based on successful and pending transactions, along with store credits.
    *   Logic was added to disable order editing under specific conditions, such as when Twid rewards, GWP discounts, or loyalty points are applied.
    *   The method for fetching order details was adjusted to conditionally include a hash for non-merchant users.
    *   Detailed calculations for `total_discount`, `tax`, `shipping_and_cod_charges`, and `gift_card_and_rewards` were refined, pulling data from various price breakup values.

*   **`/Users/mayuresh.madav/Documents/dashboard/dashboard-ui-configuration/src/index.ejs`** (Timestamp: 18/11/2025, 00:45:31)
    *   This EJS template, which defines the dashboard's main structure and micro-frontend loading, underwent several infrastructural enhancements.
    *   It now includes a `favicon.svg` and updated `Content-Security-Policy` rules to support `data:` and `http:` for images.
    *   A global `window.fcWidgetMessengerConfig` was added, likely for a chat widget.
    *   New Relic browser monitoring script was embedded specifically for the `production` environment, along with Microsoft Clarity analytics when a `clarityKey` is present.
    *   The `systemjs-importmap` configurations for `dev`, `qa`, `sandbox`, and `production` environments were expanded to include new micro-frontends: `@gokwik/kwikcomm`, `@gokwik/checkout-platform`, `@gokwik/shopify-app`, and `@gokwik/ellora`, indicating an ongoing expansion and modularization of the dashboard.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/settings/free-gift/freeGift.tsx`** (Timestamps: 18/11/2025, 00:49:40; 18/11/2025, 00:50:14; 18/11/2025, 00:58:39)
    *   This component manages the creation and configuration of automatic free gift rules.
    *   The `initialValues` for new rules have been explicitly defined, including default sales channels, purchase requirements, and application methods.
    *   The form fields are dynamically rendered using `RenderField` and include options for rule name, sales channels (with `shopify_agent` channel dynamically enabled/disabled based on application method), purchase type (cart value or quantity), min/max value validation, and applicability on all, specific products, or specific collections.
    *   A `ProductSearch` component is integrated for selecting the free gift product, along with input fields for free gift quantity and price.
    *   The "Free Gift Addition Method" (Auto or Selection) and a "Selection Limit" (conditionally hidden) are now configurable.
    *   A table displays existing free gift rules, allowing users to enable/disable them via a `Switch` and offering "Edit" and "Delete" actions through a `Dropdown`.
    *   The content of this file is identical across all three timestamps, suggesting repeated saving without functional changes, or minor unlogged changes that were reverted.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/library/components/orderConfirmationPage/collapseFields.tsx`** (Timestamp: 18/11/2025, 23:42:52)
    *   This new component provides a highly configurable and reorderable interface for customizing various sections of the order confirmation page.
    *   It introduces collapsible panels for "Brand Logo Customization," "Dynamic Banners," "TrustBanner," "Order Details," "Customer Information," and "Support & Communication."
    *   Each section can be individually enabled/disabled via a `Switch` in the panel header.
    *   Customization options within each section include `Input` fields for text (e.g., confirmation message, heading text, button text) with length constraints, and `ColorPickerHelper` components for setting background and text colors.
    *   A key feature is the implementation of drag-and-drop functionality, allowing users to reorder the collapsible sections directly within the UI, which updates the underlying form structure.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/settings/orderConfirmation/index.tsx`** (Timestamps: 19/11/2025, 21:10:01; 19/11/2025, 21:11:54; 19/11/2025, 21:12:22; 19/11/2025, 21:12:29)
    *   This page serves as the main interface for customizing the order confirmation page, featuring both form controls and a live preview.
    *   It includes a global switch to "Enable Custom Order Confirmation Page" and an `Alert` providing information about redirecting customers from Shopify.
    *   The page is divided into two columns: a left column for form inputs (`InfoComponent`, "Save Changes" button, and `MainSection` which likely contains the `CollapseFields` component) and a right column displaying an `OrderConfirmationPreview`.
    *   The `handleFormSubmit` function was refined to selectively validate form fields, excluding specific fields like `trust_text` and `trust_tag` which might not require validation.
    *   The multiple rapid commits within minutes indicate active UI layout adjustments, specifically regarding the `flex` properties of the left and right columns (e.g., `flex='1 1 200px'` vs. `flex='1 1 300px'`), suggesting iterative design tweaks for the responsive layout of the settings page. The core functionality remained stable across these layout changes.

**Patterns and Recurring Elements:**

1.  **UI Kit Consistency:** All `checkout-dashboard-ui` files heavily utilize `gokwik-ui-kit` components (Button, Form, Card, Row, Col, Input, Switch, Dropdown, Table, message, Tooltip, Alert), indicating a consistent design system.
2.  **Form Management:** Extensive use of Ant Design's `Form` API, including `Form.useForm()`, `Form.useWatch()`, `Form.Item`, `Form.setFieldValue()`, and `form.validateFields()` for handling complex form states and user inputs.
3.  **Merchant Configuration through Hooks:** The `useMerchantConfigApi` hook is a recurring pattern for fetching, modifying, and saving merchant-specific configurations, centralizing settings management.
4.  **Micro-frontend Architecture:** The `index.ejs` file clearly demonstrates a micro-frontend setup, loading different `@gokwik/*` applications dynamically based on the deployment environment, supporting modular development and deployment.
5.  **Environment-Specific Configuration:** Both the `.env` (not summarized but noted for context) and `index.ejs` files highlight the use of environment variables and conditional loading for different deployment stages (dev, qa, sandbox, production).
6.  **Breadcrumbs Management:** The `updateBreadcrumbs` utility is consistently used to manage navigation paths across different pages, ensuring a coherent user experience.
7.  **Iterative UI/UX Refinement:** The frequent, minor changes within a short time frame for `freeGift.tsx` and `orderConfirmation/index.tsx` point to an active and iterative process of fine-tuning user interfaces and layouts.
8.  **Centralized Utilities:** Imports like `makeAPICall`, `updateBreadcrumbs`, `deepEqualAndDiff`, `formatAmount`, and helper components (`RenderField`, `InfoComponent`) suggest a well-structured codebase with reusable utilities and components.