# Activity Summary for 17/11/2025

## 11:13:19
The `ShippingDiscount.service.ts` file, last updated on 12/11/2025 at 21:20:24, is central to managing discounts and shipping options. Key updates include the clearing of the `captureApiTimerId` when discount coupons are removed, and a `confetti` animation being triggered for specific valid coupon code applications. The service now incorporates logic for `gyftr` (gift-as-a-product) to be removed or reapplied based on discount responses and the current checkout page. It also introduces logging for `loyalty_points_applied` events, tracking provider, redeemed credits, and auto-application status. A significant update involves a fix for `CHECKOUT-15842` to reapply gift cards if the cart has been modified, and a fix for `CHECKOUT-12982` to trigger payment method calls under specific conditions. Error messages are now managed more granularly, excluding failures related to UTM auto-application. The file also contains retry logic for shipping discounts.

The `PaymentOptions.svelte` file saw several updates between 13/11/2025, 20:56:52 and 13/11/2025, 21:25:07. This component orchestrates the payment selection UI, extensively importing and subscribing to numerous Svelte stores for common, order, and login-related states. During `onMount`, it initializes prepaid discount, fetches payment methods and previously used UPI IDs, processes saved cards, and sets the latest saved card. It dispatches GTM and Shopify analytics events on payment step landing. The component also handles various UI states, such as resetting loader, BIN response, and payment attempt states. Event logging for `prefilled_skip_to_pay` and `email_mismatch_message_shown` indicates detailed user journey tracking. Conditional `callPaymentMethods` execution is implemented based on the presence of `store_placeOrder` or `twidPay` status. It dynamically hides or shows UI elements related to payment panels based on allowed payment methods. A minor change on 13/11/2025, 21:22:28 added `store_availableOffersCheck` to its imports. A more substantial change on 15/11/2025, 12:01:15 included adding `store_isLoggedInUser` and `store_isCartUpdated` imports, removing `calculateLoadTime`, `loadTimeVariables`, `PaymentAddressLazyLoad`, `SharePaymentLink`, `fetchShopifyCredits` imports, and integrating `AutomaticGiftHeader` and `GiftJourney` components, indicating a restructuring of how free gifts are presented within the payment options.

The `OrderSummary.svelte` file underwent changes between 15/11/2025, 11:49:48 and 15/11/2025, 11:52:44. This component focuses on displaying a detailed breakdown of the order. It imports Svelte lifecycle hooks, various stores, and utility functions. It exports `hideDiscountTab` and `componentData`. The component manages states for cart updates, gift additions, and order summary drawer visibility. A complex reactive block (`$:` statement) calculates the `totalPrice` by aggregating subtotal, various discounts (coupon, partner acquisition, discount-based rewards, Shopify store credit, prepaid), shipping, gift cards, COD charges, TwidPay rewards, GST, and Gyftr. The `handleCartUpdate` function, called on mount and on cart changes, processes the `cartjsObject` to extract and categorize items, including handling "buy X get Y" free products and gifts from `requestIdObject`, and calculating `automaticDiscount` and `totalItems`. It also now calculates and updates `loyaltyDisplayAmount` based on `earnedLoyaltyDetails` and `priceBreakUpData`.

A recurring pattern across these files is the heavy reliance on Svelte stores for managing and reacting to global application state, which is central to the UI's reactivity and data flow. All components demonstrate extensive event logging using services like GTM, GA4, Shopify Analytics, and Facebook, highlighting a strong focus on tracking user interactions and checkout performance. The presence of specific fixes (e.g., CHECKOUT-15842, CHECKOUT-12982) indicates ongoing refinement and maintenance. Furthermore, several experiment-related store imports suggest a culture of A/B testing and feature toggling to optimize the user experience. The asynchronous nature of many operations (e.g., API calls) is also a common theme, reflecting the dynamic, data-driven nature of the checkout process.

## 12:03:55
The file `/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/settings/customizeUI/brandPage.tsx` was updated on **16/11/2025, 13:10:34**.

This file defines the `BrandPage` component, a UI for customizing a merchant's brand appearance on a checkout dashboard. Key functionalities include:
*   **Brand Logo Management**:
    *   Allows users to upload a brand logo with validation for file type (JPEG, PNG, SVG) and size (max 2MB).
    *   Utilizes client-side image cleaning (`cleanImageWithCanvas`).
    *   Handles image uploads to AWS S3 using pre-signed URLs obtained via an internal API (`presingedLogoUrl`).
    *   Fetches existing logos and displays a preview or a `noImage` placeholder.
    *   Updates the merchant's logo details via an API endpoint (`updateMerchant`).
*   **Theme Color Customization**:
    *   Integrates a `ColorPicketComponent` to allow users to select a primary theme color for the checkout UI.
    *   Saves the selected color as part of `cssRules` within the merchant's `custom_config`.
*   **State and Configuration Management**:
    *   Leverages React hooks (`useEffect`, `useState`) and Redux (`useSelector`, `useAppDispatch`) for state management, including fetching merchant details and dispatching logo data updates.
    *   Uses a `useMerchantConfigApi` hook to fetch and save merchant-specific custom configurations.
    *   Employs `gokwik-ui-kit` components (Form, Upload, Button, Card, ColorPicker) for building the user interface.
*   **Form Handling**:
    *   Uses Ant Design's `Form` component for managing form fields and submission.
    *   The "Save Changes" button is enabled/disabled based on form value changes.
*   **API Interactions**: Makes various API calls using `makeAPICall` and `makeAWSPutCall` to interact with backend services for logo download, pre-signed URL generation, logo upload, and merchant configuration updates.

Overall, the component provides a comprehensive interface for merchants to control the branding (logo and primary theme color) of their GoKwik checkout UI, involving image processing, cloud storage interactions, and dynamic UI updates.