# Activity Summary for 15/11/2025

## 12:05:23
The changes reflect ongoing development in a Svelte-based checkout application, focusing on improving the shipping, discount, and payment options functionality, along with environment configuration and merchant-side integration.

**File-specific Updates:**

*   **/Users/mayuresh.madav/Documents/pdp/gokwik.pdp/src/common/services/ShippingDiscount.service.ts**
    *   **Timestamp: 12/11/2025, 21:20:24 and 15/11/2025, 12:00:15**
    *   This file, serving as a core service for shipping and discount logic, heavily leverages Svelte stores for state management, importing a wide array of `store_` prefixed variables from `CommonStore` and `OrderStore`. It orchestrates calls to `discountShippingCall` and manages the response through an `ApiResponseQueue`.
    *   Key functionalities include:
        *   Triggering a confetti animation upon successful discount application for specific user types or when configured to `show_discount_confetti`.
        *   Handling gift card reapplication and total resets when the cart is updated, addressing `CHECKOUT-15842`.
        *   Processing Gyftr application and removal based on discount intent and current page (e.g., `currentPage === 7`).
        *   Logging loyalty points application, including details on provider, redeemed credits, and auto-application status.
        *   Managing shipping method selection and address listing based on API responses and checkout flow state.
        *   Integrating with various services for event logging, gift card management, and foreign analytics.
        *   Implementing retry logic for discount shipping under specific conditions.
    *   The content appears identical for both timestamps, suggesting a re-save or minor, non-functional change between these times.

*   **/Users/mayuresh.madav/Documents/pdp/gokwik.pdp/public/merchant.html**
    *   **Timestamp: 13/11/2025, 14:31:36**
    *   This HTML file outlines a merchant page for integrating the Gokwik checkout SDK. It defines a `gokwikSdk` object to manage checkout initiation, event handling, and button visibility. It dynamically loads `gokwik.js` and an `analytics-js` script. Initial `window.merchantInfo` configuration includes `mid:'gh0yshvkmca4pw4'` and `environment: 'local'`.
    *   **Timestamp: 15/11/2025, 11:32:20**
    *   The primary change in this version is an update to the `mid` (merchant ID) within the `window.merchantInfo` object, changing from `'gh0yshvkmca4pw4'` to `'eey3k3mkrg55tcs'`. The rest of the structure and SDK logic remains consistent.

*   **/Users/mayuresh.madav/Documents/pdp/gokwik.pdp/src/Components/place-order/PaymentOptions.svelte**
    *   **Timestamps: 13/11/2025, 20:56:52 through 13/11/2025, 21:23:51**
    *   These entries indicate frequent saves or minor, non-functional changes within a short period. The component broadly handles the display and logic for various payment options in the checkout flow. It imports a large number of state variables from `LoginStore`, `OrderStore`, and `CommonStore` to manage payment methods, discounts, COD status, and user interactions.
    *   The `onMount` lifecycle hook is extensive, performing initializations like setting `prepaidDiscount`, processing saved cards, firing analytics events, and subscribing to numerous stores to reactively update the UI based on changes in `totalPrice`, `discountCallStatus`, `twidPay` status, `shopifyStoreCredit`, `screen_width`, and payment-related texts. It also fetches experiment variants and manages the visibility of payment panels.
    *   A minor update around **13/11/2025, 21:22:28** added `store_availableOffersCheck` to imports, though its usage isn't apparent in the provided snippet.
    *   **Timestamp: 15/11/2025, 12:01:15**
    *   This update signifies functional changes:
        *   New imports: `store_isLoggedInUser`, `store_isCartUpdated` from `CommonStore`, and `AutomaticGiftHeader`, `GiftJourney` components from `./Discounts/FreeGift/`.
        *   Removed imports: `calculateLoadTime` from `Helper.service` and `loadTimeVariables` from `ConstantVariables`. This suggests the removal of load time measurement utilities and the introduction of specific components for handling automatic gifts within the payment options screen.

*   **/Users/mayuresh.madav/Documents/pdp/gokwik.pdp/src/Components/place-order/OrderSummary.svelte**
    *   **Timestamp: 15/11/2025, 11:49:48 and 15/11/2025, 11:52:44**
    *   This component displays a detailed breakdown of the order summary, including `subTotal`, various discounts (coupon, prepaid, loyalty, partner acquisition, Shopify store credit, Gyftr), shipping charges, COD charges, and GST.
    *   It uses numerous Svelte stores to ensure all price components are reactive and correctly displayed.
    *   The `onMount` hook sets up subscriptions to `store_page`, `store_order_summary_drawer`, `store_prepaidDiscount`, `store_codCharges`, `store_selectedShippingMethod`, `store_discountBasedRewards`, `store_requestIdObject`, `store_phoneNo`, `store_cartjsObject`, `store_onpl`, `store_discountAmount`, `store_giftCardTotal`, `store_shopifyStoreCredit`, `store_mrpDiscountData`, `store_lineItemEdd`, `store_earnedLoyaltyDetails`, and `store_priceBreakUp`.
    *   The `handleCartUpdate` function is crucial for recalculating totals, identifying automatic discounts, and segregating free products (e.g., BXGY, prepaid discounted, autoGifts) based on cart updates. It also accounts for gifts available from `requestIdObject` if no phone number is present.
    *   It calculates `totalPrice` reactively based on numerous financial components.
    *   A `toggleCartDrawer` function manages the visibility of the order summary drawer and logs relevant analytics events.
    *   The content is identical between these two timestamps, indicating a non-functional re-save.

**Patterns and Recurring Elements:**

*   **Svelte Store Reliance**: A strong and consistent pattern across all `.svelte` components and services is the extensive use of Svelte stores (`store_...`) for managing and sharing application state. This indicates a highly reactive and component-driven architecture.
*   **Checkout Flow States**: The application frequently uses a `currentPage` variable and related flags (e.g., `isAbandonCart`, `skipToPayment`, `isPlaceOrderButtonVisible`) to determine the current stage of the checkout process and adjust behavior accordingly.
*   **Analytics and Event Logging**: There is a pervasive integration of analytics, with calls to `fireGtmEvent`, `logEvent`, `fireAnalytics`, `shopifyPaymentStepReached`, and `fireAnalyticsGa4` across different components to track user journeys and specific interactions.
*   **Discount and Offer Management**: The system has sophisticated logic for applying and managing various types of discounts, gift cards, loyalty rewards, and partner acquisition offers, including visual feedback like confetti for successful discount applications.
*   **Asynchronous Operations**: `async/await` patterns are used for handling API calls and other potentially long-running operations, often combined with queueing mechanisms for API responses.
*   **Modular Component Design**: The application appears to be built with distinct Svelte components (`PaymentOptions.svelte`, `OrderSummary.svelte`) that encapsulate specific UI and business logic for different parts of the checkout.