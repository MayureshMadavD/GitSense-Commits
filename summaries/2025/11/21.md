# Activity Summary for 21/11/2025

## 12:05:28
### File-Specific Summaries:

**1. `/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/settings/customizeUI/brandPage.tsx` (16/11/2025, 13:10:34)**
This file defines the `BrandPage` component, which allows merchants to customize their checkout UI's branding. Key functionalities include:
- **Logo Upload:** Merchants can upload their brand logo. The component handles image validation (type, size), cleaning with canvas, generating a unique path, getting a pre-signed S3 URL, and uploading the image to AWS S3. It then updates the form with the logo URL and dispatches an action to update logo data in the Redux store.
- **Primary Color Selection:** A `ColorPicketComponent` is used for selecting the primary theme color for the checkout UI, which is then saved as part of the merchant's custom configuration.
- **Form Management:** Uses Ant Design's `Form` for managing brand data, including logo and primary color. Changes to form values trigger a state update (`isVisible`) to enable/disable the "Save Changes" button.
- **API Integration:** Interacts with `APIEndPoints` for downloading existing logos, getting pre-signed URLs for uploads, and updating merchant configurations.
- **State Management:** Utilizes Redux (`useSelector`, `useAppDispatch`) to fetch merchant details and dispatch updates.

**2. `/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/library/components/discounts/productSearch.tsx` (17/11/2025, 16:22:51 & 21/11/2025, 11:48:56)**
This `ProductSearch` component facilitates searching and selecting products or collections, primarily used for discount and free gift configurations.
- **Core Functionality:** Allows searching for Shopify products or collections, displaying results in a modal, and adding/removing selected items. It supports features like infinite scrolling (`useIntersectionObserver`), debounced search, and handling product variants.
- **Dynamic Search Types:** Can search for either 'products' or 'collections' based on `searchType` prop.
- **Product Aggregation:** When `collateProducts` is true, it groups product variants under their parent product for display and selection.
- **Quantity Management:** Supports displaying and modifying quantities for selected items, with specific logic for collection quantities and minimum purchase requirements.
- **Agent-Led Filtering:** Includes logic to filter products based on `no-agent` tags when `isAgentLed` is true.
- **Top-Up Gift Price:** Introduces a `topUpGift` prop to allow setting an `offered_price` for freebie products.
- **Recent Update (21/11/2025, 11:48:56):** Added a `DeleteOutlined` icon for removing items from the search result in the modal (though the provided code snippet for this specific update doesn't fully show its context within the modal's item rendering). A `btnSearch` prop was added to allow a button to trigger the search modal directly. The logic for displaying selected variants (`product?.variants?.length && ...`) was also slightly refined.

**3. `/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/orders/order-details/index.tsx` (17/11/2025, 16:23:04)**
This file defines the `OrderDetails` page for viewing and managing individual orders.
- **Order Data Display:** Fetches and displays comprehensive order information, including line items, payment details, refunds, and price breakdowns (discounts, taxes, shipping, gift cards, rewards).
- **Refund Management:** Implements logic for merging repeated refund attempts and calculating refundable amounts. It also controls the state and display of a "Refund" button and a `RefundDrawer`.
- **Currency Formatting:** Includes custom `formatCurrency` and `formatAmountWithCurrency` helpers to ensure amounts are displayed with the correct currency symbol, dynamically retrieved from order data or merchant details.
- **Conditional Actions:** Dynamically enables/disables order editing based on applied rewards, GWP discounts, or loyalty points. RTO actions are conditionally displayed based on merchant configuration.
- **Breadcrumbs & Navigation:** Manages breadcrumbs for the page and handles navigation for order not found scenarios.
- **Sensitive Data Masking:** Masks customer phone numbers and emails (`billing_phone_mask`, `billing_email_mask`).

**4. `/Users/mayuresh.madav/Documents/dashboard/dashboard-ui-configuration/src/index.ejs` (18/11/2025, 00:45:31 & 20/11/2025, 18:37:48)**
This is the main EJS template file for the Single-SPA dashboard application.
- **Microfrontend Configuration:** Defines SystemJS import maps to load various Gokwik microfrontends (e.g., `@gokwik/configuration`, `@gokwik/checkout`, `@gokwik/payment`) based on the `deployedEnv` (local, dev, qa, sandbox, production).
- **Dependency Management:** Includes CDN links for `react`, `react-dom`, and `single-spa`.
- **Security Policies:** Sets a `Content-Security-Policy` for the application, allowing resources from self, HTTPS, and localhost.
- **New Relic Integration:** Includes a New Relic browser agent script for performance monitoring, with environment-specific configuration details (accountID, agentID, licenseKey).
- **Clarity Integration:** Conditionally includes a Microsoft Clarity tracking script based on `clarityKey` for production environments.
- **Timestamp 20/11/2025, 18:37:48:** The primary change is the update of `@gokwik/utilities`, `@gokwik/dashboard`, `@gokwik/payment`, `@gokwik/kwikpass`, `@gokwik/rto`, `@gokwik/kwikship`, `@gokwik/ellora`, `@gokwik/checkout-platform`, and `@gokwik/shopify-app` URLs in the `isLocal` environment to point to `https://qa-dashboard.dev.gokwik.in/` instead of `https://sandbox-dashboard.dev.gokwik.in/` or `//localhost:XXXX`. This indicates a shift in the local development environment's dependency resolution to QA-deployed versions of other microfrontends.

**5. `/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/settings/free-gift/freeGift.tsx` (18/11/2025, 00:49:40, 18/11/2025, 00:50:14, & 18/11/2025, 00:58:39)**
This `FreeGift` component allows merchants to configure free gift rules.
- **Rule Management:** Provides a form to create and edit free gift rules, including name, sales channels, purchase type (cart value/quantity), min/max value, applicability (all products, specific products, specific collections), free gift product selection, quantity, price, and application method (auto/selection).
- **Product/Collection Search Integration:** Uses `ProductSearch` component for selecting specific products or collections that trigger the free gift or are offered as free gifts.
- **Dynamic Form Fields:** Fields are conditionally rendered or disabled based on other form values (e.g., `selection_limit` visibility based on `application_method`).
- **Table Display:** Rules are listed in a table, allowing enabling/disabling via a `Switch`, and editing/deleting via a `Dropdown` menu.
- **State Management:** Manages state for `newRules` (drawer visibility), `newGift` (list of gift rules), `editRuleId`, and `isChanged` (to enable/disable Save button).
- **Breadcrumbs:** Updates breadcrumbs to reflect the current page.
- **No significant code changes between the three timestamps for this file; likely just minor formatting or save operations.**

**6. `/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/library/components/orderConfirmationPage/collapseFields.tsx` (18/11/2025, 23:42:52)**
This component, `CustomizeUiFields`, is responsible for rendering collapsible customization sections for the order confirmation page.
- **Collapsible Sections:** Organizes various UI customization options into `Collapse` panels: Brand Logo, Dynamic Banners, Trust Banner, Order Details, Customer Information, and Support & Communication.
- **Dynamic Field Rendering:** Uses a `RenderField` utility and custom render functions (`RenderEditorFunction`, `ColorPickerHelper`) to display different types of form inputs (switch, text input, color picker).
- **Drag-and-Drop Reordering:** Implements drag-and-drop functionality for reordering the collapsible sections, allowing merchants to customize the layout of the order confirmation page.
- **Conditional Visibility:** Many fields are conditionally hidden based on the `enabled` state of their parent section.
- **Prop-Based Form Interaction:** Receives `form` and `setButtonState` props to interact with the parent form and trigger save button state changes.

**7. `/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/settings/orderConfirmation/index.tsx` (19/11/2025, 21:10:01, 19/11/2025, 21:11:54, 19/11/2025, 21:12:22, & 19/11/2025, 21:12:29)**
This `OrderConfirmationPage` component provides the interface for merchants to customize their post-purchase experience.
- **Main Layout:** Uses a two-column layout (`Row`, `Col`) with customization forms on the left and a live preview on the right.
- **Form Management:** Utilizes Ant Design's `Form` with `initialValuesForThankYouPageForm` and `onValuesChange` to track changes and enable the "Save Changes" button.
- **Customizable Sections:** Integrates `MainSection` (which likely includes `CustomizeUiFields`) to manage various customizable elements of the confirmation page.
- **Form Submission Logic:** `handleFormSubmit` validates form fields, specifically excluding certain fields from validation if they are dynamically controlled, and logs the form data.
- **Informational Alerts:** Includes an `Alert` component to inform users about redirecting from Shopify's page.
- **InfoComponent:** Provides a link to a wiki page for more information on customizing the UI.
- **Timestamp 19/11/2025, 21:11:54, 19/11/2025, 21:12:22, & 19/19/2025, 21:12:29:** The `flex` property of the `Col` components was adjusted (from `1 1 200px` to `1 1 300px` and back to `1 1 200px`, then to `1 1 300px` again, while the right column's `flex` also fluctuated between `0 1 500px` and `0 1 300px`). These changes indicate minor adjustments to the responsive layout or column widths for the customization and preview sections.

**8. `/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/library/components/shipping/shippingBasedData.tsx` (20/11/2025, 18:44:34, 20/11/2025, 18:44:55, 20/11/2025, 18:49:44, & 20/11/2025, 18:49:50)**
This `processProductBasedShippingData` component is a helper/renderer for configuring product-based shipping rules.
- **Rule Definition:** Allows defining shipping rules based on specific products or collections, including rule name, price, mapping to an existing shipping ID, calculation method (override/add-on), price multiplier, and combination with weight-based shipping.
- **Product/Collection Selection:** Integrates `ProductSearch` to add products or collections to the shipping rule. It includes validation to prevent adding similar product variants or collections multiple times.
- **Data Mapping:** `dataMapperForItems` transforms selected products/collections into a format suitable for display in the table.
- **Dynamic Options:** `selectedOptions` memoizes a list of available shipping IDs for mapping, filtering out already used ones.
- **Form Structure:** Defines a `fields` array for dynamically rendering form items using `RenderField`.
- **Table Display:** Displays selected items (products/collections) in a table, allowing removal.
- **Keypress Validation (20/11/2025, 18:49:44 & 20/11/2025, 18:49:50):** A `onKeyPress` validator was added to the 'Rule price' `inputNumber` field to restrict input to only numbers and decimal points (`/[0-9.]$/.test(event.key)`). This prevents invalid characters in the price field. The change between `18:49:44` and `18:49:50` seems to be an exact duplicate, indicating a re-save or minor, non-functional change.

**9. `/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/library/utilities/helpers/helper.ts` (21/11/2025, 11:50:18 & 21/11/2025, 11:51:40)**
This file provides a collection of utility helper functions.
- **Filtering & Formatting:** `getDynamicSearchFilters`, `formatDateString`, `setCurrencySymbol`, `formatAmount` for data manipulation and display. `formatAmount` handles number formatting with a global currency symbol and optional notation.
- **Comparison & Validation:** `shopifyAppCheckoutEnabledStatus` (checks last login date), `deepCompare` (for object comparison), `uploadCohortCsv` (validates and processes CSV files for phone numbers or emails).
- **Date & Time Helpers:** `debounce`, `disabledBeforeDate`, `disabledBeforeTime`, `getFutureDateString`, `disabledDate`, `disabledTime` for handling dates and times, often used in date pickers.
- **String Manipulation:** `capitalizeFirstLetter`.
- **Table Data Processing:** `extractTitlesAndDataIndexes` (for table columns), `sortDataByKey`, `extractUniqueCKeysForAntColumn`.
- **Array Comparison:** `compareAndCaptureArrayFields` for identifying added/removed items in arrays.
- **Range Validation:** `areBothRangesMoreThanOneDay`.
- **No significant code changes between the two timestamps for this file; likely just minor formatting or save operations.**

### Overall Patterns and Recurring Elements:

1.  **React and Ant Design:** The codebase heavily relies on React for UI development and `gokwik-ui-kit` (which seems to be an Ant Design wrapper/extension) for components like `Form`, `Button`, `Card`, `Table`, `Input`, `Switch`, `Dropdown`, `message`, `Tooltip`, `Alert`, `Col`, `Row`, `Collapse`, etc.
2.  **Modular Architecture:** Components are organized by functionality (e.g., `BrandPage`, `ProductSearch`, `OrderDetails`, `FreeGift`, `OrderConfirmationPage`) and reusable utilities (`helper.ts`, `shippingBasedData.tsx`).
3.  **Form Management:** Consistent use of `Form.useForm()` and `Form.useWatch()` for managing form state, validations, and reacting to value changes. `RenderField` is a common utility for rendering various form input types.
4.  **API Interaction:** Frequent use of `makeAPICall` (and `makeAWSPutCall`) with `APIEndPoints` for fetching and updating data, suggesting a centralized API utility.
5.  **State Management (Redux):** `useAppDispatch` and `useSelector` indicate the use of Redux (or a similar state management library) for global state management (e.g., `getMerchantDetails`, `updatedLogoData`).
6.  **Customization Focus:** Many components, especially `BrandPage` and `OrderConfirmationPage`, are geared towards allowing merchants to customize various aspects of the checkout and post-purchase UI. This often involves color pickers, image uploads, and conditional display of UI elements.
7.  **Data Fetching & Loading States:** Common use of `useState` for `loading` flags and `useEffect` for data fetching, indicating asynchronous operations.
8.  **User Experience Features:** Includes features like debounced search, infinite scrolling, client-side validation, and informative error/success messages (`message.error`, `message.success`).
9.  **Date and Time Handling:** `dayjs` library is consistently used for date and time manipulations, including formatting, comparisons, and disabling dates in pickers.
10. **Microfrontend Integration:** The `index.ejs` file shows a clear pattern of configuring and loading multiple microfrontends using SystemJS import maps, with distinct configurations for different deployment environments (local, dev, qa, sandbox, production). This is crucial for a large, modular application.
11. **Environment Configuration:** The `.env` files (though excluded from detailed summary for security reasons) are used to manage environment-specific API URLs, indicating a standard practice for managing configurations across different deployments.
12. **Layout and Responsiveness:** Frequent use of `Row`, `Col`, and `flex` properties for layout, suggesting attention to responsive design.

### Timestamps of Significant Changes:

*   **16/11/2025, 13:10:34:** Initial implementation or major update of `BrandPage` focusing on logo and primary color customization, including AWS S3 integration.
*   **17/11/2025, 16:22:51:** Update to `ProductSearch` indicating ongoing development of discount/free gift product selection capabilities.
*   **17/11/2025, 16:23:04:** Update to `OrderDetails` for refined order data display, refund logic, and currency formatting.
*   **18/11/2025, 00:45:31:** Update to `index.ejs` for microfrontend configuration, security policies, and New Relic/Clarity integration.
*   **18/11/2025, 23:42:52:** Major update to `collapseFields.tsx`, introducing drag-and-drop reordering for customizable sections of the order confirmation page.
*   **19/11/2025, 21:10:01 - 21:12:29:** A series of minor layout adjustments to `OrderConfirmationPage`, suggesting fine-tuning of the UI and responsiveness.
*   **20/11/2025, 18:37:48:** Significant change in `index.ejs` to adjust local development dependencies to QA environment URLs.
*   **20/11/2025, 18:49:44:** Addition of input validation for numeric fields in `shippingBasedData.tsx` to improve data quality.
*   **21/11/2025, 11:48:56:** Update to `ProductSearch` adding new features (`btnSearch`, `topUpGift`) and minor refinements to existing logic.