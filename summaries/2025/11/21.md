# Activity Summary for 21/11/2025

## 12:05:28
### File-Specific Summaries:

**1. `/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/settings/customizeUI/brandPage.tsx` (16/11/2025, 13:10:34)**
This file defines the `BrandPage` component, which allows merchants to customize their checkout UI's branding. Key functionalities include:
- **Logo Upload:** Merchants can upload their brand logo. The component handles image validation (type, size), cleaning with canvas, generating a unique path, getting a pre-signed S3 URL, and uploading the image to AWS S3. It then updates the form with the logo URL and dispatches an action to update logo data in the Redux store.
- **Primary Color Selection:** A `ColorPicketComponent` is used for selecting the primary theme color for the checkout UI, which is then saved as part of the merchant's custom configuration.
- **Form Management:** Uses Ant Design's `Form` for managing brand data, including logo and primary color. Changes to form values trigger a state update (`isVisible`) to enable/disable the "Save Changes" button.
- **API Integration:** Interacts with `APIEndPoints` for downloading existing logos, getting pre-signed URLs for uploads, and updating merchant configurations.
- **State Management:** Utilizes Redux (`useSelector`, `useAppDispatch`) to fetch merchant details and dispatch updates.

**2. `/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/library/components/discounts/productSearch.tsx` (17/11/2025, 16:22:51 & 21/11/2025, 11:48:56)**
This `ProductSearch` component facilitates searching and selecting products or collections, primarily used for discount and free gift configurations.
- **Core Functionality:** Allows searching for Shopify products or collections, displaying results in a modal, and adding/removing selected items. It supports features like infinite scrolling (`useIntersectionObserver`), debounced search, and handling product variants.
- **Dynamic Search Types:** Can search for either 'products' or 'collections' based on `searchType` prop.
- **Product Aggregation:** When `collateProducts` is true, it groups product variants under their parent product for display and selection.
- **Quantity Management:** Supports displaying and modifying quantities for selected items, with specific logic for collection quantities and minimum purchase requirements.
- **Agent-Led Filtering:** Includes logic to filter products based on `no-agent` tags when `isAgentLed` is true.
- **Top-Up Gift Price:** Introduces a `topUpGift` prop to allow setting an `offered_price` for freebie products.
- **Recent Update (21/11/2025, 11:48:56):** Added a `DeleteOutlined` icon for removing items from the search result in the modal (though the provided code snippet for this specific update doesn't fully show its context within the modal's item rendering). A `btnSearch` prop was added to allow a button to trigger the search modal directly. The logic for displaying selected variants (`product?.variants?.length && ...`) was also slightly refined.

**3. `/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/orders/order-details/index.tsx` (17/11/2025, 16:23:04)**
This file defines the `OrderDetails` page for viewing and managing individual orders.
- **Order Data Display:** Fetches and displays comprehensive order information, including line items, payment details, refunds, and price breakdowns (discounts, taxes, shipping, gift cards, rewards).
- **Refund Management:** Implements logic for merging repeated refund attempts and calculating refundable amounts. It also controls the state and display of a "Refund" button and a `RefundDrawer`.
- **Currency Formatting:** Includes custom `formatCurrency` and `formatAmountWithCurrency` helpers to ensure amounts are displayed with the correct currency symbol, dynamically retrieved from order data or merchant details.
- **Conditional Actions:** Dynamically enables/disables order editing based on applied rewards, GWP discounts, or loyalty points. RTO actions are conditionally displayed based on merchant configuration.
- **Breadcrumbs & Navigation:** Manages breadcrumbs for the page and handles navigation for order not found scenarios.
- **Sensitive Data Masking:** Masks customer phone numbers and emails (`billing_phone_mask`, `billing_email_mask`).

**4. `/Users/mayuresh.madav/Documents/dashboard/dashboard-ui-configuration/src/index.ejs` (18/11/2025, 00:45:31 & 20/11/2025, 18:37:48)**
This is the main EJS template file for the Single-SPA dashboard application.
- **Microfrontend Configuration:** Defines SystemJS import maps to load various Gokwik microfrontends (e.g., `@gokwik/configuration`, `@gokwik/checkout`, `@gokwik/payment`) based on the `deployedEnv` (local, dev, qa, sandbox, production).
- **Dependency Management:** Includes CDN links for `react`, `react-dom`, and `single-spa`.
- **Security Policies:** Sets a `Content-Security-Policy` for the application, allowing resources from self, HTTPS, and localhost.
- **New Relic Integration:** Includes a New Relic browser agent script for performance monitoring, with environment-specific configuration details (accountID, agentID, licenseKey).
- **Clarity Integration:** Conditionally includes a Microsoft Clarity tracking script based on `clarityKey` for production environments.
- **Timestamp 20/11/2025, 18:37:48:** The primary change is the update of `@gokwik/utilities`, `@gokwik/dashboard`, `@gokwik/payment`, `@gokwik/kwikpass`, `@gokwik/rto`, `@gokwik/kwikship`, `@gokwik/ellora`, `@gokwik/checkout-platform`, and `@gokwik/shopify-app` URLs in the `isLocal` environment to point to `https://qa-dashboard.dev.gokwik.in/` instead of `https://sandbox-dashboard.dev.gokwik.in/` or `//localhost:XXXX`. This indicates a shift in the local development environment's dependency resolution to QA-deployed versions of other microfrontends.

**5. `/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/settings/free-gift/freeGift.tsx` (18/11/2025, 00:49:40, 18/11/2025, 00:50:14, & 18/11/2025, 00:58:39)**
This `FreeGift` component allows merchants to configure free gift rules.
- **Rule Management:** Provides a form to create and edit free gift rules, including name, sales channels, purchase type (cart value/quantity), min/max value, applicability (all products, specific products, specific collections), free gift product selection, quantity, price, and application method (auto/selection).
- **Product/Collection Search Integration:** Uses `ProductSearch` component for selecting specific products or collections that trigger the free gift or are offered as free gifts.
- **Dynamic Form Fields:** Fields are conditionally rendered or disabled based on other form values (e.g., `selection_limit` visibility based on `application_method`).
- **Table Display:** Rules are listed in a table, allowing enabling/disabling via a `Switch`, and editing/deleting via a `Dropdown` menu.
- **State Management:** Manages state for `newRules` (drawer visibility), `newGift` (list of gift rules), `editRuleId`, and `isChanged` (to enable/disable Save button).
- **Breadcrumbs:** Updates breadcrumbs to reflect the current page.
- **No significant code changes between the three timestamps for this file; likely just minor formatting or save operations.**

**6. `/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/library/components/orderConfirmationPage/collapseFields.tsx` (18/11/2025, 23:42:52)**
This component, `CustomizeUiFields`, is responsible for rendering collapsible customization sections for the order confirmation page.
- **Collapsible Sections:** Organizes various UI customization options into `Collapse` panels: Brand Logo, Dynamic Banners, Trust Banner, Order Details, Customer Information, and Support & Communication.
- **Dynamic Field Rendering:** Uses a `RenderField` utility and custom render functions (`RenderEditorFunction`, `ColorPickerHelper`) to display different types of form inputs (switch, text input, color picker).
- **Drag-and-Drop Reordering:** Implements drag-and-drop functionality for reordering the collapsible sections, allowing merchants to customize the layout of the order confirmation page.
- **Conditional Visibility:** Many fields are conditionally hidden based on the `enabled` state of their parent section.
- **Prop-Based Form Interaction:** Receives `form` and `setButtonState` props to interact with the parent form and trigger save button state changes.

**7. `/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/settings/orderConfirmation/index.tsx` (19/11/2025, 21:10:01, 19/11/2025, 21:11:54, 19/11/2025, 21:12:22, & 19/11/2025, 21:12:29)**
This `OrderConfirmationPage` component provides the interface for merchants to customize their post-purchase experience.
- **Main Layout:** Uses a two-column layout (`Row`, `Col`) with customization forms on the left and a live preview on the right.
- **Form Management:** Utilizes Ant Design's `Form` with `initialValuesForThankYouPageForm` and `onValuesChange` to track changes and enable the "Save Changes" button.
- **Customizable Sections:** Integrates `MainSection` (which likely includes `CustomizeUiFields`) to manage various customizable elements of the confirmation page.
- **Form Submission Logic:** `handleFormSubmit` validates form fields, specifically excluding certain fields from validation if they are dynamically controlled, and logs the form data.
- **Informational Alerts:** Includes an `Alert` component to inform users about redirecting from Shopify's page.
- **InfoComponent:** Provides a link to a wiki page for more information on customizing the UI.
- **Timestamp 19/11/2025, 21:11:54, 19/11/2025, 21:12:22, & 19/19/2025, 21:12:29:** The `flex` property of the `Col` components was adjusted (from `1 1 200px` to `1 1 300px` and back to `1 1 200px`, then to `1 1 300px` again, while the right column's `flex` also fluctuated between `0 1 500px` and `0 1 300px`). These changes indicate minor adjustments to the responsive layout or column widths for the customization and preview sections.

**8. `/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/library/components/shipping/shippingBasedData.tsx` (20/11/2025, 18:44:34, 20/11/2025, 18:44:55, 20/11/2025, 18:49:44, & 20/11/2025, 18:49:50)**
This `processProductBasedShippingData` component is a helper/renderer for configuring product-based shipping rules.
- **Rule Definition:** Allows defining shipping rules based on specific products or collections, including rule name, price, mapping to an existing shipping ID, calculation method (override/add-on), price multiplier, and combination with weight-based shipping.
- **Product/Collection Selection:** Integrates `ProductSearch` to add products or collections to the shipping rule. It includes validation to prevent adding similar product variants or collections multiple times.
- **Data Mapping:** `dataMapperForItems` transforms selected products/collections into a format suitable for display in the table.
- **Dynamic Options:** `selectedOptions` memoizes a list of available shipping IDs for mapping, filtering out already used ones.
- **Form Structure:** Defines a `fields` array for dynamically rendering form items using `RenderField`.
- **Table Display:** Displays selected items (products/collections) in a table, allowing removal.
- **Keypress Validation (20/11/2025, 18:49:44 & 20/11/2025, 18:49:50):** A `onKeyPress` validator was added to the 'Rule price' `inputNumber` field to restrict input to only numbers and decimal points (`/[0-9.]$/.test(event.key)`). This prevents invalid characters in the price field. The change between `18:49:44` and `18:49:50` seems to be an exact duplicate, indicating a re-save or minor, non-functional change.

**9. `/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/library/utilities/helpers/helper.ts` (21/11/2025, 11:50:18 & 21/11/2025, 11:51:40)**
This file provides a collection of utility helper functions.
- **Filtering & Formatting:** `getDynamicSearchFilters`, `formatDateString`, `setCurrencySymbol`, `formatAmount` for data manipulation and display. `formatAmount` handles number formatting with a global currency symbol and optional notation.
- **Comparison & Validation:** `shopifyAppCheckoutEnabledStatus` (checks last login date), `deepCompare` (for object comparison), `uploadCohortCsv` (validates and processes CSV files for phone numbers or emails).
- **Date & Time Helpers:** `debounce`, `disabledBeforeDate`, `disabledBeforeTime`, `getFutureDateString`, `disabledDate`, `disabledTime` for handling dates and times, often used in date pickers.
- **String Manipulation:** `capitalizeFirstLetter`.
- **Table Data Processing:** `extractTitlesAndDataIndexes` (for table columns), `sortDataByKey`, `extractUniqueCKeysForAntColumn`.
- **Array Comparison:** `compareAndCaptureArrayFields` for identifying added/removed items in arrays.
- **Range Validation:** `areBothRangesMoreThanOneDay`.
- **No significant code changes between the two timestamps for this file; likely just minor formatting or save operations.**

### Overall Patterns and Recurring Elements:

1.  **React and Ant Design:** The codebase heavily relies on React for UI development and `gokwik-ui-kit` (which seems to be an Ant Design wrapper/extension) for components like `Form`, `Button`, `Card`, `Table`, `Input`, `Switch`, `Dropdown`, `message`, `Tooltip`, `Alert`, `Col`, `Row`, `Collapse`, etc.
2.  **Modular Architecture:** Components are organized by functionality (e.g., `BrandPage`, `ProductSearch`, `OrderDetails`, `FreeGift`, `OrderConfirmationPage`) and reusable utilities (`helper.ts`, `shippingBasedData.tsx`).
3.  **Form Management:** Consistent use of `Form.useForm()` and `Form.useWatch()` for managing form state, validations, and reacting to value changes. `RenderField` is a common utility for rendering various form input types.
4.  **API Interaction:** Frequent use of `makeAPICall` (and `makeAWSPutCall`) with `APIEndPoints` for fetching and updating data, suggesting a centralized API utility.
5.  **State Management (Redux):** `useAppDispatch` and `useSelector` indicate the use of Redux (or a similar state management library) for global state management (e.g., `getMerchantDetails`, `updatedLogoData`).
6.  **Customization Focus:** Many components, especially `BrandPage` and `OrderConfirmationPage`, are geared towards allowing merchants to customize various aspects of the checkout and post-purchase UI. This often involves color pickers, image uploads, and conditional display of UI elements.
7.  **Data Fetching & Loading States:** Common use of `useState` for `loading` flags and `useEffect` for data fetching, indicating asynchronous operations.
8.  **User Experience Features:** Includes features like debounced search, infinite scrolling, client-side validation, and informative error/success messages (`message.error`, `message.success`).
9.  **Date and Time Handling:** `dayjs` library is consistently used for date and time manipulations, including formatting, comparisons, and disabling dates in pickers.
10. **Microfrontend Integration:** The `index.ejs` file shows a clear pattern of configuring and loading multiple microfrontends using SystemJS import maps, with distinct configurations for different deployment environments (local, dev, qa, sandbox, production). This is crucial for a large, modular application.
11. **Environment Configuration:** The `.env` files (though excluded from detailed summary for security reasons) are used to manage environment-specific API URLs, indicating a standard practice for managing configurations across different deployments.
12. **Layout and Responsiveness:** Frequent use of `Row`, `Col`, and `flex` properties for layout, suggesting attention to responsive design.

### Timestamps of Significant Changes:

*   **16/11/2025, 13:10:34:** Initial implementation or major update of `BrandPage` focusing on logo and primary color customization, including AWS S3 integration.
*   **17/11/2025, 16:22:51:** Update to `ProductSearch` indicating ongoing development of discount/free gift product selection capabilities.
*   **17/11/2025, 16:23:04:** Update to `OrderDetails` for refined order data display, refund logic, and currency formatting.
*   **18/11/2025, 00:45:31:** Update to `index.ejs` for microfrontend configuration, security policies, and New Relic/Clarity integration.
*   **18/11/2025, 23:42:52:** Major update to `collapseFields.tsx`, introducing drag-and-drop reordering for customizable sections of the order confirmation page.
*   **19/11/2025, 21:10:01 - 21:12:29:** A series of minor layout adjustments to `OrderConfirmationPage`, suggesting fine-tuning of the UI and responsiveness.
*   **20/11/2025, 18:37:48:** Significant change in `index.ejs` to adjust local development dependencies to QA environment URLs.
*   **20/11/2025, 18:49:44:** Addition of input validation for numeric fields in `shippingBasedData.tsx` to improve data quality.
*   **21/11/2025, 11:48:56:** Update to `ProductSearch` adding new features (`btnSearch`, `topUpGift`) and minor refinements to existing logic.

## 13:05:26
The provided logs track changes across several JavaScript/TypeScript files within a `checkout-dashboard-ui` project and an EJS template in a `dashboard-ui-configuration` project. The changes primarily focus on UI customization, discount management, order details, and environmental configuration.

### File-Specific Updates:

1.  **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/settings/customizeUI/brandPage.tsx`** (Timestamp: 16/11/2025, 13:10:34)
    *   This file manages the "Brand" customization page, allowing merchants to upload their logo and select a primary theme color.
    *   Key functionalities include:
        *   **Image Upload:** Handles logo uploads with validation for file type (JPEG, PNG, SVG) and size (under 2MB). It uses `cleanImageWithCanvas`, `makeAPICall` for presigned URLs, and `makeAWSPutCall` for AWS S3 uploads.
        *   **Color Picker Integration:** Incorporates a `ColorPicketComponent` for selecting the primary theme color.
        *   **Form Management:** Uses Ant Design's `Form` for data handling, `Form.useWatch` to monitor changes, and `saveConfig` from `useMerchantConfigApi` to persist settings.
        *   **State Management:** Utilizes `useState` for UI visibility (`isVisible`) and `useEffect` hooks to fetch merchant details and custom configuration on component mount, and to dispatch brand data updates.
        *   **Save Logic:** The `onFinish` handler updates the merchant's logo via API calls and saves other custom configurations.

2.  **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/library/components/discounts/productSearch.tsx`**
    *   **Timestamp: 17/11/2025, 16:22:51**
        *   This component provides a modal for searching and selecting Shopify products or collections, used in discount and free gift configurations.
        *   It supports searching by product or collection, handling pagination (`useIntersectionObserver` for infinite scroll), and debouncing search input.
        *   **Functionality:** Displays selected items, allows adding/removing, handles quantity adjustments for products (specifically for gift/top-up scenarios), and supports collating product variants.
        *   Includes filtering for "Agent led" products (items without a 'no-agent' tag).
        *   **Props:** `searchType`, `hideSearch`, `hideButton`, `buttonText`, `items`, `onAdd`, `onRemove`, `collateProducts`, `showQuantity`, `alloweditemscount`, `hideSearchInput`, `isAgentLed`, `topUpGift`, `collectionSpecificData`.
    *   **Timestamp: 21/11/2025, 11:48:56**
        *   Added a `DeleteOutlined` icon to the component imports.
        *   Introduced a new prop `btnSearch` to control the visibility of a "Select \[products/collections]" button, providing an alternative way to open the search modal.
        *   Adjusted the display logic for `product?.variants?.length` to prevent showing "0 variants selected" when there are no variants.
        *   Modified `handleQuantityChange` to conditionally update the quantity based on `collectionSpecificData?.collectionMinimumPurchangeQuantity`.

3.  **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/orders/order-details/index.tsx`** (Timestamp: 17/11/2025, 16:23:04)
    *   This file displays detailed information about a specific order.
    *   **Key features:**
        *   Fetches and displays order data, including price breakups, transactions, and refunds.
        *   Handles currency formatting using a global `currentCurrencySymbol`.
        *   **Refund Management:** Implements `mergeRepeatedRefunds` to consolidate refund attempts and calculates refundable amounts, impacting the refund button's state (`refundBtnState`).
        *   **Order Editing Logic:** Sets `disableEdit` and `title` based on whether rewards, GWP discounts, or loyalty points are applied to the order.
        *   **Customer Information:** Masks customer phone number and email initially, with buttons to reveal them.
        *   **UI Components:** Uses `Tabs`, `Table`, `Tag`, `Tooltip`, `Popover`, and various icons from `gokwik-ui-kit` to present information.
        *   **Breadcrumbs:** Updates breadcrumbs for navigation context.

4.  **`/Users/mayuresh.madav/Documents/dashboard/dashboard-ui-configuration/src/index.ejs`**
    *   **Timestamp: 18/11/2025, 00:45:31**
        *   The Single-SPA import map configuration for the `gokwik` applications is updated.
        *   For `isLocal` environment, `@gokwik/checkout` is set to `//localhost:9002/gokwik-checkout.js`.
        *   For `deployedEnv==='dev'`, `@gokwik/kwikcomm` is added with a URL `https://dev-dashboard.dev.gokwik.in/kwikcomm/gokwik-kwikcomm.js`.
        *   For `deployedEnv==='qa'`, `@gokwik/kwikcomm` is added with a URL `https://qa-dashboard.dev.gokwik.in/kwikcomm/gokwik-kwikcomm.js`.
        *   New Relic and Clarity (Microsoft) analytics scripts are included for the `production` environment, using templated `clarityKey` for Clarity.
    *   **Timestamp: 20/11/2025, 18:37:48**
        *   Minor change in the `isLocal` environment configuration: `@gokwik/utilities` and `@gokwik/dashboard` URLs are updated from `sandbox-dashboard.dev.gokwik.in` to `qa-dashboard.dev.gokwik.in`. The `@gokwik/checkout` URL remains localhost.
    *   **Timestamp: 21/11/2025, 12:27:47**
        *   Reverted the change from 20/11/2025. In the `isLocal` environment, `@gokwik/utilities` and `@gokwik/dashboard` URLs are changed back from `qa-dashboard.dev.gokwik.in` to `sandbox-dashboard.dev.gokwik.in`.

5.  **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/settings/free-gift/freeGift.tsx`**
    *   **Timestamp: 18/11/2025, 00:49:40**
        *   Manages the "Free Gift Settings" page, allowing the configuration of automatic free gift rules.
        *   **Form Structure:** Uses an Ant Design form (`Form.useForm`) with fields for rule name, sales channels (App, Web, Agent led), purchase requirements (Cart value, Quantity), applicable products/collections, free gift quantity/price, and application method (Auto/Selection).
        *   **Dynamic Fields:** The `hideControlInput` property is used to conditionally hide fields based on `giftApplicableOn` and `applicationMethod`.
        *   **Product/Collection Search:** Integrates `ProductSearch` component for selecting specific free gift products or applicable products/collections.
        *   **Rule Management:** Allows adding new rules, editing existing ones (`handleEdit`), and deleting rules (`handleDelete`).
        *   **Status Toggle:** A `Switch` component in the table allows enabling/disabling individual gift rules.
        *   **Breadcrumbs:** Updates breadcrumbs to reflect navigation.
    *   **Timestamp: 18/11/2025, 00:50:14** and **18/11/2025, 00:58:39**
        *   No observable code changes in the provided snippets. These seem to be consecutive saves without functional changes.

6.  **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/library/components/orderConfirmationPage/collapseFields.tsx`** (Timestamp: 18/11/2025, 23:42:52)
    *   This component renders a collapsible UI for customizing various sections of the order confirmation page.
    *   **Collapsible Sections:** Contains `Collapse` items for "Brand Logo Customization" (using `LogoPage`), "Dynamic Banners" (using `RenderEditorFunction`), "TrustBanner" (using `TrustBadgeForm`), "Order Details", "Customer Information", and "Support & Communication".
    *   **Dynamic Form Fields:** Each section contains `RenderField` components for common input types (switch, input) and `ColorPickerHelper` for background and text color customization.
    *   **Drag-and-Drop Reordering:** Implements drag-and-drop functionality for reordering the collapsible sections, indicating a dynamic layout capability for the order confirmation page.

7.  **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/settings/orderConfirmation/index.tsx`**
    *   **Timestamp: 19/11/2025, 21:10:01**
        *   This page allows customization of the order confirmation page, featuring a form section and a preview section.
        *   **Enable/Disable Feature:** Includes a switch to enable/disable the custom order confirmation page, with an `Alert` explaining its impact (redirecting from Shopify's page).
        *   **Form Submission:** `handleFormSubmit` validates form fields, specifically excluding `trust_text` and `trust_tag` from validation.
        *   **Layout:** Uses `Row` and `Col` for a responsive two-column layout, with one column for the form (`MainSection`) and another for the `OrderConfirmationPreview`.
        *   Initial values for the form are loaded from `initialValuesForThankYouPageForm`.
        *   **State:** `changed` state tracks form modifications to enable/disable the "Save Changes" button.
    *   **Timestamp: 19/11/2025, 21:11:54**, **19/11/2025, 21:12:22**, **19/11/2025, 21:12:29**
        *   These entries show changes in the `flex` property of the `Col` components, specifically adjusting the width of the form and preview sections.
        *   The form column `flex` property was changed from `'1 1 200px'` to `'1 1 300px'` and back, and the preview column `flex` from `'0 1 500px'` to `'0 1 300px'` and back to `'0 1 500px'`. This indicates UI layout adjustments for better display of the form and preview.

8.  **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/library/components/shipping/shippingBasedData.tsx`**
    *   **Timestamp: 20/11/2025, 18:44:34**
        *   This component (`processProductBasedShippingData` function) handles the configuration of product-based shipping rules within a modal or drawer.
        *   **Data Mapping:** Maps raw shipping data into a table format, extracting rule details like name, price, mapped shipping ID, calculation method, price multiplier, and weight combination.
        *   **Product/Collection Selection:** Integrates the `ProductSearch` component to add specific products or collections to a shipping rule. It includes logic to prevent adding duplicate product variants or collections.
        *   **Form Fields:** Defines fields for rule name, price, mapping to an existing shipping ID, calculation method (override/add), price multiplier, and combining with weight-based shipping.
        *   **Item Display:** Uses a `Table` to display selected products/collections (`itemsData`) with images, titles, variant counts, and a delete button.
        *   **State Management:** Uses `useState` for `itemsData` (selected products/collections) and `previousShippingData`. `useMemo` optimizes `selectedOptions` for shipping IDs.
    *   **Timestamp: 20/11/2025, 18:44:55**
        *   The `price` field type in `fields` was changed from `'inputNumber'` to `'input'`. This is a minor type change for the form input.
    *   **Timestamp: 20/11/2025, 18:49:44** and **20/11/2025, 18:49:50**
        *   Added an `onKeyPress` event handler to the `price` input field, restricting input to only numbers and decimal points (`/[0-9.]$/.test(event.key)`). This ensures that only valid numeric input can be entered for the shipping rule price. No other functional changes in the provided snippets for these two timestamps.

9.  **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/library/utilities/helpers/helper.ts`**
    *   **Timestamp: 21/11/2025, 11:50:18** and **21/11/2025, 11:51:40**
        *   No observable code changes in the provided snippets. These seem to be consecutive saves without functional changes. This file contains various utility functions for formatting dates, currency, numbers, managing search filters, handling file uploads (CSV cohorts), and array comparisons.

### Timestamps of Significant Changes:

*   **16/11/2025, 13:10:34:** Brand customization page logic (logo upload, color picker, API integration).
*   **17/11/2025, 16:22:51:** Initial version of the product/collection search component with core functionalities.
*   **17/11/2025, 16:23:04:** Order details page logic, including refund processing, currency formatting, and dynamic editability.
*   **18/11/2025, 00:45:31:** Update to `index.ejs` adding `kwikcomm` for dev/qa environments and New Relic/Clarity for production.
*   **18/11/2025, 00:49:40:** Free gift settings page implementation with rule management and product/collection selection.
*   **18/11/2025, 23:42:52:** Order confirmation page UI customization with collapsible sections and drag-and-drop reordering.
*   **19/11/2025, 21:10:01 - 21:12:29:** Minor UI layout adjustments (flex widths) on the order confirmation page.
*   **20/11/2025, 18:37:37:** Environment variable changes, enabling QA environment API URLs and commenting out sandbox.
*   **20/11/2025, 18:37:48:** `index.ejs` change to point `@gokwik/utilities` and `@gokwik/dashboard` to QA in `isLocal` env.
*   **20/11/2025, 18:49:44:** Added input validation (numbers and decimals only) for shipping rule prices.
*   **21/11/2025, 11:48:56:** Enhancements to product search component (`btnSearch` prop, quantity update logic).
*   **21/11/2025, 12:27:36:** Environment variable changes, enabling sandbox environment API URLs and commenting out QA.
*   **21/11/2025, 12:27:47:** `index.ejs` change to point `@gokwik/utilities` and `@gokwik/dashboard` back to sandbox in `isLocal` env.

### Patterns or Recurring Elements:

*   **Ant Design (gokwik-ui-kit):** Extensive use of `Form`, `Button`, `Card`, `Row`, `Col`, `Input`, `InputNumber`, `Switch`, `Table`, `Dropdown`, `message`, `Tooltip`, `Alert`, etc., from `gokwik-ui-kit` (presumably an Ant Design-based library) for building UI components and forms.
*   **Form Management:** Consistent use of `Form.useForm()` and `Form.useWatch()` for managing form state and reacting to value changes.
*   **Merchant Configuration:** Frequent interaction with `useMerchantConfigApi` hook (from `@library/utilities/hooks/useMerchantConfig`) and `makeAPICall` for fetching and saving merchant-specific configurations.
*   **Product/Collection Search:** The `ProductSearch` component (from `@library/components/discounts/productSearch`) is reused across different settings pages (e.g., Free Gift, Shipping) for selecting items.
*   **Utility Helpers:** Reliance on `@library/utilities/helpers/helper.ts` for common tasks like `formatAmount`, `setCurrencySymbol`, and form rendering (`RenderField`).
*   **API Endpoints:** API calls are consistently made using `makeAPICall` and `APIEndPoints` from `@library/utilities/constants/apiEndpoints`.
*   **Breadcrumb Updates:** The `updateBreadcrumbs` utility function from `@gokwik/utilities` is used to maintain navigation context across pages.
*   **Environment Configuration:** The `.env` file and `index.ejs` frequently change to point to different API gateways (dev, qa, sandbox) and import map URLs based on the `deployedEnv` or `isLocal` variables, indicating active development and deployment processes across multiple environments.
*   **UI Customization:** A strong theme of customizable UI elements is present, from brand logos and colors to dynamic banners and order confirmation page layouts. This suggests a product heavily focused on white-labeling or extensive merchant-specific branding.

## 14:05:57
**File-Specific Updates & Significant Timestamps:**

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/settings/customizeUI/brandPage.tsx` (16/11/2025, 13:10:34)**:
    *   This component has been updated to provide robust brand UI customization, specifically for logo management and theme coloring.
    *   It includes asynchronous logic for checking logo presence, fetching pre-signed URLs for AWS S3 uploads, and converting images to base64 for preview.
    *   Client-side validation for logo file types (JPEG, PNG, SVG) and size (< 2MB) is implemented.
    *   The page integrates a `ColorPickerComponent` for setting the primary theme color and saves configuration changes via a merchant API hook.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/library/components/discounts/productSearch.tsx` (17/11/2025, 16:22:51 & 21/11/2025, 11:48:56)**:
    *   This `ProductSearch` component has received significant enhancements for searching and selecting products or collections.
    *   It now features debounced search and infinite scrolling for improved performance in modals.
    *   Specific logic for handling "top-up gifts" and setting `offered_price` has been added.
    *   A new `btnSearch` prop was introduced (on 21/11/2025) to display a dedicated button for initiating product/collection selection, improving UI flexibility.
    *   It filters results based on an `isAgentLed` prop, excluding items tagged 'no-agent'.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/orders/order-details/index.tsx` (17/11/2025, 16:23:04)**:
    *   The order details page was updated to provide a more comprehensive view and management capabilities.
    *   Key changes include enhanced refund processing logic, which merges multiple refund attempts and dynamically calculates refundable amounts.
    *   Dynamic currency symbol handling (`setCurrencySymbol`, `formatAmountWithCurrency`) has been implemented for global currency support.
    *   Order editability is now conditionally disabled based on specific applied discounts (e.g., Twid rewards, Loyalty Points, GWP discounts).
    *   It also features detailed price breakdown calculations and conditional visibility for RTO (Return to Origin) actions and scores based on merchant configurations.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/settings/free-gift/freeGift.tsx` (18/11/2025, 00:49:40 - 00:58:39)**:
    *   This component enables merchants to create and manage free gift rules with a detailed form.
    *   The form fields exhibit conditional rendering based on selected options like `applicationMethod` and `giftApplicableOn`.
    *   It integrates the `ProductSearch` component for selecting specific free gift products or collections, including validation to prevent duplicate additions.
    *   Sales channel options dynamically adjust; specifically, `shopify_agent` is disabled if the application method is not 'auto'.
    *   *Note*: Multiple timestamps within a short period suggest frequent saving during development, with the code content being identical across these entries.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/library/components/orderConfirmationPage/collapseFields.tsx` (18/11/2025, 23:42:52)**:
    *   This new component provides a highly configurable interface for customizing the order confirmation page.
    *   It organizes customization settings (Brand Logo, Dynamic Banners, Trust Banner, Order Details, Customer Information, Support & Communication) into collapsible panels.
    *   Each section offers granular control over text content, colors (via `ColorPickerHelper`), and can be enabled or disabled with a toggle switch.
    *   A drag-and-drop feature is implemented, allowing users to reorder the display sequence of these sections.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/settings/orderConfirmation/index.tsx` (19/11/2025, 21:10:01 - 21:12:29)**:
    *   This is the main page for configuring the custom order confirmation page, featuring a primary toggle to enable or disable the custom experience.
    *   The UI is structured in a two-column layout, with one column for form-based settings and another for a live preview (`OrderConfirmationPreview`).
    *   Form submission includes a validation mechanism that can exclude specific fields from required checks.
    *   *Note*: Several timestamps within a short timeframe show minor adjustments to the `flex` properties of the layout columns, indicating iterative UI refinement. The final configuration for the settings column is `flex='1 1 300px'` and for the preview column `flex='0 1 500px'`.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/library/components/shipping/shippingBasedData.tsx` (20/11/2025, 18:44:34 - 18:49:50)**:
    *   Updates to the component managing product-based shipping rules.
    *   It facilitates the definition of rule name, price, and mapping to existing shipping IDs, along with configurable calculation methods and price multipliers.
    *   The `ProductSearch` component is integrated for selecting specific products or collections to apply rules to, preventing duplicate entries.
    *   A notable change at `20/11/2025, 18:49:44` involved changing the 'Rule price' input field from `inputNumber` to `input` with a custom `onKeyPress` handler to enforce strict numerical and decimal point input.
    *   *Note*: Similar to `freeGift.tsx`, multiple timestamps indicate frequent saves with minor or no functional changes, except for the mentioned price input refinement.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/library/utilities/helpers/helper.ts` (21/11/2025, 11:50:18 - 11:51:40)**:
    *   This core utility file contains a broad range of helper functions for common tasks, including date and currency formatting, deep object comparison, debouncing, date/time picker disabling logic, string capitalization, table data extraction and sorting, and CSV cohort upload validation.
    *   *Note*: The code content is identical across these two timestamps, suggesting a file save without actual functional modifications.

**Patterns and Recurring Elements:**

1.  **Form-Driven Development**: A strong pattern of using Ant Design `Form` for configuring features (branding, free gifts, order confirmation, shipping rules) is evident, implying a standardized approach to UI and data management across the dashboard.
2.  **Modular and Reusable Components**: Components like `ProductSearch`, `RenderField`, `InfoComponent`, and `ColorPickerHelper` are frequently reused, showcasing a modular architecture that promotes consistency and maintainability.
3.  **API and State Management**: Consistent use of `makeAPICall`, `makeAWSPutCall`, custom API hooks (`useMerchantConfigApi`), and Redux (`useAppDispatch`, `useSelector`) for handling data fetching, saving, and global state across the application.
4.  **UI Customization Focus**: Many changes are directed towards giving merchants more control over the appearance and functionality of the checkout and post-purchase experience (e.g., logo, theme colors, banners, order details sections).
5.  **Environment Configuration and Micro-frontends**: The repeated updates to `dashboard-ui-configuration/src/index.ejs` and `.env` files highlight an active development workflow involving switching between different environments (dev, qa, sandbox). The `index.ejs` file specifically shows dynamic loading of micro-frontend modules (e.g., `@gokwik/utilities`, `@gokwik/dashboard`) from various URLs, indicating a micro-frontend architecture where components can be sourced from different deployment targets, even locally.
6.  **Iterative Refinement and Frequent Saves**: The presence of multiple identical timestamps for several files, often within minutes, suggests a development pattern of frequent saves, minor UI adjustments, or quick reverts, reflecting an agile development process.

## 15:05:24
The provided log details changes across several files within the `checkout-dashboard-ui` and `dashboard-ui-configuration` projects.

**File-Specific Updates:**

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/settings/customizeUI/brandPage.tsx`** (Timestamp: 16/11/2025, 13:10:34)
    *   This file, responsible for the brand customization page, includes functionality for uploading a merchant logo and setting primary UI colors.
    *   It uses `Form.useWatch` to track changes in `brand_data` for logo images and `cssRules` for primary color.
    *   `useEffect` hooks fetch existing logo URLs and configuration details.
    *   `validateUpload` ensures image files are JPEG, PNG, or SVG and less than 2MB.
    *   `handleUpload` processes the uploaded image, cleans it with canvas, gets a presigned URL from AWS, and updates the form and Redux store.
    *   `onFinish` handles saving changes, including updating the merchant logo via API and saving configuration.
    *   The UI allows users to upload a logo and pick a primary theme color, with an `InfoComponent` linking to relevant documentation.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/library/components/discounts/productSearch.tsx`** (Timestamp: 17/11/2025, 16:22:51 and 21/11/2025, 11:48:56)
    *   This component provides a reusable product/collection search functionality, likely for discount or gift configurations.
    *   It manages state for loading, search text, modal visibility, results, and pagination.
    *   `fetchData` asynchronously retrieves Shopify collections or products.
    *   `parseResponse` processes the API response, handling product variants and collections, and filtering items based on `isAgentLed` flag (removing items with 'no-agent' tag).
    *   Includes `useEffect` for debounced search and modal state management.
    *   The component supports adding/removing selected items, handling quantities, and includes specific logic for "top-up gift" pricing.
    *   **Significant Change on 21/11/2025:** Added `DeleteOutlined` import, a new `btnSearch` prop for displaying a dedicated "Select products/collections" button, and refined the display logic for `product?.variants?.length` in the UI to prevent displaying "0 variants selected" when there are no variants.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/orders/order-details/index.tsx`** (Timestamp: 17/11/2025, 16:23:04)
    *   This file manages the order details page.
    *   It fetches and displays comprehensive order data, including price breakdowns, refunds, and customer information.
    *   Introduces `formatAmountWithCurrency` to format amounts with the correct currency symbol, overriding the default `formatAmount`.
    *   `mergeRepeatedRefunds` is a new helper function to consolidate multiple refund attempts for a single `gokwik_rid` into a `MergedRepeatedRefund` object, showing attempts and a more generalized status (Completed, Failed, Initiated).
    *   The component determines refund button state (`disabled`, `refundStatus`, `refundableAmount`) based on transactions and existing refunds.
    *   Adds logic for `setEditTitle` to display specific messages and disable editing if Twid rewards, GWP discounts, or loyalty points are applied.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/settings/free-gift/freeGift.tsx`** (Timestamps: 18/11/2025, 00:49:40, 00:50:14, 00:58:39)
    *   This component manages the Free Gift Settings page, allowing merchants to configure free gift rules.
    *   It uses `Form.useWatch` to monitor various aspects of the `auto_gift_rules_config`.
    *   Includes `useEffect` to update breadcrumbs.
    *   Defines a comprehensive `fields` array for rendering different form inputs (input, checkbox, radio, inputNumber, search, switch) for rule creation.
    *   The `columns` array defines the structure of the rules table, including status switches and dropdown actions for edit/delete.
    *   `handleEdit` and `handleDelete` functions manage rule modification and removal.
    *   `handleAddFreeGiftProduct` and `handleAddApplicableOnItems` functions handle adding products/collections to gift rules, including validation for duplicate items.
    *   **Pattern:** Multiple timestamps within a short period (00:49:40 to 00:58:39) indicate rapid iterative development or small adjustments to the same component, suggesting active work on the Free Gift feature. The code remains largely identical across these three timestamps, indicating minor or non-substantive changes, possibly formatting or very small logic tweaks not captured in the diff provided.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/library/components/orderConfirmationPage/collapseFields.tsx`** (Timestamp: 18/11/2025, 23:42:52)
    *   This component renders collapsible sections for customizing the order confirmation UI.
    *   It defines fields for "Order Details," "Customer Information," and "Support & Communication" with switches to enable/disable sections, input fields for text, and `ColorPickerHelper` components for background/text colors.
    *   Each section in the `Collapse` component (`items`) also includes an `extra` `Switch` for toggling its overall enabled state.
    *   Introduces drag-and-drop functionality for reordering collapse items, allowing users to customize the layout of the order confirmation page.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/settings/orderConfirmation/index.tsx`** (Timestamps: 19/11/2025, 21:10:01, 21:11:54, 21:12:22, 21:12:29)
    *   This page allows customization of the order confirmation page, featuring a form section and a preview section.
    *   It includes a global switch to enable/disable the custom order confirmation page and an alert about redirecting from Shopify.
    *   `handleFormSubmit` includes validation logic that specifically excludes certain fields (`trust_text`, `trust_tag`) from required validation.
    *   **Pattern:** Multiple timestamps (21:10:01 to 21:12:29) for this file within a very short timeframe show repeated minor adjustments. The diffs primarily indicate changes to the `flex` property of the `Col` components, specifically adjusting `flex='1 1 200px'` to `flex='1 1 300px'` and back, suggesting UI layout or responsiveness adjustments being tested or refined.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/library/components/shipping/shippingBasedData.tsx`** (Timestamps: 20/11/2025, 18:44:34, 18:44:55, 18:49:44, 18:49:50)
    *   This component manages product-based shipping rules, allowing creation and mapping to existing shipping IDs.
    *   It processes `product_based_rules` from `shipping` data to generate `tableData`.
    *   Includes `dataMapperForItems` to format product/collection data for display.
    *   `selectedOptions` memoizes available shipping IDs for mapping, filtering out already used ones.
    *   `itemColumnData` defines the columns for displaying selected products/collections, including an image, title, variant count, type, and a delete button.
    *   The `fields` array defines the form for creating shipping rules, including rule name, price, shipping ID, calculation method (override/add), price multiplier, and combination with weight-based shipping.
    *   Integrates `ProductSearch` for adding specific products or collections to the rules.
    *   **Significant Change on 20/11/2025, 18:49:44:** Added an `onKeyPress` event handler to the `Rule price` input field to restrict input to only numbers and periods (`.`), improving data validation for numerical fields.
    *   **Pattern:** Similar to `freeGift.tsx` and `orderConfirmation/index.tsx`, multiple timestamps within minutes (18:44:34 to 18:49:50) indicate focused work or minor, iterative changes to the file.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/library/utilities/helpers/helper.ts`** (Timestamps: 21/11/2025, 11:50:18, 11:51:40)
    *   This utility file contains various helper functions.
    *   Functions include `getDynamicSearchFilters`, `formatDateString`, `setCurrencySymbol`, `formatAmount`, `shopifyAppCheckoutEnabledStatus`, `deepCompare`, `debounce`, `disabledBeforeDate`, `disabledBeforeTime`, `capitalizeFirstLetter`, `formatNumber`, `extractTitlesAndDataIndexes`, `sortDataByKey`, `uploadCohortCsv`, `getFutureDateString`, `compareAndCaptureArrayFields`, `areBothRangesMoreThanOneDay`, `extractUniqueCKeysForAntColumn`, `disabledDate`, and `disabledTime`.
    *   **No significant changes noted between the two timestamps on 21/11/2025.** This suggests minor, non-functional changes or no actual code modifications.

*   **`/Users/mayuresh.madav/Documents/dashboard/dashboard-ui-configuration/src/index.ejs`** (Timestamps: 18/11/2025, 00:45:31, 20/11/2025, 18:37:48, 21/11/2025, 12:27:47)
    *   This is the main EJS template file for the dashboard-ui-configuration.
    *   It defines the HTML structure, meta tags (including Content Security Policy), and imports for `single-spa` and shared dependencies.
    *   It uses conditional logic (`<% if (isLocal) %>`, `<% else if (deployedEnv==='dev' ) %>`, etc.) to load different module import maps based on the deployment environment (local, dev, qa, sandbox, production).
    *   **Significant Change on 20/11/2025:** The `isLocal` block's `@gokwik/utilities` and `@gokwik/dashboard` URLs were changed from `sandbox-dashboard.dev.gokwik.in` to `qa-dashboard.dev.gokwik.in`. This indicates a change in the local development environment's dependency resolution, pointing to QA environment assets instead of sandbox for these specific modules.
    *   **Significant Change on 21/11/2025:** The `isLocal` block's `@gokwik/utilities` and `@gokwik/dashboard` URLs were reverted from `qa-dashboard.dev.gokwik.in` back to `sandbox-dashboard.dev.gokwik.in`. This reversal suggests testing or a change in local development strategy regarding which environment's assets to consume.

**General Patterns and Recurring Elements:**

*   **React Component Development:** The majority of changes are in React/TypeScript files (`.tsx`), indicating active development of UI features.
*   **Form Management:** The use of `Form.useForm()` and `Form.useWatch()` from `gokwik-ui-kit` (presumably an internal UI library) is consistent across several UI components for managing form state and reacting to value changes.
*   **API Interactions:** Many components interact with backend APIs via `makeAPICall` or `useMerchantConfigApi` (a custom hook), demonstrating a data-driven approach.
*   **Customization Features:** There's a strong focus on merchant-facing customization, evident in `brandPage.tsx` for branding, `freeGift.tsx` for free gift rules, and `orderConfirmation/index.tsx` and `collapseFields.tsx` for post-purchase page customization.
*   **UI/UX Refinements:** Minor adjustments to UI elements like `flex` properties and input validation (`onKeyPress` for number inputs) suggest continuous iteration on user experience.
*   **Breadcrumbs:** The `updateBreadcrumbs` utility is consistently used to manage navigation paths within the dashboard.
*   **Environment Configuration:** The `index.ejs` file shows a clear pattern of configuring module imports based on the `deployedEnv` variable, allowing for environment-specific dependency loading. The repeated changes to the `isLocal` block in `index.ejs` for `utilities` and `dashboard` URLs specifically indicate ongoing adjustments to local development setups or testing against different backend environments.
*   **Date Formatting and Utilities:** The `helper.ts` file consolidates common utility functions, including date manipulation, number formatting, and array comparison.

## 16:05:24
The changes primarily focus on enhancing the UI/UX of a checkout dashboard, particularly concerning brand customization, discount management (free gifts, product/collection search), order details, and order confirmation page configurations. A notable theme is the use of Ant Design's `Form` component for managing state and `gokwik-ui-kit` components for the UI.

### File-Specific Updates:

1.  **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/settings/customizeUI/brandPage.tsx`** (Timestamp: 16/11/2025, 13:10:34)
    *   **Functionality:** This file manages the "Brand" customization page, allowing merchants to upload a logo and select a primary theme color for the GoKwik checkout UI.
    *   **Key Updates:**
        *   Introduces state management for logo visibility (`isVisible`) and fetching/uploading merchant logos.
        *   Integrates `Form` with `useWatch` to monitor `brand_data` changes, triggering updates to the UI and `dispatch(updateBrandData)`.
        *   Includes a `validateUpload` function for file type and size restrictions (JPEG, PNG, SVG, max 2MB).
        *   Handles image cleaning, AWS S3 presigned URL generation, and logo upload.
        *   The `onFinish` handler saves brand data, including the logo path and primary color, to the merchant configuration.
        *   Visually, it displays an `InfoComponent`, `Card` for logo upload and preview, and a `ColorPicketComponent` for theme color selection.

2.  **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/library/components/discounts/productSearch.tsx`** (Timestamp: 17/11/2025, 16:22:51 and 21/11/2025, 11:48:56)
    *   **Functionality:** A reusable component for searching and selecting products or collections, primarily used in discount and shipping rule configurations.
    *   **Key Updates:**
        *   **17/11/2025, 16:22:51:** Initial robust implementation for searching products/collections with pagination, debouncing, and handling of selected items. It supports "collate products" for grouping variants and displays quantity. Introduces logic for agent-led filters (excluding 'no-agent' tagged items). `topUpGift` prop is added to enable setting an `offered_price` for gift items.
        *   **21/11/2025, 11:48:56:** Adds a `DeleteOutlined` icon to the list of imports. A new `btnSearch` prop is introduced, allowing for a full-width "Select Products/Collections" button. The display logic for variants in the search results has been refined to explicitly show "X variants selected" if `collateProducts` is true and variants exist.

3.  **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/orders/order-details/index.tsx`** (Timestamp: 17/11/2025, 16:23:04)
    *   **Functionality:** Displays detailed information for a specific order.
    *   **Key Updates:**
        *   Extensive logic for fetching and processing order data, including refunds and price breakups.
        *   Introduces `formatAmountWithCurrency` to correctly display amounts with dynamic currency symbols.
        *   Refines refund merging logic (`mergeRepeatedRefunds`) to handle multiple refund attempts and determine the final status.
        *   Enhances the UI/logic for displaying RTO (Return-to-Origin) actions and score based on merchant configuration.
        *   Adds logic to disable order editing based on applied rewards, GWP discounts, or loyalty points.
        *   Handles fetching order details using an `appName` and `codToken` for authorization, potentially indicating a separate COD app integration.

4.  **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/settings/free-gift/freeGift.tsx`** (Timestamp: 18/11/2025, 00:49:40, 18/11/2025, 00:50:14, and 18/11/2025, 00:58:39)
    *   **Functionality:** Manages the configuration of automatic free gift rules.
    *   **Key Updates:** These three timestamps show identical code, suggesting a file save without functional changes or minor, non-semantic modifications.
    *   **Content:** Implements a form (`Form.useForm`) to define free gift rules with fields like name, sales channels (App, Web, Agent-led), purchase type (cart value, quantity), min/max value, applicability (all products, specific products/collections), free gift quantity/price, and application method (auto/selection).
    *   Uses `ProductSearch` for selecting specific products or collections.
    *   Displays existing rules in a `Table` with actions for editing and deleting.
    *   The `handleEdit` function conditionally filters "shopify_agent" from sales channels if the application method is not "auto".

5.  **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/library/components/orderConfirmationPage/collapseFields.tsx`** (Timestamp: 18/11/2025, 23:42:52)
    *   **Functionality:** A component for customizing various sections of the order confirmation page using a collapsable interface.
    *   **Key Updates:** Introduces draggable `Collapse` items for Brand Logo, Dynamic Banners, Trust Banner, Order Details, Customer Information, and Support & Communication sections.
    *   Each section has a switch to enable/disable it, and some offer color pickers and input fields for customization (e.g., confirmation message, heading text, button text/link).
    *   Utilizes `LogoPage`, `RenderEditorFunction`, and `TrustBadgeForm` components for specific customization areas.

6.  **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/settings/orderConfirmation/index.tsx`** (Timestamp: 19/11/2025, 21:10:01, 19/11/2025, 21:11:54, 19/11/2025, 21:12:22, 19/11/2025, 21:12:29)
    *   **Functionality:** The main page for configuring the custom order confirmation page, including a live preview.
    *   **Key Updates:** These multiple timestamps show minor adjustments to the `flex` properties of `Col` components (`flex='1 1 200px'`, `flex='0 1 500px'` changed to `flex='1 1 300px'`, `flex='0 1 300px'`, then back to `flex='1 1 200px'`, `flex='0 1 500px'`, and again to `flex='1 1 300px'`, `flex='0 1 500px'`). These changes likely adjust the width distribution between the settings form and the preview panel, indicating iterative layout refinements.
    *   **Content:** Provides an `Alert` message about redirecting to a custom page. It uses `MainSection` (which contains `CustomizeUiFields`) for the main form and `OrderConfirmationPreview` for displaying the changes. Includes `InfoComponent` for guidance and a "Save Changes" button, enabled when the form values change. `handleFormSubmit` validates fields and logs `formFields`.

7.  **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/library/components/shipping/shippingBasedData.tsx`** (Timestamp: 20/11/2025, 18:44:34, 20/11/2025, 18:44:55, 20/11/2025, 18:49:44, 20/11/2025, 18:49:50)
    *   **Functionality:** Manages product-based shipping rules.
    *   **Key Updates:**
        *   **20/11/2025, 18:44:34 & 20/11/2025, 18:44:55:** The `Rule price` field's `type` attribute was changed from `inputNumber` to `input`, suggesting a change in how price input is handled, possibly to allow non-numeric or more flexible input, though the `type='number'` in `inputProps` and the validation rules remain.
        *   **20/11/2025, 18:49:44 & 20/11/2025, 18:49:50:** A `onKeyPress` handler was added to the `Rule price` input field to restrict input to only numbers and periods (`.`), ensuring numeric values while using `type='input'`.
    *   **Content:** Uses `ProductSearch` to add products or collections to a shipping rule. It displays selected items in a table. Rules include name, price, mapped shipping ID, calculation method (override/add-on), price multiplier, and combination with weight-based shipping.

8.  **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/library/utilities/helpers/helper.ts`** (Timestamp: 21/11/2025, 11:50:18 and 21/11/2025, 11:51:40)
    *   **Functionality:** A utility file containing helper functions for various common tasks.
    *   **Key Updates:** No functional changes were observed between these two timestamps, implying minor non-semantic edits or just file saves.
    *   **Content:** Contains functions for dynamic search filters, date formatting, currency formatting (`formatAmount`, `setCurrencySymbol`), Shopify app checkout status, deep object comparison, debouncing, date/time disabling for pickers, string capitalization, number formatting, extracting table column titles/data indexes, sorting data, CSV upload for cohorts (phone/email validation), getting future dates, comparing array fields, and checking date ranges.

### Patterns and Recurring Elements:

*   **Ant Design (gokwik-ui-kit):** Extensive use of Ant Design components like `Form`, `Button`, `Card`, `Col`, `Row`, `Upload`, `Switch`, `Table`, `Input`, `InputNumber`, `Radio`, `Dropdown`, `Tooltip`, `Alert`, `Collapse` throughout the dashboard UI files. This indicates a consistent UI framework.
*   **Form Management:** The `Form.useForm()` hook and `Form.useWatch()` are frequently used for local state management and reactive form updates. `onFinish` handlers are consistently used for form submission logic.
*   **API Interactions:** `makeAPICall` and `makeAWSPutCall` (for AWS S3) are standard utilities for interacting with backend services. `APIEndPoints` are used for API URL consistency.
*   **Merchant Configuration:** `useMerchantConfigApi` hook is a recurring element for fetching and saving merchant-specific configurations, demonstrating a centralized approach to settings management.
*   **Redux for State Management:** `useAppDispatch` and `useSelector` indicate the use of Redux for global state, particularly for user details (`getMerchantDetails`, `updatedLogoData`).
*   **Utility Helpers:** Frequent imports from `@library/utilities/helpers/helper` and `@gokwik/utilities` for common tasks like breadcrumbs, image processing, date formatting, and data manipulation.
*   **Component Reusability:** `ProductSearch` and `RenderField` are examples of reusable components integrated across different settings pages (discounts, shipping, free gifts). `ColorPickerHelper` is another example.
*   **UI Customization Focus:** A significant portion of the changes revolves around giving merchants granular control over their checkout UI, including branding, order confirmation details, and various banners.
*   **Layout Structure:** `Row` and `Col` from Ant Design are consistently used for creating responsive layouts, often with `flex` properties for dynamic sizing, especially noticeable in the `orderConfirmation` page for splitting content and preview.
*   **Error Handling:** `message.error` is used for displaying user-friendly error messages, primarily after API calls or validation failures.
*   **Timestamp Pattern:** Most changes occurred between 16/11/2025 and 21/11/2025, indicating active development within this timeframe. There are multiple, closely timed updates to the same files (e.g., `freeGift.tsx`, `orderConfirmation/index.tsx`, `shippingBasedData.tsx`), suggesting rapid iterations or minor adjustments/saves during development.

## 17:05:27
The provided log details changes across multiple files in a `checkout-dashboard-ui` and `dashboard-ui-configuration` project, primarily focusing on UI customization, discount management, order details, and environment configurations.

**File-Specific Updates:**

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/settings/customizeUI/brandPage.tsx` (16/11/2025, 13:10:34):**
    *   This file handles brand UI customization, specifically logo and primary color settings.
    *   It imports various UI components (Button, Upload, Form, ColorPicker, Card, Alert, InfoComponent) from `gokwik-ui-kit` and custom libraries.
    *   Key functionalities include:
        *   Fetching and displaying the merchant's current logo.
        *   Uploading new logos with validation for file type (jpeg, png, svg) and size (under 2MB).
        *   Using AWS S3 pre-signed URLs for logo uploads.
        *   Setting and saving primary brand colors via a `ColorPicketComponent`.
        *   Updating user and customize-ui stores with logo and brand data.
        *   Includes an `InfoComponent` linking to Confluence documentation for the "Brand Section".

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/library/components/discounts/productSearch.tsx` (17/11/2025, 16:22:51 & 21/11/2025, 11:48:56):**
    *   This component provides a reusable product/collection search functionality for discount configurations.
    *   **17/11/2025, 16:22:51:**
        *   Initial implementation for searching Shopify products or collections.
        *   Supports pagination with an `IntersectionObserver` for infinite scrolling.
        *   Handles product variants and collection-specific quantity logic.
        *   Introduces `isAgentLed` prop to filter items based on tags (e.g., exclude 'no-agent' items).
        *   Includes UI for adding/removing items, adjusting quantities, and an optional `topUpGift` price input.
    *   **21/11/2025, 11:48:56:**
        *   Added a `DeleteOutlined` icon to the imported `gokwik-ui-kit` components.
        *   Introduced a new `btnSearch` prop to conditionally render a full-width "Select Products/Collections" button, enhancing UX for certain use cases.
        *   Refined the display of product variants: `collateProducts` now explicitly checks `product?.variants?.length` before displaying "variants selected".
        *   Modified `handleQuantityChange` logic to update collection quantity only if `collectionMinimumPurchangeQuantity` is true.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/orders/order-details/index.tsx` (17/11/2025, 16:23:04):**
    *   Manages the display of order details, including status, pricing, customer information, and refunds.
    *   Imports various UI components and utility functions for API calls, permissions, and event logging.
    *   Features:
        *   Dynamic fetching of order details based on URL parameters.
        *   Currency formatting with a custom `setCurrencySymbol` and `formatAmountWithCurrency` function to handle different symbols.
        *   Merging repeated refunds to display attempts.
        *   Conditional display of RTO (Return to Origin) actions based on merchant configuration.
        *   Logic to disable "Edit Order" for orders with Twid rewards, GWP discounts, or Loyalty Points.
        *   Masking of customer phone number and email for privacy.
        *   Calculation of total discounts, taxes, shipping/COD charges, and gift card/rewards totals.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/settings/free-gift/freeGift.tsx` (18/11/2025, 00:49:40, 00:50:14, 00:58:39):**
    *   This component manages the configuration of "Free Gift" rules for merchants.
    *   The content remains largely identical across these three timestamps, indicating minor, likely non-functional, saves or formatting changes.
    *   Functionality includes:
        *   Setting up free gift rules with parameters like name, sales channels (app, web, agent-led), purchase type (cart value, quantity), min/max values, applicable products/collections, free gift quantity/price, and application method (auto/selection).
        *   Uses `ProductSearch` for selecting specific products or collections.
        *   Displays a table of existing free gift rules with options to enable/disable, edit, and delete them.
        *   Uses `useMerchantConfigApi` hook to save configuration.
        *   Includes breadcrumb updates for navigation.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/library/components/orderConfirmationPage/collapseFields.tsx` (18/11/2025, 23:42:52):**
    *   Defines collapsible sections for customizing the order confirmation UI.
    *   Sections include Brand Logo, Dynamic Banners, Trust Banner, Order Details, Customer Information, and Support & Communication.
    *   Each section allows enabling/disabling via a `Switch` and contains fields for customization (e.g., text, colors).
    *   Introduces draggable functionality for `Collapse` items, allowing users to reorder the sections.
    *   Utilizes `ColorPickerHelper` and `RenderEditorFunction` for UI element styling and content editing.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/settings/orderConfirmation/index.tsx` (19/11/2025, 21:10:01, 21:11:54, 21:12:22, 21:12:29):**
    *   Manages the overall "Order Confirmation Page" settings.
    *   **19/11/2025, 21:10:01:**
        *   Provides a toggle to enable/disable the custom order confirmation page.
        *   Includes an `Alert` message advising to reapply Shopify customizations.
        *   Layout with two columns: one for form settings and one for a preview.
        *   `handleFormSubmit` includes logic to validate fields, excluding specific `trust_banner_data` fields.
        *   Uses `MainSection` component for the primary form content.
        *   Initial flex value for the form column is `1 1 200px` and for the preview column is `0 1 500px`.
    *   **19/11/2025, 21:11:54:**
        *   Adjusted the flex values for the two columns: form column changed to `1 1 300px` and preview column to `0 1 300px`. This makes the form section slightly wider and the preview section narrower.
    *   **19/11/2025, 21:12:22:**
        *   Reverted flex values back to `1 1 200px` for the form column and `0 1 500px` for the preview column, matching the 21:10:01 version.
    *   **19/11/2025, 21:12:29:**
        *   Re-adjusted flex values: form column to `1 1 300px` and preview column to `0 1 500px`. This keeps the form section wider than the initial state, but gives more space to the preview compared to 21:11:54.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/library/components/shipping/shippingBasedData.tsx` (20/11/2025, 18:44:34, 18:44:55, 18:49:44, 18:49:50):**
    *   This component handles product/collection-based shipping rules.
    *   **20/11/2025, 18:44:34 & 18:44:55:**
        *   Implements a `processProductBasedShippingData` function to manage shipping rules.
        *   Allows mapping rules to existing shipping IDs.
        *   Configures calculation methods (override/add onto base shipping), price multiplier, and combination with weight-based shipping.
        *   Uses `ProductSearch` to add specific products/collections to rules, with checks to prevent adding similar items.
        *   Displays added items in a table with delete functionality.
        *   **A specific change in 18:44:55** is that the `price` field type changed from `inputNumber` to `input`.
    *   **20/11/2025, 18:49:44 & 18:49:50:**
        *   The `price` input field now includes an `onKeyPress` event handler to ensure only numbers and dots (`.`) are entered, reinforcing numeric input validation despite being type `input`.
        *   Again, these two timestamps contain identical code, suggesting minor, non-functional saves.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/library/utilities/helpers/helper.ts` (21/11/2025, 11:50:18 & 11:51:40):**
    *   A utility file containing various helper functions.
    *   The content is identical across both timestamps, indicating no functional changes.
    *   Functions include:
        *   `getDynamicSearchFilters`: Creates dynamic filter options.
        *   `formatDateString`: Formats date strings.
        *   `setCurrencySymbol` and `formatAmount`: Manages global currency symbol and formats amounts (replacing 'T' with 'K' in numbers for 'compact' notation, though the comment suggests it works for any symbol).
        *   `shopifyAppCheckoutEnabledStatus`: Checks if Shopify app checkout is enabled based on last login date.
        *   `deepCompare`: Performs a deep comparison of two objects, with special handling for 'pincodes' arrays.
        *   `debounce`: A utility function to debounce function calls.
        *   `disabledBeforeDate`, `disabledBeforeTime`: Helper functions for date/time picker restrictions.
        *   `capitalizeFirstLetter`: Capitalizes the first letter of a string or all words.
        *   `formatNumber`: Formats numbers.
        *   `extractTitlesAndDataIndexes`: Extracts titles and data indexes from Ant Design table columns (handling JSX titles).
        *   `sortDataByKey`: Sorts an array of objects by a nested key path.
        *   `uploadCohortCsv`: Uploads and validates CSV files for cohorts (phone numbers or emails).
        *   `getFutureDateString`: Returns a formatted future date string.
        *   `compareAndCaptureArrayFields`: Compares two arrays of objects by their 'id' to find added and removed items.
        *   `areBothRangesMoreThanOneDay`: Checks if two date ranges are both longer than one day.
        *   `extractUniqueCKeysForAntColumn`: Extracts unique keys for Ant Design table columns from trend data.
        *   `disabledDate`, `disabledTime`: General date/time disabling logic.

**Patterns and Recurring Elements:**

1.  **Gokwik UI Kit & Utilities:** Almost all `.tsx` files heavily rely on `gokwik-ui-kit` components for consistent UI and `@gokwik/utilities` for common helper functions (e.g., `makeAPICall`, `updateBreadcrumbs`).
2.  **Merchant Configuration:** The `useMerchantConfigApi` hook is frequently used (`BrandPage.tsx`, `FreeGift.tsx`) to manage and save merchant-specific configurations, indicating a centralized system for customizing merchant experiences.
3.  **Form Management:** Ant Design's `Form` component and `Form.useForm()` hook are consistently used for managing form states, validation, and field values. `Form.useWatch` is common for reacting to form value changes.
4.  **Product/Collection Search:** The `ProductSearch` component is a recurring element (`FreeGift.tsx`, `shippingBasedData.tsx`), highlighting the need to select specific products or collections for various settings (discounts, shipping rules). It supports filtering, pagination, and various display options.
5.  **UI Customization:** There's a strong focus on allowing merchants to customize their UI, including branding (logo, colors), order confirmation pages (layout, content, colors), and discount/shipping rule presentation. Color pickers and toggle switches for enabling/disabling features are common.
6.  **Environment Configuration (`.env` & `index.ejs`):** The `.env` files (timestamps 18/11, 20/11, 21/11) show changes in which environment (`dev`, `qa`, `sandbox`, `prod`) is active for API endpoints, by commenting/uncommenting lines. The `index.ejs` file (timestamps 18/11, 20/11, 21/11) repeatedly defines SystemJS import maps, dynamically loading different `@gokwik` micro-frontend applications based on the `deployedEnv` variable (local, dev, qa, sandbox, production). This indicates a micro-frontend architecture for the dashboard.
7.  **New Relic Integration:** The `index.ejs` files include substantial New Relic Browser Agent configuration, indicating a focus on performance monitoring and error tracking across different deployment environments.
8.  **Consistent Timestamp Patterns:** The timestamps for `/checkout-dashboard-ui/src/pages/settings/free-gift/freeGift.tsx`, `/checkout-dashboard-ui/src/pages/settings/orderConfirmation/index.tsx`, and `/checkout-dashboard-ui/src/library/components/shipping/shippingBasedData.tsx` show multiple changes within a very short timeframe (seconds to minutes), suggesting active development, minor adjustments, or repeated saves. The `.env` and `index.ejs` changes also occur close together, typically when switching environments.

## 18:05:28
The changes across the provided files indicate ongoing development primarily focused on the Gokwik checkout dashboard UI, with significant updates to settings, order details, and UI customization components. There's also evidence of environment configuration changes.

### File-Specific Updates:

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/settings/customizeUI/brandPage.tsx`** (Timestamp: 16/11/2025, 13:10:34)
    *   This file, responsible for the brand customization page, received updates to its logo upload functionality and API interactions.
    *   It now includes logic to check for an existing logo, fetch pre-signed URLs for AWS S3 uploads, and update logo data in the Redux store.
    *   Validation for image types (JPEG, PNG, SVG) and size (under 2MB) has been added.
    *   The `onFinish` handler was modified to delete `logo` and `logoImg` from `formField.brand_data` before saving the configuration and to dispatch `updatedLogoData` after a successful logo update.
    *   The form's `onValuesChange` prop is used to control a `isVisible` state, likely to enable/disable the "Save Changes" button based on form edits.
    *   The UI now explicitly includes an `InfoComponent` with a link to a Confluence page for "Brand Section" documentation.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/library/components/discounts/productSearch.tsx`** (Timestamp: 17/11/2025, 16:22:51 and 21/11/2025, 11:48:56)
    *   **17/11/2025, 16:22:51**: This component handles searching for products or collections for discounts.
        *   The `parseResponse` function was updated to better handle product mapping and variant aggregation, especially when `collateProducts` is enabled. It now tracks `totalVariants` and `minPrice` for collated products.
        *   The `setItemsToAdd` logic was refined for handling product quantities.
        *   `handleQuantityChange` was updated to incorporate `collectionSpecificData?.collectionMinimumPurchangeQuantity` and `collectionQuantity` for validation.
        *   The rendering logic for product display was updated to conditionally show variant details and quantity.
        *   A `handleGiftPrice` function was added for "top-up gift" scenarios, allowing the user to specify an `offered_price`.
    *   **21/11/2025, 11:48:56**: Further changes were made to the `ProductSearch` component.
        *   A new prop `btnSearch` was added, which, when true, renders a "Select products/collections" button that opens the search modal, in addition to the existing input field click.
        *   `DeleteOutlined` import was added, but not visibly used in the provided diff snippet.
        *   The display of selected product variants was refined; it now shows "X variants selected" only if `product?.variants?.length` is truthy, otherwise, it shows `product?.variant_name`.
        *   The `handleQuantityChange` now explicitly only applies `quantity: newQuantityValue` if `collectionSpecificData?.collectionMinimumPurchangeQuantity` is true, ensuring conditional updates.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/orders/order-details/index.tsx`** (Timestamp: 17/11/2025, 16:23:04)
    *   This file focuses on displaying order details.
    *   The `formatAmountWithCurrency` function was added, overriding the default `formatAmount` to specifically prepend the currency symbol obtained from `orderData` or `merchantDetails`.
    *   The `statusMappingForColors` and `statusMappingForTag` objects were defined for consistent UI rendering of order statuses.
    *   A `mergeRepeatedRefunds` function was introduced to aggregate multiple refund attempts for a single `gokwik_rid` into a single entry, determining its final status based on `bank_status`.
    *   The logic to set refund button state (`refundBtnState`) was refined, including handling for `ybl` payment provider timeouts and store credits.
    *   The `total_discount`, `tax`, `shipping_and_cod_charges`, and `gift_card_and_rewards` calculations within `setOrderData` were made more comprehensive, pulling from various price breakup properties.
    *   `setEditTitle` function was added to dynamically set the title and disable editing based on rewards, GWP discounts, or loyalty points.

*   **`/Users/mayuresh.madav/Documents/dashboard/dashboard-ui-configuration/src/index.ejs`** (Timestamp: 18/11/2025, 00:45:31, 20/11/2025, 18:37:48, and 21/11/2025, 12:27:47)
    *   Multiple updates to this EJS template for the dashboard UI configuration show changes in the environment-specific import maps.
    *   Specifically, the URLs for `@gokwik/utilities`, `@gokwik/dashboard`, `@gokwik/payment`, `@gokwik/kwikpass`, `@gokwik/rto`, `@gokwik/kwikship`, `@gokwik/ellora`, `@gokwik/checkout-platform`, and `@gokwik/shopify-app` are being adjusted based on the `deployedEnv` (local, dev, qa, sandbox).
    *   There are no functional changes to the EJS template content itself, only the URLs being served.
    *   The `sandbox` environment's `@gokwik/utilities` and `@gokwik/dashboard` URLs were changed from `sandbox-dashboard.dev.gokwik.in` to `qa-dashboard.dev.gokwik.in` and then back to `sandbox-dashboard.dev.gokwik.in` in the latest entry for local environment. This indicates environment shuffling or testing across different deployment stages for these specific modules.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/settings/free-gift/freeGift.tsx`** (Timestamp: 18/11/2025, 00:49:40, 18/11/2025, 00:50:14, and 18/11/2025, 00:58:39)
    *   Multiple identical changes (or very minor, non-functional re-saves) were observed for this file on the same day.
    *   This component manages free gift rules.
    *   A `handleEdit` function was added to set form fields with values of an item to be edited and to filter out `shopify_agent` from `sales_channels` if the `application_method` is not 'auto'.
    *   A `handleDelete` function was added to remove a rule from `newGift` state.
    *   `handleAddFreeGiftProduct` and `handleRemoveFreeGiftProduct` functions were introduced to manage the selection of free gift products, including checks for duplicate variants.
    *   `handleAddApplicableOnItems` seems to be part of an incomplete or truncated change, as its body is cut off.
    *   The `fields` array for the form was updated to include a `description` for sales channels and to explicitly disable the 'Agent led' option if `applicationMethod` is not 'auto'.
    *   The logic for the `selection_limit` field was enhanced to be conditionally hidden/required based on `applicationMethod`.
    *   The `columns` definition for the `Table` component was updated to include a "status" column with a `Switch` for enabling/disabling rules and an "actions" column with a `Dropdown` for edit and delete actions.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/library/components/orderConfirmationPage/collapseFields.tsx`** (Timestamp: 18/11/2025, 23:42:52)
    *   This component defines collapsible sections for customizing the order confirmation UI.
    *   It introduces `orderDetailFields`, `customerInformationFields`, and `supportDetailFields` arrays, each containing form fields (switches, inputs, color pickers) for various sections of the order confirmation page.
    *   Color picker integration (`ColorPickerHelper`) is seen for background and text colors of different UI sections.
    *   The component now allows reordering of collapse items via drag-and-drop functionality, handling the update of form values accordingly.
    *   `LogoPage`, `RenderEditorFunction` (for dynamic banners), and `TrustBadgeForm` components are integrated within the collapsible items.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/settings/orderConfirmation/index.tsx`** (Timestamp: 19/11/2025, 21:10:01, 19/11/2025, 21:11:54, 19/11/2025, 21:12:22, and 19/11/2025, 21:12:29)
    *   Multiple identical changes (or very minor, non-functional re-saves) were observed for this file on the same day.
    *   This page configures the custom order confirmation page.
    *   The layout was adjusted from `flex='1 1 200px'` to `flex='1 1 300px'` for the main content column and `flex='0 1 500px'` to `flex='0 1 300px'` (and back to `500px`) for the preview column. This indicates adjustments to the responsive layout for the settings page.
    *   The `handleFormSubmit` function includes logic to validate form fields while excluding specific fields related to `trust_banner_data`.
    *   An `Alert` component was added to inform users about redirection to a custom confirmation page and the need to reapply Shopify customizations.
    *   Integration of `MainSection` and `OrderConfirmationPreview` components is present, suggesting a live preview of the customizations.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/library/components/shipping/shippingBasedData.tsx`** (Timestamp: 20/11/2025, 18:44:34, 20/11/2025, 18:44:55, 20/11/2025, 18:49:44, and 20/11/2025, 18:49:50)
    *   Multiple identical changes (or very minor, non-functional re-saves) were observed for this file on the same day.
    *   This component handles product-based shipping rules.
    *   The `itemColumnData` now includes a delete button (`DeleteFilled`) for removing selected products/collections from the rule.
    *   The logic for `onAdd` and `onRemove` callbacks for `ProductSearch` was refined to manage `variant_ids` and `collection_ids` in the form state and update `itemsData`, including validation for similar product variants/collections.
    *   A `onKeyPress` event handler was added to the "Rule price" `Input` field to restrict input to numbers and periods only, which was previously an `inputNumber` type, suggesting a change in input field type.
    *   `previousShippingData` state variable was added, but not used in the visible code.
    *   The `dataMapperForItems` function was updated to correctly map product and collection data.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/library/utilities/helpers/helper.ts`** (Timestamp: 21/11/2025, 11:50:18 and 21/11/2025, 11:51:40)
    *   Two identical changes (or very minor, non-functional re-saves) were observed for this file on the same day.
    *   The file contains a collection of helper functions.
    *   The `formatAmount` function now includes a `notation` parameter, allowing for 'standard', 'scientific', 'engineering', or 'compact' number formatting, and explicitly replaces 'T' with 'K' in the formatted string.
    *   New helper functions `capitalizeFirstLetter`, `formatNumber`, `extractTitlesAndDataIndexes`, `sortDataByKey`, `uploadCohortCsv`, `getFutureDateString`, `compareAndCaptureArrayFields`, `areBothRangesMoreThanOneDay`, and `extractUniqueCKeysForAntColumn` were added or updated. These functions cover string manipulation, data formatting, table column processing, sorting, CSV file handling for cohorts, date calculations, and array comparison.

### Timestamps of Significant Changes:

*   **16/11/2025, 13:10:34**: Major feature development for brand page logo and theme customization.
*   **17/11/2025, 16:22:51**: Significant enhancements to product/collection search logic in discounts component.
*   **17/11/2025, 16:23:04**: Extensive updates to order details page, including currency formatting, refund merging, and dynamic edit controls.
*   **18/11/2025, 00:45:31**: Environment configuration updates in `index.ejs`.
*   **18/11/2025, 00:49:40 - 18/11/2025, 00:58:39**: Multiple saves/minor changes to free gift settings, indicating active development of rule management, including edit/delete functionality and product/collection selection.
*   **18/11/2025, 23:42:52**: Introduction of modular and reorderable UI customization fields for the order confirmation page.
*   **19/11/2025, 21:10:01 - 19/11/2025, 21:12:29**: Layout adjustments and form submission logic refinement for the order confirmation page.
*   **20/11/2025, 18:37:48**: Further environment configuration updates in `index.ejs`, specifically reverting `sandbox` environment URLs for `@gokwik/utilities` and `@gokwik/dashboard` to their sandbox-specific domain if deployed locally.
*   **20/11/2025, 18:44:34 - 20/11/2025, 18:49:50**: Iterative changes to shipping based data component, focusing on product/collection selection and input validation.
*   **21/11/2025, 11:48:56**: Additional feature (button search) and display refinements for product search.
*   **21/11/2025, 11:50:18 - 21/11/2025, 11:51:40**: Introduction of numerous new utility helper functions.
*   **21/11/2025, 12:27:47**: Another environment configuration update in `index.ejs`, reverting the `sandbox` URLs in the local environment block to `sandbox-dashboard.dev.gokwik.in`.

### Patterns and Recurring Elements:

*   **UI Customization and Configuration**: A significant portion of the changes revolves around UI customization, especially for brand appearance (`brandPage.tsx`) and the order confirmation page (`orderConfirmationPage/collapseFields.tsx`, `orderConfirmation/index.tsx`). This includes dynamic form field rendering (`RenderField`), color pickers (`ColorPickerHelper`), and management of banners and trust badges.
*   **Form Management**: Ant Design's `Form` component (`Form.useForm()`, `Form.useWatch()`, `form.setFieldValue()`, `form.validateFields()`) is consistently used across multiple pages (`brandPage.tsx`, `freeGift.tsx`, `orderConfirmation/index.tsx`, `shippingBasedData.tsx`) for managing complex form states and user inputs.
*   **Product/Collection Selection**: The `ProductSearch` component is a recurring element (`productSearch.tsx`, `freeGift.tsx`, `shippingBasedData.tsx`), indicating a pattern of needing to select specific products or collections for various settings (discounts, free gifts, shipping rules). This component has been refined to handle variants, quantities, and agent-led conditions.
*   **API Interactions**: Calls to `makeAPICall` and `makeAWSPutCall` are common for fetching and saving data, particularly for merchant configuration and image uploads.
*   **Redux for State Management**: `useAppDispatch` and `useSelector` hooks suggest the use of Redux for global state management (e.g., `updatedLogoData` in `brandPage.tsx`).
*   **Utility Functions**: There's a strong emphasis on helper functions (`helper.ts`) for common tasks like date formatting, number formatting, string manipulation, CSV processing, and deep object comparison, suggesting a well-structured utility layer.
*   **Environment Configuration**: Repeated updates to `index.ejs` across different timestamps indicate frequent deployment and testing across `dev`, `qa`, and `sandbox` environments, with specific module URLs being managed for each. The `sandbox` URLs in `index.ejs` for local development appear to fluctuate between `qa-dashboard` and `sandbox-dashboard` domains.
*   **Iterative Refinements**: Multiple files (e.g., `productSearch.tsx`, `freeGift.tsx`, `orderConfirmation/index.tsx`, `shippingBasedData.tsx`, `helper.ts`) have several entries on the same or consecutive days, often with identical or very minor code changes. This suggests an iterative development process, possibly involving frequent saves, small adjustments, or re-formatting.

## 19:05:26
### File-Specific Updates:

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/settings/customizeUI/brandPage.tsx`** (Timestamp: 16/11/2025, 13:10:34)
    *   This file, likely a React component for brand UI customization, handles logo uploads and primary color selection.
    *   **Key changes:** Added functionality to fetch, validate, upload (to AWS S3 via presigned URL), and display merchant logos. Implemented image cleaning using a canvas before upload. The component integrates with Redux for state management and an API hook for merchant configuration.
    *   Includes form management with Ant Design (`gokwik-ui-kit`'s `Form`) and updates the brand data in the store on form changes.
    *   Introduces an `InfoComponent` linking to a Jira wiki page for documentation.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/library/components/discounts/productSearch.tsx`** (Timestamp: 17/11/2025, 16:22:51 & 21/11/2025, 11:48:56)
    *   This React component facilitates searching and selecting products or collections for discounts/gifts.
    *   **17/11/2025, 16:22:51**: Initial implementation or significant update to handle product/collection search, quantity management, and adding/removing items. It supports collating products by ID, filtering for agent-led items, and managing collection-specific quantities. A modal is used for search results with infinite scrolling via `useIntersectionObserver`.
    *   **21/11/2025, 11:48:56**: Added a new prop `btnSearch` to allow displaying a dedicated "Select [products/collections]" button, providing an alternative trigger to the input field. Also, the display logic for selected variants when `collateProducts` is true was refined to show "X variants selected". A `DeleteOutlined` icon was added to the import list but not explicitly used in the provided code snippet for this timestamp.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/orders/order-details/index.tsx`** (Timestamp: 17/11/2025, 16:23:04)
    *   This file defines the Order Details page, displaying comprehensive information about a customer's order.
    *   **Key changes:**
        *   Enhanced currency formatting: introduced `formatCurrency` and `formatAmountWithCurrency` to correctly display amounts with dynamic currency symbols, overriding the default `formatAmount`.
        *   Improved refund status mapping: `statusMappingForColors` and `statusMappingForTag` were added, along with `mergeRepeatedRefunds` logic to combine multiple refund attempts for a single `gokwik_rid` into a `MergedRepeatedRefund` with an `attempts` count and a determined final status (Completed, Failed, Initiated).
        *   Updated refund button logic: `refundBtnState` now dynamically disables the refund button and calculates `refundableAmount` based on transaction statuses and existing refunds.
        *   Added `setEditTitle` function to determine and set the title and disable state for order editing based on applied rewards, GWP discounts, or loyalty points.
        *   Refined `fetchOrderDetails` to handle `appName` and `codToken` for authorization headers and process `price_breakup` data to calculate `total_discount`, `tax`, `shipping_and_cod_charges`, and `gift_card_and_rewards`.

*   **`/Users/mayuresh.madav/Documents/dashboard/dashboard-ui-configuration/src/index.ejs`** (Timestamp: 18/11/2025, 00:45:31 & 20/11/2025, 18:37:48 & 21/11/2025, 12:27:47)
    *   This EJS template is the entry point for the dashboard UI, managing script imports and environment-specific configurations.
    *   **Pattern:** Multiple timestamps show similar changes: A section of inline JavaScript for New Relic (NREUM) is present, followed by configuration for different deployment environments (`local`, `dev`, `qa`, `sandbox`, `production`) using `systemjs-importmap`.
    *   The `systemjs-importmap` section for `local`, `dev`, `qa`, and `sandbox` environments defines mappings for various `@gokwik/*` micro-frontend modules.
    *   **Specific Changes:**
        *   **18/11/2025, 00:45:31**: In the `sandbox` environment's `systemjs-importmap`, the `@gokwik/utilities` and `@gokwik/dashboard` URLs were set to `https://sandbox-dashboard.dev.gokwik.in`. `@gokwik/payment`, `@gokwik/kwikpass`, `@gokwik/rto`, `@gokwik/kwikship`, `@gokwik/ellora`, `@gokwik/checkout-platform`, and `@gokwik/shopify-app` were pointed to `https://qa-dashboard.dev.gokwik.in`. This indicates a mixed environment setup for sandbox.
        *   **20/11/2025, 18:37:48**: In the `local` environment's `systemjs-importmap`, `@gokwik/utilities` and `@gokwik/dashboard` URLs were updated to `https://qa-dashboard.dev.gokwik.in`. This change shifts local development to use QA dashboard assets for these modules. The other `@gokwik/*` modules remained pointing to QA.
        *   **21/11/2025, 12:27:47**: In the `local` environment's `systemjs-importmap`, `@gokwik/utilities` and `@gokwik/dashboard` URLs were reverted back to `https://sandbox-dashboard.dev.gokwik.in`. This indicates a rollback or adjustment to the local development environment configuration.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/settings/free-gift/freeGift.tsx`** (Timestamp: 18/11/2025, 00:49:40, 18/11/2025, 00:50:14, & 18/11/2025, 00:58:39)
    *   This React component manages the Free Gift settings page, allowing merchants to configure free gift rules.
    *   **Pattern:** The content of this file is identical across all three timestamps. This suggests multiple save operations without functional changes or potentially reverting to the same state.
    *   **Key features:**
        *   Manages free gift rules, including rule name, sales channels (app, web, agent-led), purchase requirements (cart value, quantity), applicability (all products, specific products/collections), free gift quantity and price, and application method (auto/selection).
        *   Uses `ProductSearch` for selecting free gift products or specific products/collections for applicability.
        *   Includes a table to display existing rules with options to enable/disable, edit, and delete them.
        *   Integrates with `useMerchantConfigApi` for saving and refetching configuration.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/library/components/orderConfirmationPage/collapseFields.tsx`** (Timestamp: 18/11/2025, 23:42:52)
    *   This component renders a collapsible list of customizable fields for the order confirmation page.
    *   **Key changes:** Organizes customization options into collapsible sections: "Brand Logo Customization," "Dynamic Banners," "TrustBanner," "Order Details," "Customer Information," and "Support & Communication." Each section contains switches to enable/disable functionality, input fields for text, and `ColorPickerHelper` components for background/text colors.
    *   Introduces drag-and-drop functionality for reordering the collapsible sections using `draggable` attributes and `onDragStart`, `onDragOver`, `onDrop` event handlers.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/settings/orderConfirmation/index.tsx`** (Timestamp: 19/11/2025, 21:10:01, 19/11/2025, 21:11:54, 19/11/2025, 21:12:22, & 19/11/2025, 21:12:29)
    *   This is the main page for configuring the custom order confirmation page.
    *   **Pattern:** Multiple updates with minor layout adjustments.
    *   **Specific Changes:**
        *   **19/11/2025, 21:10:01**: Initial layout with two main columns: one for form fields and one for a preview (`OrderConfirmationPreview`). The form column has a `flex` property of `'1 1 200px'`.
        *   **19/11/2025, 21:11:54**: The `flex` property for the form column was changed to `'1 1 300px'`, and for the preview column to `'0 1 300px'`. This adjusts the width distribution, giving more space to the form and less to the preview.
        *   **19/11/2025, 21:12:22**: The `flex` property for the form column was reverted to `'1 1 200px'`, and for the preview column to `'0 1 500px'`. This likely expands the preview area significantly.
        *   **19/11/2025, 21:12:29**: The `flex` property for the form column was again changed to `'1 1 300px'`, and for the preview column to `'0 1 500px'`. This seems to be a final adjustment, giving more balanced width distribution to the form while still providing ample space for the preview.
    *   **General functionality:** Includes an `InfoComponent`, a "Save Changes" button (disabled until changes are made), and uses an Ant Design `Form` with `initialValuesForThankYouPageForm`. It has an "Enable Custom Order Confirmation Page" switch and an `Alert` message.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/library/components/shipping/shippingBasedData.tsx`** (Timestamp: 20/11/2025, 18:44:34, 20/11/2025, 18:44:55, 20/11/2025, 18:49:44, & 20/11/2025, 18:49:50)
    *   This component manages product-based shipping rules.
    *   **Specific Changes:**
        *   **20/11/2025, 18:44:34**: The `price` field in the form was initially an `inputNumber` type.
        *   **20/11/2025, 18:44:55**: The `price` field type was changed from `inputNumber` to `input`. This suggests a change in how price input is handled, possibly allowing non-numeric input temporarily or expecting string validation.
        *   **20/11/2025, 18:49:44**: A `onKeyPress` event handler was added to the `price` input field, explicitly preventing non-numeric and non-decimal point characters (`/[0-9.]$/`) from being entered. This reinforces that the price should be numeric, even if the `type` is `input`.
        *   **20/11/2025, 18:49:50**: No functional change was observed compared to the previous timestamp; the code appears identical.
    *   **Key functionality:** Displays product-based shipping rules in a table, with options to edit and delete. Provides a form for adding/editing rules, including rule name, price, mapping to an existing shipping ID, calculation method (override/add), price multiplier, and combination with weight-based shipping. Uses `ProductSearch` to add products or collections to a rule.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/library/utilities/helpers/helper.ts`** (Timestamp: 21/11/2025, 11:50:18 & 21/11/2025, 11:51:40)
    *   This file contains various utility helper functions.
    *   **Pattern:** The content is identical across both timestamps, indicating no functional changes were made between these two saves.
    *   **Key functions:**
        *   `getDynamicSearchFilters`: Creates filter options from a list of search filters.
        *   `formatDateString`: Formats a raw date string into a readable format.
        *   `setCurrencySymbol` and `formatAmount`: Manages and formats currency amounts with a global symbol.
        *   `shopifyAppCheckoutEnabledStatus`: Checks if a Shopify app checkout is enabled based on the last login date.
        *   `deepCompare`: Performs a deep comparison of two objects.
        *   `debounce`: A utility for debouncing function calls.
        *   `disabledBeforeDate` and `disabledBeforeTime`: Helpers for date/time picker disabling logic.
        *   `capitalizeFirstLetter`: Capitalizes text.
        *   `formatNumber`: Formats numbers.
        *   `extractTitlesAndDataIndexes`: Extracts titles and data indexes from Ant Design table columns.
        *   `sortDataByKey`: Sorts an array of objects by a key path.
        *   `uploadCohortCsv`: Handles CSV file uploads for cohorts, validating for phone numbers or emails.
        *   `getFutureDateString`: Returns a future date string.
        *   `compareAndCaptureArrayFields`: Compares two arrays of objects and identifies added/removed items.
        *   `areBothRangesMoreThanOneDay`: Checks if two date ranges are both longer than one day.
        *   `extractUniqueCKeysForAntColumn`: Extracts unique keys for Ant Design table columns from trend data.
        *   `disabledDate` and `disabledTime`: General date/time disabling helpers.

### Patterns and Recurring Elements:

1.  **Ant Design (`gokwik-ui-kit`) Usage:** The dashboard UI heavily relies on Ant Design components like `Form`, `Button`, `Input`, `InputNumber`, `Switch`, `Table`, `Card`, `Dropdown`, `message`, `Tooltip`, `Alert`, `Col`, `Row`, and `Collapse`. This indicates a consistent UI library choice and component-based development.
2.  **Form Management:** React's `useState`, `useEffect`, `useMemo`, and `useRef` hooks are extensively used for component state, lifecycle, memoization, and direct DOM interaction, especially with Ant Design's `Form.useForm()` and `Form.useWatch()` for handling form data and changes.
3.  **API Integration:** Calls to `makeAPICall` and `makeAWSPutCall` are common for data fetching and submission. `APIEndPoints` are used to centralize API routes.
4.  **Redux Integration:** `useSelector` and `useAppDispatch` indicate Redux is used for global state management (e.g., `getMerchantDetails`, `updatedLogoData`, `updateBrandData`).
5.  **Custom Hooks:** Custom hooks like `useMerchantConfigApi` and `useIntersectionObserver` abstract common logic, promoting reusability and cleaner components.
6.  **Environment Configuration:** The `index.ejs` file consistently uses `systemjs-importmap` to define module URLs based on the `deployedEnv` variable (`isLocal`, `dev`, `qa`, `sandbox`, `production`), allowing easy switching between environments for micro-frontend module loading.
7.  **Date and Time Utilities:** The `helper.ts` file shows a strong emphasis on date and time manipulation, formatting, and validation using `dayjs`, indicating a need for precise date handling throughout the application.
8.  **Search and Selection Components:** The `ProductSearch` component is a recurring element, used in multiple settings pages (Free Gift, Shipping) for selecting specific products or collections, demonstrating a standardized approach for item selection.
9.  **Breadcrumbs:** `updateBreadcrumbs` from `@gokwik/utilities` is used to maintain navigation context, suggesting a consistent breadcrumb system across the dashboard.
10. **Minor Incremental Changes:** Many files show multiple, closely-timed updates (especially `freeGift.tsx`, `orderConfirmation/index.tsx`, `shippingBasedData.tsx`). This indicates active development with frequent saves or small, iterative refinements to the UI and logic. In some cases, the content remained identical across multiple timestamps, suggesting a save operation without code changes.
11. **URL References:** Links to `gokwik.atlassian.net/wiki` are present in `InfoComponent`s, suggesting a practice of linking directly to internal documentation for features.

## 20:05:28
The following summarizes the code changes by file, highlighting significant updates and recurring patterns.

### File-Specific Updates:

#### 1. `/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/settings/customizeUI/brandPage.tsx`
*   **Timestamp:** 16/11/2025, 13:10:34
*   **Key Changes:**
    *   Adds comprehensive functionality for customizing a brand page, focusing on logo and primary color settings.
    *   Includes image upload handling (`handleUpload`, `validateUpload`, `cleanImageWithCanvas`, `getBase64`) with API calls for presigned URLs and AWS S3 uploads.
    *   Implements `useEffect` hooks to fetch merchant details (logo) and custom configuration (primary color) on component mount or config updates.
    *   Uses `Form.useWatch` to track changes in `brand_data` and dispatches `updateBrandData` on changes.
    *   The `onFinish` function handles saving logo paths to the merchant and custom configuration.
    *   The UI (`return` statement) renders a form with sections for logo upload and color picking, utilizing `gokwik-ui-kit` components like `Button`, `Col`, `Row`, `Upload`, `Form`, `Card`, and `ColorPicker`. It also includes an `InfoComponent` for guidance.

#### 2. `/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/library/components/discounts/productSearch.tsx`
*   **Timestamps:**
    *   17/11/2025, 16:22:51
    *   21/11/2025, 11:48:56 (Minor update)
*   **Key Changes:**
    *   **Initial Update (17/11):** This component enables searching and selecting Shopify products or collections for discount configurations.
        *   Manages loading states, pagination (`useIntersectionObserver`), and debounced search input.
        *   Handles adding/removing items to a temporary selection (`itemsToAdd`) within a modal.
        *   Includes logic for collating product variants and managing quantities, with specific handling for agent-led scenarios and top-up gifts.
        *   The UI displays existing selected items, a search input, and a modal for searching and selecting new items.
    *   **Subsequent Update (21/11):** A minor change introducing a `DeleteOutlined` icon import and a new `btnSearch` prop to render a "Select products/collections" button explicitly. The rendering logic for selected product variants was also updated to explicitly check `product?.variants?.length`.

#### 3. `/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/orders/order-details/index.tsx`
*   **Timestamp:** 17/11/2025, 16:23:04
*   **Key Changes:**
    *   Focuses on displaying detailed order information.
    *   Imports various UI components (`Button`, `Col`, `Row`, `Divider`, `Table`, `Tabs`, `Tag`, `Tooltip`, etc.) from `gokwik-ui-kit`.
    *   Uses `useParams`, `useLocation`, `useSearchParams`, `useNavigate` from `react-router-dom` for routing and state management.
    *   Fetches order details using `makeAPICall` to specific API endpoints.
    *   Includes logic for formatting currency (`formatCurrency`, `formatAmountWithCurrency`, `setCurrencySymbol`) and merging repeated refunds (`mergeRepeatedRefunds`).
    *   Calculates and displays a detailed price breakup (discount, tax, shipping, gift card, etc.).
    *   Determines refund button state (`refundBtnState`) based on transaction statuses and refundable amounts.
    *   Handles setting `disableEdit` and `title` for the edit order button based on applied rewards, GWP discounts, or loyalty points.
    *   Conditional rendering for RTO actions and scores based on merchant configuration.

#### 4. `/Users/mayuresh.madav/Documents/dashboard/dashboard-ui-configuration/src/index.ejs`
*   **Timestamps:**
    *   18/11/2025, 00:45:31
    *   20/11/2025, 18:37:48
    *   21/11/2025, 12:27:47
*   **Key Changes:**
    *   This is an EJS template file configuring a single-spa application, primarily defining import maps for various `@gokwik` micro-frontends (configuration, utilities, dashboard, checkout, payment, kwikpass, rto, kwikship, ellora, checkout-platform, shopify-app, kwikcomm).
    *   **Consistent Structure:** The core structure of the HTML, meta tags (charset, viewport, CSP), and shared dependencies (React, React-DOM, single-spa) remains consistent across all timestamps.
    *   **Environment-Specific Imports:** The import URLs for `@gokwik` packages change based on `isLocal`, `deployedEnv` (dev, qa, sandbox, production) variables.
    *   **Specific Changes:**
        *   **18/11 (Sandbox focus):** `@gokwik/utilities` and `@gokwik/dashboard` point to `sandbox-dashboard.dev.gokwik.in` for `isLocal` environment, while other packages like `@gokwik/payment`, `@gokwik/kwikpass`, etc., point to `qa-dashboard.dev.gokwik.in`. The sandbox `deployedEnv` block also points to `sandbox-dashboard.dev.gokwik.in` for all packages.
        *   **20/11 (QA focus):** The `isLocal` environment now points `@gokwik/utilities` and `@gokwik/dashboard` to `qa-dashboard.dev.gokwik.in`. The `qa` `deployedEnv` block also consistently points to `qa-dashboard.dev.gokwik.in` for all packages.
        *   **21/11 (Sandbox focus again):** The `isLocal` environment reverted to pointing `@gokwik/utilities` and `@gokwik/dashboard` to `sandbox-dashboard.dev.gokwik.in`. The `sandbox` `deployedEnv` block consistently points to `sandbox-dashboard.dev.gokwik.in`.
    *   **New Relic and Clarity:** Includes New Relic browser monitoring script and Microsoft Clarity analytics script for the `production` environment, consistently present across all timestamps.

#### 5. `/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/settings/free-gift/freeGift.tsx`
*   **Timestamps:**
    *   18/11/2025, 00:49:40
    *   18/11/2025, 00:50:14
    *   18/11/2025, 00:58:39
*   **Key Changes:**
    *   This component manages "Free Gift Settings" through a form and table interface.
    *   **Consistent Functionality:** Across all timestamps, the component uses `Form.useForm`, `useState`, `useEffect`, `useMerchantConfigApi` for state management, form handling, and API interactions.
    *   **Form Fields:** Defines a consistent set of form fields (`fields` array) for creating/editing free gift rules, including rule name, sales channels, purchase type (cart value/quantity), min/max value, applicability (all products, specific products, specific collections), free gift product selection, quantity, price, and application method (auto/selection).
    *   **Product/Collection Search Integration:** Integrates `ProductSearch` component for selecting specific products or collections for the free gift rule, handling `onAdd` and `onRemove` logic to update form fields.
    *   **Table Display:** Renders a table (`columns`) to display existing free gift rules, with actions for enabling/disabling, editing, and deleting rules using a `Dropdown`.
    *   **Minor Content Updates (not functional):** The code content for these timestamps is virtually identical, suggesting minor re-saves or formatting changes without functional alterations. The breadcrumbs are also consistently updated.

#### 6. `/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/library/components/orderConfirmationPage/collapseFields.tsx`
*   **Timestamp:** 18/11/2025, 23:42:52
*   **Key Changes:**
    *   Introduces a collapsable UI component (`Collapse`) for customizing various sections of the order confirmation page.
    *   Each collapse item represents a customizable section: "Brand Logo Customization" (`LogoPage`), "Dynamic Banners" (`RenderEditorFunction`), "TrustBanner" (`TrustBadgeForm`), "Order Details", "Customer Information", and "Support & Communication".
    *   For "Order Details", "Customer Information", and "Support & Communication", it defines arrays of form fields (using `RenderField` and `ColorPickerHelper`) that include switches for enabling/disabling sections, input fields for text (e.g., confirmation message, heading, description, button text, button link), and color pickers for background and text colors.
    *   Uses `Form.useWatch` to conditionally hide/show fields based on the `enabled` state of their parent section.
    *   Implements drag-and-drop functionality for reordering the collapse items (`draggable`, `onDragStart`, `onDrop`).

#### 7. `/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/settings/orderConfirmation/index.tsx`
*   **Timestamps:**
    *   19/11/2025, 21:10:01
    *   19/11/2025, 21:11:54
    *   19/11/2025, 21:12:22
    *   19/11/2025, 21:12:29
*   **Key Changes:**
    *   This component provides the main interface for customizing the order confirmation page, displaying both a form for settings and a preview.
    *   **Consistent Structure:** All timestamps show a two-column layout (`Row`, `Col`) using `gokwik-ui-kit` components. The left column contains the form for settings, and the right column displays an `OrderConfirmationPreview`.
    *   **Form Definition:** Defines initial form fields, including a switch to enable the custom page and an `Alert` explaining its impact. It includes a `MainSection` component (likely where `collapseFields.tsx` is used).
    *   **Form Submission Logic:** The `handleFormSubmit` function validates form fields, specifically excluding `trust_text` and `trust_tag` from validation, and logs the form values.
    *   **State Management:** Uses `useState` for `changed` to enable/disable the "Save Changes" button based on form modifications.
    *   **Minor Layout Adjustments:**
        *   The timestamp `19/11/2025, 21:10:01` sets `Col` flex properties to `'1 1 200px'` for the form section and `'0 1 500px'` for the preview.
        *   The timestamp `19/11/2025, 21:11:54` changes the form section to `'1 1 300px'` and the preview to `'0 1 300px'`.
        *   The timestamp `19/11/2025, 21:12:22` reverts the `Col` flex properties back to the original `21:10:01` values (form `'1 1 200px'`, preview `'0 1 500px'`).
        *   The timestamp `19/11/2025, 21:12:29` again changes the form section to `'1 1 300px'` and the preview to `'0 1 500px'`. These indicate minor UI layout experimentation or adjustments.

#### 8. `/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/library/components/shipping/shippingBasedData.tsx`
*   **Timestamps:**
    *   20/11/2025, 18:44:34
    *   20/11/2025, 18:44:55
    *   20/11/2025, 18:49:44
    *   20/11/2025, 18:49:50
*   **Key Changes:**
    *   This component manages product-based shipping rules, allowing users to define shipping prices based on specific products or collections.
    *   **Consistent Functionality:** Uses `useState`, `useMemo`, `Dropdown`, `Table`, `ProductSearch`, and `Form` for managing shipping rules, selected items, and rendering UI.
    *   **Rule Configuration:** Defines form fields (`fields` array) for `rule name`, `rule price`, `shipping ID mapping`, `calculation method` (override/add), `price multiplier`, and `combine with weight based shipping`.
    *   **Product/Collection Selection:** Integrates `ProductSearch` components to add products (with variant handling) and collections to a rule. It includes validation to prevent adding similar product variants or collections.
    *   **Display of Selected Items:** Displays selected products and collections in a `Table` with an option to remove them.
    *   **Shipping ID Mapping:** Uses `useMemo` to generate options for mapping rules to existing shipping IDs, accounting for already used IDs.
    *   **Minor `rule price` Input Type Change:**
        *   The initial timestamp `20/11/2025, 18:44:34` uses `type: 'inputNumber'` for 'Rule price'.
        *   The timestamp `20/11/2025, 18:44:55` changes it to `type: 'input'` without explicit `onKeyPress` for number validation.
        *   The timestamp `20/11/2025, 18:49:44` and `20/11/2025, 18:49:50` revert it to `type: 'input'` but add an `onKeyPress` event handler to explicitly allow only `[0-9.]$` characters, thus re-introducing number-like input behavior while keeping it a text input.

#### 9. `/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/library/utilities/helpers/helper.ts`
*   **Timestamps:**
    *   21/11/2025, 11:50:18
    *   21/11/2025, 11:51:40
*   **Key Changes:**
    *   This file contains various utility functions for formatting, validation, and data manipulation.
    *   **Consistent Utility Functions:** Includes `getDynamicSearchFilters`, `formatDateString`, `setCurrencySymbol`, `formatAmount`, `shopifyAppCheckoutEnabledStatus`, `deepCompare`, `debounce`, `disabledBeforeDate`, `disabledBeforeTime`, `capitalizeFirstLetter`, `formatNumber`, `extractTitlesAndDataIndexes`, `sortDataByKey`, `uploadCohortCsv`, `getFutureDateString`, `compareAndCaptureArrayFields`, `areBothRangesMoreThanOneDay`, `extractUniqueCKeysForAntColumn`, `disabledDate`, and `disabledTime`.
    *   **No Functional Differences:** The code content is identical across both timestamps, indicating re-saves or minor non-functional changes like whitespace or comment adjustments if any.

### Patterns and Recurring Elements:

*   **Gokwik-UI-Kit:** All React components extensively use `gokwik-ui-kit` for UI elements (Button, Form, Card, Table, Input, Switch, Dropdown, etc.), indicating a standardized component library.
*   **Form Management:** React's `Form.useForm()` and `Form.useWatch()` are consistently used for managing form state, field values, and conditional rendering.
*   **API Interactions:** `makeAPICall`, `makeAWSPutCall` (from `@gokwik/utilities`) and `useMerchantConfigApi` (custom hook) are common patterns for data fetching and saving configurations.
*   **Redux for State Management:** `useAppDispatch` and `useSelector` (from `react-redux`) are used in several components to interact with the Redux store for user and customization data.
*   **Breadcrumbs:** `updateBreadcrumbs` from `@gokwik/utilities` is used to manage navigation breadcrumbs across different pages.
*   **Product/Collection Selection:** The `ProductSearch` component is a recurring element for selecting specific products or collections, especially in discount and shipping rule configurations. This pattern allows for consistent item selection across different features.
*   **Customization via Configuration:** Multiple pages (`brandPage.tsx`, `freeGift.tsx`, `orderConfirmation/index.tsx`, `orderConfirmationPage/collapseFields.tsx`, `shippingBasedData.tsx`) deal with merchant-specific configuration, often stored and retrieved via `useMerchantConfigApi`. This highlights a focus on configurable UI and features.
*   **Conditional Rendering:** Logic based on feature flags, enabled switches, or application methods (`if` statements, `hidden` props) is prevalent for displaying relevant UI sections.
*   **Error Handling:** `message.error` from `gokwik-ui-kit` is commonly used for displaying user feedback on API failures or validation errors.
*   **Date and Time Utilities:** The `helper.ts` file provides several utility functions related to `dayjs` for date and time manipulation, disabling dates, and formatting, used across the application.
*   **Environment-Specific Configuration:** The `index.ejs` file demonstrates a clear pattern of dynamically loading micro-frontend bundles based on the `deployedEnv` variable (local, dev, qa, sandbox, production), ensuring the correct versions of micro-frontends are used for each environment.

## 21:05:25
The provided log details changes across several frontend application files, primarily within a "checkout-dashboard-ui" project and a "dashboard-ui-configuration" project. The changes span from November 16 to November 21, 2025.

### File-Specific Updates:

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/settings/customizeUI/brandPage.tsx` (16/11/2025, 13:10:34)**:
    *   This file, representing a "Brand Page" for UI customization, underwent significant updates.
    *   It now includes functionality for uploading and managing merchant logos, fetching pre-signed AWS URLs for image uploads, and updating logo data in the Redux store.
    *   Validation logic for image uploads (file type and size) has been implemented.
    *   The component integrates `ColorPickerComponent` for primary color customization and `InfoComponent` for displaying help links and descriptions.
    *   Form fields for `brand_data` (logo, primaryColor) are handled using Ant Design's `Form` and `Form.useWatch`.
    *   API calls (`makeAPICall`, `makeAWSPutCall`) are used for logo management and saving configuration.
    *   The `onFinish` handler processes logo uploads and updates merchant custom configuration, specifically `cssRules.primaryColor` and `offers_fixed_positions`.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/library/components/discounts/productSearch.tsx` (17/11/2025, 16:22:51 and 21/11/2025, 11:48:56)**:
    *   This `ProductSearch` component is used for searching and selecting products or collections, likely for discount or gift configurations.
    *   **Initial Update (17/11/2025)**: Included logic for handling `topUpGift` and `collectionSpecificData`, which involves setting quantities and minimum purchase requirements for collections. It added `handleGiftPrice` for managing offered prices for gift items.
    *   **Subsequent Update (21/11/2025)**: Introduced a new `btnSearch` prop, which, when true, renders a "Select products/collections" button that triggers the modal. It also slightly refined how `variants selected` text is displayed based on `collateProducts`. It added `DeleteOutlined` icon import.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/orders/order-details/index.tsx` (17/11/2025, 16:23:04)**:
    *   This file focuses on displaying detailed information for an order.
    *   It introduces a `formatAmountWithCurrency` helper to correctly format currency values with a dynamic symbol, overriding the default `formatAmount` function.
    *   A `mergeRepeatedRefunds` function is added to consolidate multiple refund attempts for the same `gokwik_rid` into a single entry, showing the primary refund status and attempt count.
    *   Logic for setting the edit order title and disabling edit functionality based on applied rewards, GWP discounts, or loyalty points has been implemented.
    *   Order data fetching now uses `sessionStorage` for `appName` and `codToken` for authorization headers.
    *   Refund button state (disabled status, refund status, refundable amount) is calculated based on transactions and merged refunds.
    *   The price breakup calculation is updated to aggregate various discount types (ABCDiscount, C2PDiscount, paymentOffer, loyaltyPoints, prepaidDiscount, agentDiscount, shopifyDiscounts, automaticDiscounts, customDiscount) and separate shipping/COD charges, gift cards, and rewards.

*   **`/Users/mayuresh.madav/Documents/dashboard/dashboard-ui-configuration/src/index.ejs` (18/11/2025, 00:45:31, 20/11/2025, 18:37:48, and 21/11/2025, 12:27:47)**:
    *   This is an EJS template for the dashboard UI configuration, mainly handling `systemjs-importmap` for different deployment environments (`isLocal`, `dev`, `qa`, `sandbox`, `production`).
    *   **18/11/2025**: The New Relic Browser Agent snippet (minified JavaScript) was added for production deployments, indicating the integration of application performance monitoring.
    *   **20/11/2025 & 21/11/2025**: The import maps for `@gokwik/utilities` and `@gokwik/dashboard` in the `isLocal` environment were changed. They were pointing to `https://sandbox-dashboard.dev.gokwik.in/` in the 18/11/2025 log, then changed to `https://qa-dashboard.dev.gokwik.in/` in the 20/11/2025 log, and then reverted to `https://sandbox-dashboard.dev.gokwik.in/` in the 21/11/2025 log. This suggests changes in local development environment's dependency resolution or testing targets.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/settings/free-gift/freeGift.tsx` (18/11/2025, 00:49:40, 18/11/2025, 00:50:14, and 18/11/2025, 00:58:39)**:
    *   This component manages "Free Gift Settings."
    *   Multiple identical timestamps suggest these are minor save operations or reformatting without functional changes between them.
    *   The file uses `ProductSearch` for selecting free gift products and `useMerchantConfigApi` for configuration management.
    *   It defines a form for creating and managing free gift rules, including fields for rule name, sales channels (with `shopify_agent` being disabled if `applicationMethod` is not 'auto'), purchase requirements (cart value or quantity), min/max values, applicability (all products, specific products, specific collections), free product selection, quantity, price, and application method (auto or selection).
    *   A table displays existing free gift rules, with options to edit or delete them. `Switch` component controls rule enablement.
    *   The `handleEdit` function now filters `shopify_agent` from `sales_channels` if the application method is not 'auto'.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/library/components/orderConfirmationPage/collapseFields.tsx` (18/11/2025, 23:42:52)**:
    *   This file defines a set of collapsible form fields for customizing the order confirmation UI.
    *   It includes sections for "Brand Logo Customization" (using `LogoPage`), "Dynamic Banners" (using `RenderEditorFunction`), "TrustBanner" (using `TrustBadgeForm`), "Order Details", "Customer Information", and "Support & Communication".
    *   Each section has a `Switch` to enable/disable the feature, and some include `ColorPickerHelper` for background and text color customization.
    *   Fields such as "Confirmation Message", "Heading Text", "Description", "Button Text", and "Button Link" are provided with character limits.
    *   The component also implements drag-and-drop reordering for the collapsible items.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/settings/orderConfirmation/index.tsx` (19/11/2025, 21:10:01, 19/11/2025, 21:11:54, 19/11/2025, 21:12:22, and 19/11/2025, 21:12:29)**:
    *   This component represents the "Order Confirmation Page" settings.
    *   Multiple identical timestamps (with slight `Col` flex value changes between them, then reverted) suggest minor layout adjustments or re-saves during development.
    *   It includes a switch to enable a custom order confirmation page and an `Alert` explaining its implications (redirects customers, requires re-applying Shopify customizations).
    *   It integrates `MainSection` for the main customization forms and `OrderConfirmationPreview` for real-time visualization.
    *   The `handleFormSubmit` function validates fields, specifically excluding `trust_text` and `trust_tag` from 'appearance.trust_banner_data' before validation.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/library/components/shipping/shippingBasedData.tsx` (20/11/2025, 18:44:34, 20/11/2025, 18:44:55, 20/11/2025, 18:49:44, and 20/11/2025, 18:49:50)**:
    *   This component manages product-based shipping rules.
    *   Similar to `freeGift.tsx`, the multiple identical timestamps for this file suggest minor save operations or reformatting.
    *   The `processProductBasedShippingData` function is central, defining state for `itemsData` (selected products/collections) and `previousShippingData`.
    *   It maps existing shipping rules to a `tableData` structure.
    *   `dataMapperForItems` standardizes the format of product/collection items.
    *   `selectedOptions` memoizes available shipping IDs, considering already used ones.
    *   Form fields allow defining rule name, price, mapping to a shipping ID, calculation method (override/add), price multiplier, and combination with weight-based shipping.
    *   Includes `ProductSearch` for adding products and collections to a rule. The `onAdd` logic checks for duplicate product variants/collections and updates form fields and local state.
    *   An `Input` field for 'Rule price' (`['product_based_rules', 0, 'price']`) was changed from `inputNumber` to `input` with a `onKeyPress` validator to only allow numbers and periods (20/11/2025, 18:49:44).

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/library/utilities/helpers/helper.ts` (21/11/2025, 11:50:18 and 21/11/2025, 11:51:40)**:
    *   This utility file contains various helper functions.
    *   **Initial Update (21/11/2025, 11:50:18)**: No discernable functional changes, appears to be a re-save or minor cosmetic adjustment.
    *   **Subsequent Update (21/11/2025, 11:51:40)**: No discernable functional changes, appears to be a re-save or minor cosmetic adjustment.
    *   The file includes functions for dynamic search filters, date formatting, currency symbol management (`setCurrencySymbol`, `formatAmount`), Shopify app checkout status, deep object comparison, debouncing, date/time disabling for pickers, string capitalization, number formatting, extracting table column titles/data indexes, sorting data, uploading CSV cohorts, getting future dates, and comparing array fields.
    *   The `formatAmount` function explicitly uses `Intl.NumberFormat('en-IN', { style: 'decimal', ... })` and prepends `currentCurrencySymbol`.

### Timestamps of Significant Changes:

*   **16/11/2025, 13:10:34**: Major updates to `brandPage.tsx` for logo and UI theme customization.
*   **17/11/2025, 16:22:51**: Functional enhancements to `productSearch.tsx` for gift and collection-specific data.
*   **17/11/2025, 16:23:04**: Significant logic additions to `order-details/index.tsx` for refund merging, currency formatting, and order edit conditions.
*   **18/11/2025, 00:45:31**: Integration of New Relic Browser Agent into `dashboard-ui-configuration/src/index.ejs` for production.
*   **18/11/2025, 23:42:52**: Comprehensive new features for Order Confirmation Page UI customization in `collapseFields.tsx`.
*   **19/11/2025, 21:10:01 - 21:12:29**: Multiple small adjustments to `orderConfirmation/index.tsx`, likely related to layout or minor fixes.
*   **20/11/2025, 18:49:44**: Type change for 'Rule price' input and addition of `onKeyPress` validator in `shippingBasedData.tsx`.
*   **21/11/2025, 11:48:56**: Additional `btnSearch` prop and minor display adjustments in `productSearch.tsx`.
*   **20/11/2025, 18:37:48** and **21/11/2025, 12:27:47**: Frequent changes to local development import maps in `dashboard-ui-configuration/src/index.ejs`.

### Patterns and Recurring Elements:

*   **UI Customization Focus**: A strong theme across `brandPage.tsx`, `collapseFields.tsx`, and `orderConfirmation/index.tsx` is the enhancement of UI customization capabilities for the checkout and order confirmation pages. This includes logo, color themes, banners, trust badges, and specific content sections.
*   **Form Management**: Ant Design's `Form` component is heavily utilized across multiple files (`brandPage.tsx`, `freeGift.tsx`, `orderConfirmation/index.tsx`, `collapseFields.tsx`, `shippingBasedData.tsx`) for building complex forms with validation and state management. `Form.useWatch` is a common pattern for reacting to form value changes.
*   **Data Fetching and API Interaction**: Components frequently use `makeAPICall`, `makeAWSPutCall`, and `fetchShopifyCollectionsOrProducts` for interacting with backend services and external platforms (like Shopify).
*   **Configuration Management**: The `useMerchantConfigApi` hook appears in `brandPage.tsx` and `freeGift.tsx`, indicating a centralized approach to managing merchant-specific configurations.
*   **Reusable Components**: Components like `ProductSearch`, `InfoComponent`, `RenderField`, `ColorPickerHelper`, `Switch`, and `Dropdown` are widely reused to build various features.
*   **Breadcrumbs**: `updateBreadcrumbs` from `@gokwik/utilities` is used to maintain navigation context across pages (`freeGift.tsx`, `order-details/index.tsx`).
*   **Consistent Styling**: The use of `gokwik-ui-kit` components and utility classes (e.g., `flex`, `gap-x-2`, `p-2`, `rounded-md`) suggests a consistent design system.
*   **Error Handling and Messaging**: `message.error` (from `gokwik-ui-kit`) is consistently used for user feedback on validation failures or API errors.
*   **Timestamp Proximity**: Several files have multiple, very close timestamps (e.g., `freeGift.tsx`, `orderConfirmation/index.tsx`, `shippingBasedData.tsx`). This often indicates rapid iterative development, minor code cleanups, or re-saves without significant functional changes between commits.
*   **Environment-Specific Configurations**: The `index.ejs` file demonstrates dynamic loading of dependencies and API endpoints based on the deployment environment (`isLocal`, `dev`, `qa`, `sandbox`, `production`), a common practice in multi-environment deployments.

## 22:05:27
**File: `/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/settings/customizeUI/brandPage.tsx`**
*   **Timestamp:** 16/11/2025, 13:10:34
*   **Key Changes:** This file manages the "Brand" customization page for the checkout UI. It allows merchants to upload their logo and select a primary theme color.
    *   **Logo Upload:** Implements functionality for uploading a brand logo, including validation for file type (JPG, PNG, SVG) and size (under 2MB). It uses `cleanImageWithCanvas` for image processing, `fetchUploadedLogoURL` for presigned S3 URLs, and `makeAWSPutCall` for uploading to AWS.
    *   **Color Picker:** Integrates a `ColorPicketComponent` to set the primary color for the checkout theme.
    *   **Form Management:** Uses Ant Design `Form` for managing brand data, including logo image path (`logoImg`), logo display URL (`logo`), and CSS rules (`primaryColor`).
    *   **API Interactions:** Interacts with `APIEndPoints.downloadLogo`, `APIEndPoints.presingedLogoUrl`, and `APIEndPoints.updateMerchant` to handle logo-related operations and save configuration.
    *   **State Management:** Utilizes `useState`, `useEffect`, and `useSelector` (Redux) to manage component state, merchant details, and dispatch updates to the Redux store (e.g., `updatedLogoData`, `updateBrandData`).
    *   **UI Elements:** Employs `gokwik-ui-kit` components like `Button`, `Col`, `Row`, `Upload`, `Form`, `Card`, `ColorPicker`, `Alert`, and `InfoComponent` for a structured and informative user interface.

**File: `/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/library/components/discounts/productSearch.tsx`**
*   **Timestamp:** 17/11/2025, 16:22:51 (First version in log)
*   **Timestamp:** 21/11/2025, 11:48:56 (Updated version)
*   **Key Changes (Across versions):** This component provides a generic search and selection interface for products or collections, typically used for discount or gift configurations.
    *   **Core Functionality:** Allows searching for Shopify products or collections, displaying results, and adding/removing selected items.
    *   **Infinite Scrolling:** Implements `useIntersectionObserver` for infinite scrolling of search results.
    *   **Product/Collection Handling:** Differentiates between product and collection searches, including logic to collate product variants if `collateProducts` is true.
    *   **Quantity Management:** Supports showing and updating quantities for selected items, particularly for collection-specific data.
    *   **Agent-Led Filtering:** Includes logic to filter products based on `no-agent` tags when `isAgentLed` is true.
    *   **Top-Up Gift Price:** Introduces `topUpGift` prop and related `handleGiftPrice` function to allow setting an offered price for freebie products.
    *   **UI Enhancements (21/11/2025):**
        *   Added a `DeleteOutlined` icon to `gokwik-ui-kit` imports.
        *   Introduced a new prop `btnSearch` to optionally display a "Select Products/Collections" button, providing an alternative to directly clicking the search input.
        *   Refined the display of product variants: `collateProducts` now explicitly checks `product?.variants?.length` before showing "variants selected" text.
        *   Modified `handleQuantityChange` to update quantity conditionally based on `collectionSpecificData.collectionMinimumPurchangeQuantity`.

**File: `/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/orders/order-details/index.tsx`**
*   **Timestamp:** 17/11/2025, 16:23:04
*   **Key Changes:** This file is responsible for displaying detailed information about a specific order.
    *   **Order Data Fetching:** Fetches order details using `makeAPICall` based on order ID, creation timestamp, and merchant order ID.
    *   **Refund Handling:** Implements logic to merge repeated refunds, determine refund status (`Completed`, `Failed`, `Initiated`), and calculate the refundable amount. It dynamically disables the refund button based on transaction status and amount.
    *   **Currency Formatting:** Introduces `formatCurrency` and `formatAmountWithCurrency` helper functions to display amounts with the correct currency symbol, which is dynamically fetched from `orderData` or `merchantDetails`.
    *   **UI Components:** Uses `gokwik-ui-kit` components like `Button`, `Col`, `Row`, `Divider`, `Table`, `Tabs`, `Tag`, `Tooltip`, `Popover`, `message`, and various icons to structure the order details page.
    *   **Data Display:** Organizes order information into sections like `giftCards`, `lineItemColumns`, `paymentColumns`, and `refundColumns`.
    *   **Breadcrumbs:** Updates breadcrumbs to provide navigation context.
    *   **Order Editing Logic:** Sets `disableEdit` and `title` based on the presence of rewards, specific discount types (GWP), or loyalty points, indicating whether an order can be updated.
    *   **RTO Actions:** Conditionally displays RTO (Return to Origin) related actions and scores based on merchant configuration.

**File: `/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/settings/free-gift/freeGift.tsx`**
*   **Timestamp:** 18/11/2025, 00:49:40 (First version in log)
*   **Timestamp:** 18/11/2025, 00:50:14 (Minor update)
*   **Timestamp:** 18/11/2025, 00:58:39 (Minor update)
*   **Key Changes (Across versions, content is mostly identical):** This file defines the Free Gift settings page, allowing merchants to configure rules for automatic free gifts.
    *   **Free Gift Rule Management:** Provides functionality to add, edit, and delete free gift rules.
    *   **Form Structure:** Uses Ant Design `Form` with `Form.useWatch` to track changes in various parts of the free gift configuration, such as specific products, collections, free product details, and application method.
    *   **Rule Fields:** Defines a comprehensive set of fields for a free gift rule, including name, sales channels, purchase type (cart value/quantity), min/max value, applicability (all products, specific products/collections), free gift quantity and price, and application method (auto/selection).
    *   **Product/Collection Search Integration:** Leverages the `ProductSearch` component to allow merchants to select specific products or collections for gift applicability or as the free gift itself.
    *   **Table Display:** Presents existing free gift rules in a `Table` with columns for name, free gift product, status (enabled/disabled via `Switch`), and actions (edit/delete via `Dropdown`).
    *   **Breadcrumbs:** Updates navigation breadcrumbs for the Free Gift Settings page.
    *   **State Management:** Uses `useState` for `newRules`, `newGift`, `editRuleId`, and `isChanged`, and `useMerchantConfigApi` hook for interacting with merchant configuration.

**File: `/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/library/components/orderConfirmationPage/collapseFields.tsx`**
*   **Timestamp:** 18/11/2025, 23:42:52
*   **Key Changes:** This component renders a collapsable list of customization options for the order confirmation page.
    *   **Customization Sections:** Organizes customization settings into collapsible panels: "Brand Logo Customization", "Dynamic Banners", "TrustBanner", "Order Details", "Customer Information", and "Support & Communication".
    *   **Dynamic Field Rendering:** Uses `RenderField` and `ColorPickerHelper` components to dynamically render different types of form fields (switch, input, custom color pickers) for each section.
    *   **Order Details Customization:** Allows enabling/disabling order status/EDD, confirmation message, and setting background/text colors for this section. Also includes customization for billing summary display and its colors.
    *   **Customer Information Customization:** Provides switches to enable/disable delivery address, billing address, and contact information display, along with background/text color options.
    *   **Support & Communication Customization:** Enables customization of heading text, description, button text, and button link for a support section, including color options.
    *   **Drag-and-Drop Reordering:** Implements drag-and-drop functionality for reordering the collapsible sections, demonstrating dynamic UI rearrangement.
    *   **Integration with Forms:** Fully integrates with an Ant Design `Form` instance (`form` prop) to manage and watch customization data.

**File: `/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/settings/orderConfirmation/index.tsx`**
*   **Timestamp:** 19/11/2025, 21:10:01 (First version in log)
*   **Timestamp:** 19/11/2025, 21:11:54 (Layout adjustment)
*   **Timestamp:** 19/11/2025, 21:12:22 (Layout reverted)
*   **Timestamp:** 19/11/2025, 21:12:29 (Layout adjustment)
*   **Key Changes (Across versions):** This page allows merchants to customize their order confirmation page.
    *   **Enable Custom Page:** A primary switch to enable/disable the custom order confirmation page feature, with an `Alert` explaining its implication (redirects from Shopify's page).
    *   **Form Management:** Uses Ant Design `Form` with `onValuesChange` to track changes and enable the "Save Changes" button. `initialValuesForThankYouPageForm` is used for initial state.
    *   **Sub-components:** Integrates `MainSection` (which likely contains the `CollapseFields` from the previous entry) for detailed customization and `OrderConfirmationPreview` for a visual preview.
    *   **Form Submission:** `handleFormSubmit` validates form fields, specifically excluding certain fields from required validation (e.g., trust banner text/tag).
    *   **Layout:** Uses `Row` and `Col` for a two-column layout, with the left column for settings and the right for a live preview. Flex properties (`flex='1 1 200px'` / `flex='1 1 300px'`) are adjusted for responsive layout, with changes and reverts between timestamps.

**File: `/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/library/components/shipping/shippingBasedData.tsx`**
*   **Timestamp:** 20/11/2025, 18:44:34 (First version in log)
*   **Timestamp:** 20/11/2025, 18:44:55 (Minor update)
*   **Timestamp:** 20/11/2025, 18:49:44 (Input type change)
*   **Timestamp:** 20/11/2025, 18:49:50 (Minor update)
*   **Key Changes (Across versions):** This component is designed for managing product-based shipping rules.
    *   **Shipping Rule Definition:** Allows defining shipping rules based on products or collections, including rule name, price, mapping to an existing shipping ID, and calculation method (override/add-on).
    *   **Price Multiplier & Weight Combination:** Includes switches for `price_multiplier` (for multiple quantities) and `combine_with_weight_based` shipping.
    *   **Product/Collection Selection:** Integrates `ProductSearch` for selecting specific products (variants) or collections to apply shipping rules to.
    *   **Dynamic Item Display:** `itemsData` state holds selected products/collections, which are displayed in a `Table` with options to remove them.
    *   **Form Fields:** Defines a set of `fields` for the Ant Design form, covering all aspects of a product-based shipping rule.
    *   **Validation:** Includes validation for required fields and for preventing similar product variants/collections from being added multiple times.
    *   **Data Mapping:** `dataMapperForItems` function transforms selected items into a suitable format for display.
    *   **Input Type Change (20/11/2025, 18:49:44):** The `price` field's `type` was changed from `inputNumber` to `input` and `onKeyPress` event handler was added to ensure only numeric and decimal inputs. This change allows more direct control over input handling for numerical values.
    *   **Memoization:** Uses `useMemo` for `selectedOptions` to optimize rendering of dropdown options.

**File: `/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/library/utilities/helpers/helper.ts`**
*   **Timestamp:** 21/11/2025, 11:50:18 (First version in log)
*   **Timestamp:** 21/11/2025, 11:51:40 (Minor update)
*   **Key Changes (Across versions):** This file contains various helper functions for the UI, including formatting, validation, and data manipulation.
    *   **Filter Creator:** `getDynamicSearchFilters` constructs a filter options object based on search filter configurations.
    *   **Date & Amount Formatting:** Provides `formatDateString` for consistent date display and `formatAmount` for currency formatting, which now explicitly uses `Intl.NumberFormat` with a `decimal` style and prepends a `currentCurrencySymbol`.
    *   **Currency Symbol Management:** `setCurrencySymbol` allows updating the global currency symbol.
    *   **Shopify App Checkout Status:** `shopifyAppCheckoutEnabledStatus` checks if the Shopify app checkout is enabled based on the last login date.
    *   **Deep Comparison:** `deepCompare` recursively compares two objects to detect differences, with special handling for 'pincodes' arrays.
    *   **Debouncing:** `debounce` utility function for controlling function call frequency.
    *   **Date/Time Disabling:** `disabledBeforeDate` and `disabledBeforeTime` helper functions for date pickers.
    *   **String Formatting:** `capitalizeFirstLetter` for string capitalization.
    *   **Table Utilities:** `extractTitlesAndDataIndexes` and `sortDataByKey` for manipulating table data and columns.
    *   **CSV Upload for Cohorts:** `uploadCohortCsv` handles validation and processing of CSV files containing phone numbers or emails for cohorts.
    *   **Date Manipulation:** `getFutureDateString` for generating future dates.
    *   **Array Comparison:** `compareAndCaptureArrayFields` identifies newly added and removed items between two arrays.
    *   **Date Range Validation:** `areBothRangesMoreThanOneDay` checks if two date ranges are each longer than one day.
    *   **Metric Key Extraction:** `extractUniqueCKeysForAntColumn` transforms data for Ant Design table columns based on trend data.
    *   **Timestamp 21/11/2025, 11:51:40:** No functional changes detected, likely a reformat or minor whitespace/comment change.

**Patterns and Recurring Elements:**

1.  **Gokwik-UI-Kit Usage:** All UI-related files (`brandPage.tsx`, `productSearch.tsx`, `orderDetails/index.tsx`, `freeGift.tsx`, `collapseFields.tsx`, `orderConfirmation/index.tsx`, `shippingBasedData.tsx`) heavily rely on the `@gokwik-ui-kit` library for buttons, forms, cards, tables, switches, and other UI components, ensuring a consistent look and feel across the dashboard.
2.  **Ant Design Form Integration:** `Form.useForm()` and `Form.useWatch()` are consistently used for state management within forms across various pages, facilitating data binding and validation.
3.  **Merchant Configuration API Hook:** The `useMerchantConfigApi` hook (from `@library/utilities/hooks/useMerchantConfig`) is a recurring pattern for fetching and saving merchant-specific configurations, indicating a centralized approach to managing settings.
4.  **API Call Utility:** `makeAPICall` (from `@gokwik/utilities`) is the standard way to interact with backend APIs.
5.  **Redux Integration:** `useAppDispatch` and `useSelector` (Redux) are used to manage global state, such as merchant details and logo data, reflecting a Redux-based state management strategy.
6.  **Breadcrumbs Updates:** `updateBreadcrumbs` utility is frequently called within `useEffect` hooks in page components to ensure proper navigation context.
7.  **Product/Collection Search Component:** The `ProductSearch` component is reused in multiple contexts (`freeGift.tsx`, `shippingBasedData.tsx`) to allow selection of products or collections, demonstrating component reusability.
8.  **Timestamp Consistency:** Most code changes occurred in the middle of November 2025, suggesting a period of active development and updates across different features. The `.env` and `index.ejs` files are updated with the same timestamps, indicating deployment or configuration changes across environments.
9.  **Environment Configuration:** The `.env` file consistently defines base URLs for `dev`, `qa`, `sandbox`, and `prod` environments, although specific environments are commented out or uncommented in different commits, indicating environment switching.
10. **Micro-frontend Architecture (Single-SPA):** The `index.ejs` file clearly outlines a Single-SPA architecture for the dashboard, importing various `@gokwik` applications (`@gokwik/configuration`, `@gokwik/utilities`, `@gokwik/dashboard`, `@gokwik/checkout`, etc.) based on the deployed environment (`isLocal`, `dev`, `qa`, `sandbox`, `production`). This pattern suggests a modular and scalable application structure.
11. **Helper Functions:** A dedicated `helper.ts` file consolidates common utility functions, promoting code reusability and maintainability.