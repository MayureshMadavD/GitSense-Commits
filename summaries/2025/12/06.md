# Activity Summary for 06/12/2025

## 19:08:13
The code changes primarily focus on enhancing the "Upsell On Checkout" functionality and refining UI components within the `checkout-dashboard-ui` application, alongside minor adjustments in the `dashboard-ui-configuration` setup.

### File-Specific Updates:

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/library/components/upsell/upsellCheckout.tsx`**
    *   **Timestamps:** Multiple changes observed between `03/12/2025, 23:27:39` and `04/12/2025, 11:37:15`.
    *   **Updates:**
        *   Initial changes involved frequent adjustments to the `key` prop of `Collapse` items and the `index` passed to `UpsellFormRenderer` within the `buildUpsellCollapse` function. This aimed to correctly identify and render individual upsell rules.
        *   The logic for displaying the "Rule {index + 1}" label underwent several iterations (`rules.length - 1`, `rules.length === 1 ? index + 1 : index`, `rules?.length < 1 ? index + 1 : index`, `rules?.length > 0 ? index + 1 : index`, `rules?.length || 0`). This indicates an attempt to refine how rule numbers are displayed, particularly when rules are added or there's only one rule. The final version reverts to `index + 1`.
        *   The `activeKey` state for `Collapse` was modified several times, specifically in `buildUpsellCollapse` to automatically expand the newly added rule (e.g., `setActiveKey([String(rules?.length - 1)])`, then `setActiveKey([String(rules?.length)])`, and finally `setActiveKey(['0'])` on adding a new rule or after form submission).
        *   The `position` parameter passed to `setIsModalOpen` (for delete confirmation) was also refined, with several attempts to correctly capture the index or ID of the rule being deleted.
        *   A significant change introduced `upsellEnabled = Form.useWatch(['cart_upsell', 'enabled'], form)` to conditionally hide or show the "Cap Quantity" section and the list of upsell rules, based on whether "Cart Upsell" is enabled (`04/12/2025, 00:48:47` and `04/12/2025, 00:50:07`, `04/12/2025, 00:50:33`).
        *   The "Add New Upsell Rule" button was moved to be outside the mapped `upsellItems` loop and its `onClick` handler was updated to correctly set the `activeKey` to expand the newly added rule (`04/12/2025, 00:44:38`, `04/12/2025, 11:37:15`).
        *   Imports were adjusted, adding `Alert` but removing `UpOutlined` from `gokwik-ui-kit`.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/library/components/customize-ui/richtexteditor.tsx`**
    *   **Timestamps:** Changes occurred between `04/12/2025, 01:04:54` and `04/12/2025, 01:10:35`.
    *   **Updates:**
        *   Refinement of the placeholder behavior: the default `placeholder` prop changed from 'Enter Text To Update' to an empty string (`04/12/2025, 01:05:27`).
        *   The "Field cannot be empty" validation message's styling and positioning were adjusted (e.g., `mt-[-1rem]`, and enclosing the message with a `<span>` or `<div>` to control its layout relative to the character count display). Specifically, at `04/12/2025, 01:10:35`, it's conditionally rendered in a `<span>` along with a placeholder `<div>` to maintain layout if there's no error message.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/settings/customizeUI/mobilePage.tsx`**
    *   **Timestamp:** `04/12/2025, 01:00:41`.
    *   **Updates:**
        *   Added `isUpsellCall` prop to the `MobileStepUI` component.
        *   Imported `getCustomizeUiData` selector and `updateUpsellState` action from `@store/customize-ui`.
        *   Introduced `listOfProducts` derived from `customizeUiData?.upsell_data?.upsell_product_list?.products?.data` and conditionally rendered based on `isUpsellCall`.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/library/components/discounts/productSearch.tsx`**
    *   **Timestamp:** `04/12/2025, 12:27:04`.
    *   **Updates:**
        *   Added a `topUpGift` prop.
        *   Introduced UI elements for a "Freebie price" input within the product display, specifically for `topUpGift` functionality.
        *   Modified `handleGiftPrice` to update product `offered_price`.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/library/utilities/api.ts`**
    *   **Timestamp:** `04/12/2025, 12:27:19`.
    *   **Updates:** Minor formatting changes, no functional differences compared to prior versions (based on visual inspection and context).

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/library/utilities/constants/apiEndpoints.ts`**
    *   **Timestamps:** `04/12/2025, 12:27:30` and `06/12/2025, 19:02:34`.
    *   **Updates:** No functional changes, as the content is identical across these two timestamps.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/library/utilities/helpers/helper.ts`**
    *   **Timestamp:** `04/12/2025, 12:27:58`.
    *   **Updates:** Minor formatting changes, no functional differences.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/store/customize-ui/index.ts`**
    *   **Timestamp:** `04/12/2025, 12:28:12`.
    *   **Updates:** Minor formatting changes, no functional differences.

*   **`/Users/mayuresh.madav/Documents/dashboard/dashboard-ui-configuration/src/index.ejs`**
    *   **Timestamps:** `04/12/2025, 21:49:13` and `05/12/2025, 23:32:51`.
    *   **Updates:** For local development (`isLocal` condition), the source URLs for several `@gokwik` packages (`@gokwik/utilities`, `@gokwik/dashboard`, `@gokwik/checkout-platform`, `@gokwik/shopify-app`) were updated to point to `https://sandbox-dashboard.dev.gokwik.in` instead of `https://qa-dashboard.dev.gokwik.in`. This indicates a shift in the local development environment's dependency resolution to a sandbox environment.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/library/components/upsell/upsellFormRenderer.tsx`**
    *   **Timestamps:** Multiple changes between `04/12/2025, 22:18:10` and `04/12/2025, 22:21:01`.
    *   **Updates:** The `Checkbox` component for "Configure upsell items on discount price" now includes an `onChange` handler that resets the `discount.value` and `discount.capping` to `0` when the checkbox is unchecked.

*   **`/Users/mayuresh.madav/Documents/dashboard/checkout-dashboard-ui/src/pages/settings/free-gift/freeGift.tsx`**
    *   **Timestamps:** Multiple changes between `05/12/2025, 23:41:06` and `06/12/2025, 19:07:00`.
    *   **Updates:**
        *   Introduced `fetchProductById` function to fetch product details using `APIEndPoints.getProductById`.
        *   The `ProductSearch` component for selecting "free gift products" was updated. The logic for handling `onAdd` and `onRemove` for both `applicable_items` and `free_product` within the form fields was adjusted to correctly manage product/variant/collection IDs.
        *   The `hideControlInput` property for certain form fields (like `specific_products` and `specific_collections`) was updated to dynamically hide/show based on the `giftApplicableOn` radio selection.
        *   The "Agent led" sales channel option is now conditionally disabled if `applicationMethod` is not "auto".
        *   The `max` value for `selection_limit` input was updated to dynamically reflect `freePorduct?.data?.length` or default to 5.
        *   The default `activeKey` for the Collapse components in `UpsellCheckout` was initially `['0']` but later changed to `[]` when `handleAddNewUpsellRule` is called, allowing the newly added rule to be open.

### General Patterns and Recurring Elements:

*   **UI Component Library Usage:** Heavy reliance on `gokwik-ui-kit` components for building the user interface, including forms, buttons, cards, modals, and input fields.
*   **React Hooks:** Extensive use of `useState`, `useEffect`, `useRef`, `useCallback`, `useMemo`, and `Form.useWatch` for managing component state, side effects, performance optimization, and real-time form value tracking.
*   **Form Management:** Consistent pattern of using Ant Design `Form` for data input, validation, and submission, with form values often watched to trigger UI changes or logic.
*   **API Interaction:** Standardized `makeAPICall` utility for interacting with various backend endpoints, with specific API endpoints defined in `apiEndpoints.ts`.
*   **Redux for Global State:** `react-redux` (specifically `useDispatch` and `useSelector`) is used to manage and update application-wide state, such as `updateUpsellState` for upsell configurations.
*   **Conditional Rendering:** Frequent use of conditional rendering based on state variables (e.g., `upsellEnabled`, `discountedPrice`, `activeTab`, `applicationMethod`) to show or hide parts of the UI.
*   **Error Handling:** Common patterns for displaying messages (`message.warning`, `message.error`) and logging errors (`console.error`).
*   **Dynamic Data Handling:** Logic to fetch and set dynamic data for product searches and rule configurations using IDs and types.