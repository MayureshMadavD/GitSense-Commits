# Activity Summary for 24/02/2025

## 02:10:47
The provided log shows multiple revisions to two files: `/Users/madav/Documents/checkout UI/gokwik.pdp/src/App.svelte` and `/Users/madav/Documents/checkout UI/gokwik.pdp/src/common/services/EnvironmentService.ts`.  Both files were heavily modified between 23/02/2025, 23:44:47 and 24/02/2025, 00:09:09.

`/Users/madav/Documents/checkout UI/gokwik.pdp/src/App.svelte` primarily handles the checkout UI logic.  The numerous revisions suggest iterative development and debugging. The code heavily relies on Svelte stores (`store_...`) for managing application state, indicating a reactive architecture.  These stores manage data related to user login, addresses, order details, payment options, and various flags for UI elements and features (e.g., discount banners, loading screens). There's substantial interaction with various services (e.g., `MerchantAPI`, `EventService`, `Experiment.service`), showcasing integration with backend systems for data fetching and event tracking. The code includes handling of messages from iframes (`window.addEventListener('message'`) which suggests a complex integration workflow.  The frequent changes in this file point to ongoing development and refinement of checkout processes and features.

`/Users/madav/Documents/checkout UI/gokwik.pdp/src/common/services/EnvironmentService.ts` manages environment-specific configurations.  The file was repeatedly updated,  primarily altering the URLs used for different environments (development, QA, sandbox, production).  The `api_url`, `experiment_url`, `analytics_api`, and other functions define different endpoints based on the `env` variable, which is obtained from the `LoginStore`. Multiple API endpoints for various services are defined and selected based on the current environment.  The repeated revisions indicate adjustments to API endpoints across multiple environments, potentially due to deployment changes or API updates. The changes in `setCart()` function within this file show the cart object being updated multiple times with varying numbers of items (22, 12, 5) and total prices (972800, 970800, 404500), suggesting testing or development of different scenarios. The consistent use of `'https://qa-core-api.dev.gokwik.in'` in the `local` environment setting within `api_url` might be a bug or a temporary setup for local testing.


## 11:11:37
The `/Users/madav/Documents/checkout UI/gokwik.pdp/src/App.svelte` file was updated on 24/02/2025 at 10:49:39.  This update significantly revised the Svelte component's logic, primarily focusing on checkout functionality.

The changes involve extensive use of numerous Svelte stores (`store_...`) from `./common/stores/LoginStore` and `./common/stores/CommonStore` and `./common/stores/OrderStore`, managing various aspects of the checkout process, including user information, address, payment options, order details, and discounts.  The component imports numerous other Svelte components for UI elements like address input, snackbars, headers, and various payment options screens.


The `onMount` lifecycle hook handles browser history management, preventing accidental navigation away from the checkout flow.  It also listens for `message` events, presumably from an iframe, to receive launch data containing crucial information like:

* **Merchant Information:**  `store_merchantInfo`, `store_mid`, `store_merchanturl`.
* **User Data:**  `store_isAbandonCart`, `store_phoneNo`, potentially others.
* **Payment Information:** `store_paymentLink`, `store_upiPaymentOptionsAvailable`.
* **Cart Information:** `store_cartjsObject`, `store_cartId`.
* **Environment Details:** `store_environment`, `store_isGlanceEnvironment`, `store_gaCookies`.
* **Token information:** `store_soToken`, `store_kwikpassToken`, `XGokwikToken`, `XKWIKPASSToken`.

This launch data is then used to populate the various stores and initialize the checkout process.  Error handling (`APIErrorHandling`) is implemented to manage potential issues, and various services are called (`fetchShopifyCart`, `getRequestId`, `getAbandonCart`) to fetch necessary data from the backend.

The code includes logic to handle different payment methods (UPI, net banking, card payments, BNPL), various discount calculations and applications, and interactions with different third-party services, including Webengage and potentially Shopify, as evidenced by the presence of functions like `initTracking` and calls to a Shopify API.  There's significant logic to handle cart validation, including checks for empty carts,  and managing the state of the checkout process across various screens (`store_page`).  The code also includes significant experiment tracking using stores like `store_userExperiments`.  Finally, numerous helper functions (`setViewProperties`, `setCookie`, `getCookie`, `insertGtmScript`, `getSearchParams`) are used for various tasks.


## 12:11:47
The log shows multiple updates to `/Users/madav/Documents/checkout UI/gokwik.pdp/src/common/services/EnvironmentService.ts` and `/Users/madav/Documents/checkout UI/gokwik.pdp/public/merchant.html` files between 11:16:06 and 12:06:47 on February 24, 2025.  The `EnvironmentService.ts` file primarily manages API base URLs and tokens based on the environment (dev, qa, sandbox, production, etc.).  Several `api_url` variations exist, suggesting a complex API routing strategy. The `local` environment is initially set to use a sandbox URL for `api_url`, indicating a possible default fallback.  There are several minor updates throughout the file's log entries which appear to be code cleanup and formatting changes that do not significantly alter functionality.

The `merchant.html` file defines a `gokwikSdk` object that handles communication with the Gokwik SDK and includes merchant information (mid, appid, appsecret) hardcoded which should be handled securely in a different way.  It also incorporates cookie management for tracking landing page and referrer data.  The `window.merchantInfo` object contains various merchant identifiers (mids) commented out, possibly for testing different merchant configurations.  The commented-out analytics script suggests a potential shift to a different analytics platform.  No functional changes are visible in the log entries for this file beyond the initial log entry.

The `/Users/madav/Documents/checkout UI/gokwik.pdp/src/Components/place-order/PaymentOptions/PaymentButton.svelte` file undergoes several revisions between 11:25:20 and 11:28:37 on February 24, 2025.  These changes appear focused on refining the logic for handling payment button visibility and functionality, particularly concerning A/B testing variations for Snapmint and Bharatx button display.  The `shouldHideBnpl` function incorporates multiple experimental variants, impacting visibility based on risk level and UPI availability. A `console.log` statement is added at the end of one revision, possibly for debugging purposes.

The `/Users/madav/Documents/checkout UI/gokwik.pdp/src/Components/place-order/UpiCollect/UpiCollect.svelte` file is updated at 11:32:22. This file manages UPI collection payment flows and shows minor updates to the code functionality.

Finally, `/Users/madav/Documents/checkout UI/gokwik.pdp/src/common/stores/OrderStore.ts` is updated at 11:53:57 and the `/Users/madav/Documents/checkout UI/gokwik.pdp/src/App.svelte` file is updated multiple times between 11:54:30 and 12:10:26 on February 24, 2025. These files contain extensive updates to the state management and event handling within the application. The `App.svelte` file handles the main application logic, including initialization, communication with the Gokwik SDK, and routing based on the application's state.  The updates in both files show extensive changes relating to various features,  including handling of different payment methods, order statuses, and discount application logic.  The `onMount` function in `App.svelte` demonstrates a significant portion of the applicationâ€™s setup, including handling of cart data, API calls for request IDs, discount application and other crucial initialization steps.  The addition and updates to store subscriptions indicate a highly reactive application architecture.  Several commented-out code sections and changes related to A/B testing are evident in this file's numerous revisions. The `Helper.service.ts` file receives updates at 12:04:24 and 12:06:47, focusing on utility functions for address management, bottom sheet handling, and other helper functionalities.  The `MobilePhoneInput.svelte` file is also updated at 12:06:57, managing the mobile phone input field and associated actions.


Overall, the log reflects an iterative development process involving multiple components and features, with a strong emphasis on robust error handling and A/B testing for various UI elements and payment flows.  The updates in the `App.svelte` file particularly showcase a complex and well-structured application workflow.


## 13:11:49
The log shows multiple updates to the `/Users/madav/Documents/checkout UI/gokwik.pdp` project on February 24, 2025.  The most significant changes revolve around the `App.svelte` component and the `MobilePhoneInput.svelte` component, with several minor modifications to the `Helper.service.ts` file in both the `src` and `merchant` directories.


`/Users/madav/Documents/checkout UI/gokwik.pdp/src/App.svelte`: This file undergoes multiple revisions between 12:12:58 and 12:29:34.  These revisions primarily involve additions and deletions within the `window.addEventListener('message', async (gokwikEvent: AppMessageEvent) => { ... }` block.  The changes focus on handling incoming `gokwikEvent` data, particularly processing the cart object (`cartObject`), handling token management (using `localStorage` and `cookies`), managing various application stores, and conditional logic for empty carts and abandoned carts.  The consistent theme across these changes is enhancing the checkout flow's robustness, error handling, and data management.


`/Users/madav/Documents/checkout UI/gokwik.pdp/src/Components/login/MobilePhoneInput.svelte`:  This component is updated twice, at 12:15:12 and 12:15:49, then again at 12:23:49 and 12:51:01. The core functionality remains consistent: handling phone number input, validation, and submission.  The changes primarily involve refining the handling of gift card rewards (`store_giftCardRewards`), updating various application stores after successful phone number submission, and improving the logic for handling `skip_to_payment` and address suggestion flows.  The `callPhoneAPI` function is consistently modified to reflect changes in data handling and store updates.


`/Users/madav/Documents/checkout UI/gokwik.pdp/src/common/services/Helper.service.ts`: This service file experiences multiple updates throughout the log, mostly between 12:16:01 and 12:50:43. These changes involve enhancements to various helper functions such as `setAddress`, `closeBottomSheet`, `setCreateOrderStores`, and others. The primary focus is to improve data management, error handling, and the general utility functions related to the checkout process. The inclusion of `triggerOTPView` at 12:27:08 indicates that OTP handling is integrated with the helper service.  The consistency here lies in the ongoing refinement of functions that support the core checkout flow.


`/Users/madav/Documents/checkout UI/gokwik.pdp/src/merchant/services/Helper.service.ts`:  Similar to its counterpart in the `src` directory, this file (updated at 12:17:10, 12:20:40, 12:20:45, 12:24:11, and 12:26:25) receives updates focused on helper functions specific to the merchant context. This includes functions for cookie management, checking the Android environment, and verifying merchant health (`checkMerchantHealth`). There is significant consistency in the cookie handling and environment detection functions across these updates.

In summary, the changes show an iterative development process focusing on improving the checkout flow, enhancing its responsiveness to different environments and conditions, and refining data handling and store management. The updates are primarily focused on enhancing the user experience and the stability of the application.
