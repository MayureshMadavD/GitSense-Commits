# Activity Summary for 20/08/2025

## 00:17:02
The provided log shows three entries for the file `/Users/madav/Documents/checkout UI/gokwik.pdp/src/common/services/MerchantAPI.ts`, all on August 19, 2025.  The code in all three entries is identical.  The timestamps indicate that the file was either updated three times with the same content, or the timestamp is inaccurate. There are no discernible changes in the code between the three entries.  The code itself is a TypeScript file containing numerous asynchronous functions related to a merchant API, likely for a checkout process.  These functions handle various aspects including cart management (`getCartJs`, `getAbandonCart`, `updateCartAnalytics`), request ID generation (`getRequestId`), user experiments (`getUserExperiments`, `assignUserVariant`), authentication and OTP (`submitPhoneNumber`, `checkLogin`, `verifyOTP`, `resendOtpCall`), address management (`deleteAddress`, `verifyPincode`, `addAddress`, `getAllAddress`), and potentially other features. The functions extensively utilize various store subscriptions (using MobX or a similar state management library) from different stores (OrderStore, LoginStore, CommonStore) to access and update application state.  The consistent use of `postCall` and `getCall` suggests a standardized API interaction pattern.  Error handling appears minimal, primarily relying on `try...catch` blocks and Promise.any for jwtToken management in checkLogin. The code also includes custom handling for various parameters like `cf_user_customer_id`, `cf_user_id`, `cf_dimension_id`, and `cf_session_id`, likely for analytics or tracking purposes.  The presence of `x-gokwik-token` and `x-kwikpass-token` headers suggest API authentication mechanisms.


## 13:03:26
The log shows code changes on August 20, 2025, primarily focused on the `checkout-dashboard-ui` and `dashboard-ui-configuration` projects.

The `/Users/madav/Documents/dashboard_checkout/dashboard-ui-configuration/src/index.ejs` file was updated at 12:06:33.  This file is an EJS template that dynamically generates HTML based on the environment (`isLocal`, `deployedEnv`).  The significant change is the conditional inclusion of `<script type="systemjs-importmap">` blocks. These blocks define import maps for different environments (local, dev, qa, sandbox, production), specifying URLs for various Gokwik modules (@gokwik/*).  The production environment also includes Clarity and New Relic tracking scripts, with a dynamically injected `clarityKey`. The import map specifies CDN locations for React, React-DOM, and single-spa.


The `/Users/madav/Documents/dashboard_checkout/checkout-dashboard-ui/src/pages/orders/edit-orders/index.tsx` file was modified at 12:09:44. This React component handles editing order details. Key updates include:

* Extensive use of the `gokwik-ui-kit` component library for UI elements.
*  Usage of Redux's `useSelector` hook to access application state (merchant details, user configuration, etc.).
* API calls are made using `makeAPICall` from `@gokwik/utilities`.
*  The component manages line items, allowing adding, modifying, and deleting them.  Quantity adjustments trigger `modifyQty` function calls.  Item deletion temporarily stores deleted items in `discount.recentlyDeletedItems`, allowing their re-addition.
*  Discount management is a prominent feature, with options for fixed amount or percentage discounts.  The UI allows adding and removing discounts, and provides feedback through messages.
*  Data is displayed in tables using the `Table` component, with custom rendering for product information and quantity controls.
*  Error handling is implemented using state variables for errors and error items.
* The component uses `single-spa`'s `navigateToUrl` for navigation.
* The component utilizes helper functions such as `formatAmount` and `removeDuplicatesByKey`.

The updates suggest a robust order management system with a focus on a clean, component-based UI and clear separation of concerns through the use of utility functions and Redux.  The conditional logic in `index.ejs` points to a multi-environment deployment strategy.


## 15:03:32
The log shows multiple revisions of `/Users/madav/Documents/checkout UI/gokwik.pdp/src/App.svelte` between 13:18:49 and 13:51:03.  These revisions primarily involve additions and/or modifications to the `onMount` function within the Svelte component. The `onMount` function handles the initialization of the checkout process by listening for messages from the parent window, setting up various store variables based on the received data, and managing cookie and local storage values related to Gokwik tokens and session information.  There is a recurring pattern of handling different environment variables ('dev', 'qa', 'sandbox', 'production', etc.) for API URLs and token values.  The updates in these revisions do not significantly alter the core logic but likely involve bug fixes, minor improvements, or additions to handle various scenarios during the checkout process.  A consistent theme throughout the revisions is the extensive use of Svelte stores to manage the application state.  The use of window.postMessage suggests a communication mechanism between the main application and an embedded iFrame or other component.


The file `/Users/madav/Documents/checkout UI/gokwik.pdp/src/common/services/EnvironmentService.ts` was modified twice, at 13:07:43 and 13:07:55, with only a minor change in the `api_url` function.  The `local` environment's API URL was changed from commented-out options to `https://sandbox.gokwik.co`.  This file manages environment-specific API URLs, suggesting a configuration system that allows the application to adapt to different deployment environments.  The functions (`getHealthServiceBaseUrl`, `getAddressSuggestionBaseUrl`, `api_url`, etc.) show a clear structure for handling different environment configurations.

The file `/Users/madav/Documents/checkout UI/gokwik.pdp/public/merchant.html` was updated once at 13:08:12. This file is an HTML page that appears to be a merchant integration point. It embeds a Gokwik checkout button and includes JavaScript code to manage the communication between the merchant's page and the Gokwik SDK. The script initializes the Gokwik SDK and handles merchant information for payment processing.  The inclusion of cookie management demonstrates an effort to track the user's session.

The file `/Users/madav/Documents/checkout UI/gokwik.pdp/src/common/services/MerchantAPI.ts` was updated once at 13:14:44.  This file contains functions for various API interactions, including fetching cart information, handling login, updating cart analytics, managing addresses, and other checkout-related operations.  The code reveals extensive use of asynchronous operations (`async/await`) for API calls and complex logic for handling different API responses and data structures. The functions are well-organized and use a consistent naming convention.  The code shows that the service integrates with various internal and external services like analytics and payment gateways.


## 16:03:25
The provided log shows three revisions of the `/Users/madav/Documents/checkout UI/gokwik.pdp/src/common/services/MerchantAPI.ts` file, all within a short timeframe (20/08/2025, 15:25:51 to 15:28:59).  The code itself remains largely unchanged across these revisions.  All three versions define a set of asynchronous functions for interacting with a merchant API, likely for a checkout process.  These functions handle various aspects, including:

* **Cart Management:**  `getCartJs()`, `getAbandonCart()`,  functions related to retrieving and manipulating shopping carts.
* **Request ID Generation:** `getRequestId()` suggests a system for uniquely identifying requests.
* **Experimentation:** `getUserExperiments()` and `assignUserVariant()` indicate A/B testing or feature flagging capabilities.
* **Analytics:** `updateCartAnalytics()` shows a mechanism for tracking events related to the checkout process, such as COD attempts.
* **User Authentication:** `submitPhoneNumber()`, `checkLogin()`, `verifyOTP()`, and `resendOtpCall()` are related to user login and OTP verification.
* **Address Management:**  `deleteAddress()`, `verifyPincode()`, and `addAddress()`  manage user addresses.

The code uses several observable stores (`store_...`), likely from a state management library like MobX or Redux, to manage application state.  The `getBody()` function consistently constructs request bodies for API calls.  There's a significant use of conditional logic, particularly in `submitPhoneNumber()` and `checkLogin()`, handling various scenarios and optional parameters.  The code also handles custom integrations, indicated by the inclusion of `cf_user_customer_id`, `cf_user_id`, `cf_dimension_id`, and `cf_session_id` and the logic around custom fit pixels.  The minor temporal differences between the revisions suggest iterative debugging or minor adjustments rather than substantial functional changes.


## 17:03:26
The provided log shows multiple revisions of the `/Users/madav/Documents/checkout UI/gokwik.pdp/src/App.svelte` file between 16:41:09 and 16:42:55 on August 20, 2025.  The changes primarily involve the `window.addEventListener` function within the `onMount` lifecycle hook. This function handles incoming messages (`gokwikEvent`) of type 'launch'.  These messages contain various data points related to checkout, including:

* **Checkout Data:**  `sourceValue`, `localStorageObject`, `isGlanceEnvironment`, `shopifySessionId`, `cashToPrepaidFlag`, `cashToPrepaidRequestId`, `isSkipOtp`, `url`, `merchantInfo`, `environment`, `channelSource`, `channel`, `isHydrogen`, `gaCookies`, `mid`, `kwikKey`, `snapchatAttributes`, `discountCode`, `token`, `sessionId`, `kpEmail`, `isAbandonCart`, `_fbp`, `_fbc`, `sourceUrl`, `checkoutAnywhere`, `shopify_landing_page`, `shopify_orig_referrer`, `sa_shopify_y`, `sa_localization`, `sa_shopify_t`, `sa_shopify_p`.  The code processes this data, updating various Svelte stores.


* **Cookie and Local Storage Handling:** The code attempts to retrieve and set cookies and local storage items (XGokwikToken, XKWIKPASSToken, gk_login_source) to manage user authentication and session data. Error handling is included to gracefully manage potential issues.  The `isNotIncognito` variable is set based on the success or failure of this operation.


* **Conditional Logic:**  Significant conditional logic exists to handle different scenarios based on `cashToPrepaid`, `currentPage` values, and the presence or absence of specific data in the incoming message. This includes handling back button presses, and closing various UI elements (popups, bottom sheets).


* **Event Tracking:** Multiple calls to `logEvent` are used to track various aspects of the checkout process, including asset loading and popup closures.


The key difference between the revisions lies in the progressively more complete handling of data received from `gokwikEvent.data`. Initially, some data fields from the `sa_` prefixed variables in the `shopifyCookieInfo` were missing and were gradually added in subsequent commits. The `isCookieDiscountApplicable` variable was also added in a later commit.  The overall pattern is iterative refinement of the message handling and data processing within the `onMount` function.


## 19:03:28
The log shows multiple revisions to `/Users/madav/Documents/dashboard_checkout/checkout-dashboard-ui/src/pages/settings/shipping-settings/shipping-component/shippingBasedMethods.tsx`  between 17:06:15 and 17:32:15 on August 20, 2025.  The changes primarily focus on the `ShippingMethodConfig` component.  No significant changes were made to the core functionality; instead, the edits seem to be minor adjustments and refinements.

A key recurring element is the use of the `gokwik-ui-kit` library for UI components (Alert, Button, Form, etc.) and `@gokwik/utilities` for API calls and file handling.  The component interacts with the store using `react-redux` and  `useSelector` to get merchant details and `useAppDispatch` to dispatch actions.

One noticeable change is in the `useEffect` hook responsible for updating `shippingConfig`.  Initially, it depended on `shippingConfig`, causing potential re-renders. This dependency was removed in a later commit (around 17:29:58), possibly for performance optimization.  The `beforeUpload` function within the `Inputs` object (related to CSV file uploads) remains largely unchanged throughout the revisions.  This suggests the file upload mechanism wasn't altered significantly.  Finally, there's consistent usage of asynchronous functions (`getCustomerSegement`, `requestForShippingModule`, `downloadCsvFile`, `fetchPincodeList`) for handling API calls and data fetching.


## 23:48:40
The log shows code changes to a React component responsible for visualizing merchant data.  The `/Users/madav/Documents/mint-dashboard/app/ui/dashboard/chart/chart.jsx` file underwent updates on 20/08/2025 at 22:48:43.  The changes primarily involve the creation and modification of three chart components: `MerchantStatusChart`, `AvergeStatusChart`, and `MonthlyARRChart`.


`MerchantStatusChart` displays a bar chart summarizing CE (presumably Customer Engagement) data.  It allows users to filter data by selecting specific CEs using a multi-select dropdown. The chart shows the 'Expected ARR' and 'Merchant Count' for each selected CE.  Data is processed and transformed to suit the charting library (recharts).


`AvergeStatusChart` displays a composed chart showing average metrics like average go-live days, average expected ARR, and average blocked merchants.  The data for this chart comes from a `summarizeMerchantData` function.


`MonthlyARRChart` renders a chart visualizing monthly ARR (Annual Recurring Revenue) data, broken down by merchant category (SMB, ENT, Emerging).  A key feature of this component is its data validation logic, checking for missing or invalid merchant names, expected ARR values, categories, and kickoff dates. The validation results are summarized, showing totals of valid and invalid records, and the validation rate.  The chart displays monthly ARR for each category.  Data is transformed to group data by month before being rendered.

The code heavily uses the `recharts` library for chart rendering and Ant Design components for UI elements (like Select and Row/Col for layout).  The data processing within each chart component shows a consistent pattern of data transformation and aggregation to prepare data for visualization.


## 23:48:41
The `/Users/madav/Documents/checkout UI/gokwik.merchant.integration/src/Helper.service.ts` file was updated on 20/08/2025 at 22:48:42.  The update involves significant changes to the `Helper.service.ts` file, primarily focused on integrating the Gokwik SDK for checkout functionality.  The code includes functions for initializing the Gokwik SDK (`initiateGokwik`), creating and loading integration scripts (`createIntegrationScript`, `loadScript`), handling cart operations (`addCartBuyNow`, `retrieveCart`), and managing events (`listenForGokwikScript`).

Key aspects of the update include:

* **Dynamic Script Loading:**  The code dynamically loads the Gokwik SDK script from various URLs based on the environment (local, dev, qa, sandbox, production).  It also includes logic to load a "new UI" version based on A/B testing results fetched from `experimentServiceUrl`.

* **A/B Testing Integration:** The code incorporates A/B testing by fetching a variant from `https://api-gw.gokwik.io` (production) or `https://api-gw-dev.dev.gokwik.io` (dev) and loading different script URLs based on the result. Experiment IDs (`683413f44669c3cd754a15aa`, `686bcd0cbf2fb4c25dce1392`, `6851485010bce9b0dcd2c74a`) are used.

* **Event Handling and Analytics:**  The code includes functions for logging events (`logEvent`) using different analytics URLs based on the environment.

* **Cart Management:** Functions `addCartBuyNow` and `retrieveCart` handle adding items to and retrieving items from the cart using different API endpoints depending on the context (e.g., `/cart/add.js`, `/cart/update.js`, `/cart/clear.js`).  These functions also interact with cookies (`setGokwikCookie`, `getGokwikCookie`) and local storage.


* **Merchant IDs:**  The code contains lists (`gkNewUIMerchants`, `oldUiMerchants`)  of merchant IDs, used to determine which version of the UI to load.


* **Headless Checkout Support:** The `getHeadlessParams` function parses URL parameters for headless checkout scenarios.

The code extensively uses `window.postMessage` for communication between the main page and the Gokwik iframe.  The overall update aims to provide a robust and flexible integration of the Gokwik checkout functionality, handling different environments, UI variations, and cart management.


## 23:48:47
The log shows multiple updates to the `/Users/madav/Documents/checkout UI/gokwik.pdp` project between 22:48:43 and 23:38:28 on August 20, 2025.  The most significant changes involve the `/src/App.svelte` and `/src/common/services/EnvironmentService.ts` files.

`/src/App.svelte` (20/08/2025, 22:48:43): This file is a Svelte component, the main application entry point. It heavily uses various stores (`LoginStore`, `CommonStore`, `OrderStore`) managing application state,  interacts with various services (`EnvironmentService`, `MerchantAPI`, `EventService`, `Helper.service`, etc.), and renders numerous other components related to checkout, including address management, payment options, and order success/failure screens.  The code includes extensive message handling via `window.addEventListener('message')` suggesting communication with an iframe or parent application.

`/src/common/services/EnvironmentService.ts` (20/08/2025, 23:06:26, 23:22:15, 23:22:23): This file defines functions to retrieve base URLs for various APIs and services based on the current environment (`dev`, `qa`, `sandbox`, `production`, `local`, etc.).  The `api_url` function shows a large number of environment-specific API endpoints. The code also sets up subscriptions to react to changes in merchant URL and environment variables from the stores.  There were multiple minor revisions to this file within a short time frame (23:06:26, 23:22:15, 23:22:23), primarily focusing on the `local` environment configuration.  The `setCart` function indicates the initialization of a sample cart object varies across these revisions.

`/src/Components/place-order/Discounts/Discounts.svelte` (20/08/2025, 23:24:50, 23:25:55, 23:31:28, 23:33:36, 23:38:28): This file is a Svelte component handling discounts during the checkout process.  The numerous subscriptions to stores in `CommonStore` and `OrderStore` show a complex interaction with other parts of the application. It manages various types of discounts (automatic, manual, stacked, loyalty, gift cards, partner offers, etc.) and integrates with several services (`Discounts.service`, `MerchantAPI`, `ShippingDiscount.service`, `WalletCredits.service`, etc.). The component's logic is very extensive and shows a large number of reactive statements (`$:`), indicating a high degree of dynamic behavior based on store updates. Multiple minor updates within a short period (23:24:50 - 23:38:28) suggest iterative development and debugging of discount application and removal logic.


`/public/merchant.html` (20/08/2025, 23:22:42):  This file is a simple HTML page acting as the merchant-side entry point for the checkout process. It includes JavaScript code to initialize the Gokwik SDK (`gokwikSdk`) and handle communication with the main application via `window.postMessage`.  It also sets up cookies for tracking landing pages and referrer URLs.


In summary, the changes reflect ongoing development and refinement of a complex e-commerce checkout system. The focus seems to be on improving the handling of discounts and integrating with various external services and internal components. The frequent minor changes to `EnvironmentService.ts` and `Discounts.svelte` suggest debugging and iterative improvements in those areas.  The codebase appears to be large and tightly coupled, with a high reliance on reactive programming via Svelte stores and subscriptions.
